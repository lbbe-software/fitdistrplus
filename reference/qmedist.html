<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Fit of univariate distribution by matching quantiles for non censored data."><title>Quantile matching fit of univariate distributions — qmedist • fitdistrplus</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Quantile matching fit of univariate distributions — qmedist"><meta property="og:description" content="Fit of univariate distribution by matching quantiles for non censored data."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">fitdistrplus</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1-8</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/FAQ.html">Frequently Asked Questions</a>
    <a class="dropdown-item" href="../articles/Optimalgo.html">Which optimization algorithm to choose?</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/aursiber/fitdistrplus/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Quantile matching fit of univariate distributions</h1>
      
      <div class="d-none name"><code>qmedist.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fit of univariate distribution by matching quantiles for non censored data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">qmedist</span><span class="op">(</span><span class="va">data</span>, <span class="va">distr</span>, <span class="va">probs</span>, start <span class="op">=</span> <span class="cn">NULL</span>, fix.arg <span class="op">=</span> <span class="cn">NULL</span>, qtype <span class="op">=</span> <span class="fl">7</span>, </span>
<span>    optim.method <span class="op">=</span> <span class="st">"default"</span>, lower <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, upper <span class="op">=</span> <span class="cn">Inf</span>, </span>
<span>    custom.optim <span class="op">=</span> <span class="cn">NULL</span>, weights <span class="op">=</span> <span class="cn">NULL</span>, silent <span class="op">=</span> <span class="cn">TRUE</span>, gradient <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>    checkstartfix<span class="op">=</span><span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>A numeric vector for non censored data.</p></dd>

<dt>distr</dt>
<dd><p>A character string <code>"name"</code> naming a distribution  for which the corresponding 
    quantile function 
    <code>qname</code> and the corresponding density distribution <code>dname</code> must be classically defined.</p></dd>

<dt>probs</dt>
<dd><p>A numeric vector of the probabilities for which the quantile matching is done.
    The length of this vector must be equal
    to the number of parameters to estimate.</p></dd>
  
<dt>start</dt>
<dd><p>A named list giving the initial values of parameters of the named distribution
    or a function of data computing initial values and returning a named list.
    This argument may be omitted (default) for some distributions for which reasonable 
    starting values are computed (see the 'details' section of  <code><a href="mledist.html">mledist</a></code>).</p></dd>

<dt>fix.arg</dt>
<dd><p>An optional named list giving the values of fixed parameters of the named distribution
    or a function of data computing (fixed) parameter values and returning a named list. 
    Parameters with fixed value are thus NOT estimated.</p></dd>

<dt>qtype</dt>
<dd><p>The quantile type used by the R <code><a href="quantile.html">quantile</a></code> function to 
    compute the empirical quantiles, (default 7 corresponds to the default quantile method in R).</p></dd>

<dt>optim.method</dt>
<dd><p><code>"default"</code> or optimization method to pass to <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code>.</p></dd>

<dt>lower</dt>
<dd><p>Left bounds on the parameters for the <code>"L-BFGS-B"</code> method (see <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code>).</p></dd>

<dt>upper</dt>
<dd><p>Right bounds on the parameters for the <code>"L-BFGS-B"</code> method (see <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code>).</p></dd>

<dt>custom.optim</dt>
<dd><p>a function carrying the optimization.</p></dd>

<dt>weights</dt>
<dd><p>an optional vector of weights to be used in the fitting process. 
    Should be <code>NULL</code> or a numeric vector with strictly positive integers 
    (typically the number of occurences of each observation). If non-<code>NULL</code>, 
    weighted QME is used, otherwise ordinary QME.</p></dd>

<dt>silent</dt>
<dd><p>A logical to remove or show warnings when bootstraping.</p></dd>
        
<dt>gradient</dt>
<dd><p>A function to return the gradient of the squared difference for the <code>"BFGS"</code>, <code>"CG"</code> 
    and <code>"L-BFGS-B"</code> methods. If it is <code>NULL</code>, a finite-difference approximation will be used,
    see details.</p></dd>

<dt>checkstartfix</dt>
<dd><p>A logical to test starting and fixed values. Do not change it.</p></dd>
      
<dt>...</dt>
<dd><p>further arguments passed to the <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code>, 
    <code><a href="https://rdrr.io/r/stats/constrOptim.html" class="external-link">constrOptim</a></code> or <code>custom.optim</code> function.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>qmedist</code> function carries out the quantile matching numerically, by minimization of the
    sum of squared differences between observed and theoretical quantiles.
    Note that for discrete distribution, the sum of squared differences is a step function and
    consequently, the optimum is not unique, see the FAQ.</p>    
<p>The optimization process is the same as <code><a href="mledist.html">mledist</a></code>, see the 'details' section 
    of that function.</p>    
<p>Optionally, a vector of <code>weights</code> can be used in the fitting process. 
    By default (when <code>weigths=NULL</code>), ordinary QME is carried out, otherwise 
    the specified weights are used to compute weighted quantiles used in the squared differences.
    Weigthed quantiles are computed by <code>wtd.quantile</code> from the <code>Hmisc</code> package.
    It is not yet possible to take into account weighths in functions <code>plotdist</code>, 
    <code>plotdistcens</code>, <code>plot.fitdist</code>, <code>plot.fitdistcens</code>, <code>cdfcomp</code>, 
    <code>cdfcompcens</code>, <code>denscomp</code>, <code>ppcomp</code>, <code>qqcomp</code>, <code>gofstat</code> 
    and <code>descdist</code>
    (developments planned in the future).</p>

<p>This function is not intended to be called directly but is internally called in
    <code><a href="fitdist.html">fitdist</a></code> and <code><a href="bootdist.html">bootdist</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p></p>
<p><code>qmedist</code> returns a list with following components,</p>
<dl><dt>estimate</dt>
<dd><p>the parameter estimates.</p></dd>

    <dt>convergence</dt>
<dd><p>an integer code for the convergence of <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code> defined as below
    or defined by the user in the user-supplied optimization function. 
        <code>0</code> indicates successful convergence.
        <code>1</code> indicates that the iteration limit of <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code> has been reached.
        <code>10</code> indicates degeneracy of the Nealder-Mead simplex.
        <code>100</code> indicates that <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code> encountered an internal error.</p></dd>

    <dt>value</dt>
<dd><p>the minimal value reached for the criterion to minimize.</p></dd>
    
    <dt>hessian</dt>
<dd><p>a symmetric matrix computed by <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code> as an estimate of the Hessian
        at the solution found or computed in the user-supplied optimization function.</p></dd>

    <dt>optim.function</dt>
<dd><p>the name of the optimization function used for maximum likelihood.</p></dd>

    <dt>optim.method</dt>
<dd><p>when <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code> is used, the name of the
    algorithm used, the field <code>method</code> of the <code>custom.optim</code> function
    otherwise.</p></dd>

    <dt>fix.arg</dt>
<dd><p>the named list giving the values of parameters of the named distribution
        that must kept fixed rather than estimated by maximum likelihood or <code>NULL</code> 
        if there are no such parameters.</p></dd>

    <dt>fix.arg.fun</dt>
<dd><p>the function used to set the value of <code>fix.arg</code> or <code>NULL</code>.</p></dd>

    <dt>weights</dt>
<dd><p>the vector of weigths used in the estimation process or <code>NULL</code>.</p></dd>

    <dt>counts</dt>
<dd><p>A two-element integer vector giving the number of calls 
    to the log-likelihood function and its gradient respectively. 
    This excludes those calls needed to compute the Hessian, if requested, 
    and any calls to log-likelihood function to compute a finite-difference
    approximation to the gradient. <code>counts</code> is returned by <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code>
    or the user-supplied function or set to <code>NULL</code>.</p></dd>

    <dt>optim.message</dt>
<dd><p>A character string giving any additional information 
    returned by the optimizer, or <code>NULL</code>. To understand exactly the message,
    see the source code.</p></dd>

    <dt>loglik</dt>
<dd><p>the log-likelihood value.</p></dd>

    <dt>probs</dt>
<dd><p>the probability vector on which quantiles are matched.</p></dd>
   
</dl></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="mmedist.html">mmedist</a></code>, <code><a href="mledist.html">mledist</a></code>, <code><a href="mgedist.html">mgedist</a></code>,
    <code><a href="fitdist.html">fitdist</a></code> for other estimation methods and 
    <code><a href="quantile.html">quantile</a></code> for empirical quantile estimation in R.</p></div>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Klugman SA, Panjer HH and Willmot GE (2012),
<em>Loss Models: From Data to Decissions</em>, 4th edition.
Wiley Series in Statistics for Finance, Business and Economics, p. 253.</p>

<p>Delignette-Muller ML and Dutang C (2015), <em>fitdistrplus: An R Package for Fitting Distributions</em>.
Journal of Statistical Software, 64(4), 1-34.</p>


    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Christophe Dutang and Marie Laure Delignette-Muller.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (1) basic fit of a normal distribution </span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">qmedist</span><span class="op">(</span><span class="va">x1</span>, <span class="st">"norm"</span>, probs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       mean         sd </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.3025734  0.8521385 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $convergence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4.855518e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hessian</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               mean            sd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mean  4.000000e+00 -5.569326e-14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sd   -5.569326e-14  7.421040e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optim.function</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "optim"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optim.method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Nelder-Mead"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fix.arg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fix.arg.fun</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $weights</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $counts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function gradient </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       57       NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optim.message</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $loglik</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -146.1278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $probs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.3333333 0.6666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (2) defining your own distribution functions, here for the Gumbel </span></span></span>
<span class="r-in"><span><span class="co"># distribution for other distributions, see the CRAN task view dedicated </span></span></span>
<span class="r-in"><span><span class="co"># to probability distributions</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dgumbel</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">a</span>, <span class="va">b</span><span class="op">)</span> <span class="fl">1</span><span class="op">/</span><span class="va">b</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">(</span><span class="va">a</span><span class="op">-</span><span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="va">b</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">(</span><span class="va">a</span><span class="op">-</span><span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="va">b</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">qgumbel</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">p</span>, <span class="va">a</span>, <span class="va">b</span><span class="op">)</span> <span class="va">a</span> <span class="op">-</span> <span class="va">b</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">qmedist</span><span class="op">(</span><span class="va">x1</span>, <span class="st">"gumbel"</span>, probs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">10</span>,b<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in checkparamlist(arg_startfix$start.arg, arg_startfix$fix.arg,     argddistname, hasnodefaultval):</span> 'start' must specify names which are arguments to 'distr'.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (3) fit a discrete distribution (Poisson)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">30</span>,lambda <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">qmedist</span><span class="op">(</span><span class="va">x2</span>, <span class="st">"pois"</span>, probs<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1.7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $convergence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hessian</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        lambda</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optim.function</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "optim"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optim.method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "BFGS"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fix.arg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fix.arg.fun</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $weights</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $counts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function gradient </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        1        1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optim.message</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $loglik</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -46.18434</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $probs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (4) fit a finite-support distribution (beta)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span>,shape1<span class="op">=</span><span class="fl">5</span>, shape2<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">qmedist</span><span class="op">(</span><span class="va">x3</span>, <span class="st">"beta"</span>, probs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    shape1    shape2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5.820826 14.053655 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $convergence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 7.779463e-12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hessian</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              shape1        shape2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape1  0.005429533 -0.0021926587</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape2 -0.002192659  0.0008954389</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optim.function</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "optim"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optim.method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Nelder-Mead"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fix.arg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fix.arg.fun</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $weights</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $counts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function gradient </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       89       NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optim.message</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $loglik</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 76.02016</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $probs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.3333333 0.6666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (5) fit frequency distributions on USArrests dataset.</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x4</span> <span class="op">&lt;-</span> <span class="va">USArrests</span><span class="op">$</span><span class="va">Assault</span></span></span>
<span class="r-in"><span><span class="fu">qmedist</span><span class="op">(</span><span class="va">x4</span>, <span class="st">"pois"</span>, probs<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 170.76 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $convergence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 144</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hessian</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        lambda</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optim.function</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "optim"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optim.method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "BFGS"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fix.arg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fix.arg.fun</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $weights</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $counts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function gradient </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        1        1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optim.message</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $loglik</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1211.705</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $probs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">qmedist</span><span class="op">(</span><span class="va">x4</span>, <span class="st">"nbinom"</span>, probs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       size         mu </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2.518966 182.313344 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $convergence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.2222222</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hessian</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      size mu</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> size    0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mu      0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optim.function</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "optim"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optim.method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Nelder-Mead"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fix.arg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fix.arg.fun</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $weights</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $counts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function gradient </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       37       NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optim.message</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $loglik</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -292.5969</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $probs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.3333333 0.6666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Marie-Laure Delignette-Muller, Christophe Dutang, Aurelie Siberchicot.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

