<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Fit of univariate distributions to non-censored data by maximum likelihood (mle), 
 moment matching (mme), quantile matching (qme) or 
 maximizing goodness-of-fit estimation (mge).
 The latter is also known as minimizing distance estimation.
 Generic methods are print, plot, 
summary, quantile, logLik, AIC, 
BIC, vcov and coef."><title>Fit of univariate distributions to non-censored data — fitdist • fitdistrplus</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit of univariate distributions to non-censored data — fitdist"><meta property="og:description" content="Fit of univariate distributions to non-censored data by maximum likelihood (mle), 
 moment matching (mme), quantile matching (qme) or 
 maximizing goodness-of-fit estimation (mge).
 The latter is also known as minimizing distance estimation.
 Generic methods are print, plot, 
summary, quantile, logLik, AIC, 
BIC, vcov and coef."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">fitdistrplus</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1-12</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/fitdistrplus_vignette.html">Overview of the fitdistrplus package</a>
    <a class="dropdown-item" href="../articles/Optimalgo.html">Which optimization algorithm to choose?</a>
    <a class="dropdown-item" href="../articles/starting-values.html">Starting values used in fitdistrplus</a>
    <a class="dropdown-item" href="../articles/FAQ.html">Frequently Asked Questions</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/lbbe-software/fitdistrplus/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Fit of univariate distributions to non-censored data</h1>
      
      <div class="d-none name"><code>fitdist.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fit of univariate distributions to non-censored data by maximum likelihood (mle), 
 moment matching (mme), quantile matching (qme) or 
 maximizing goodness-of-fit estimation (mge).
 The latter is also known as minimizing distance estimation.
 Generic methods are <code>print</code>, <code>plot</code>, 
<code>summary</code>, <code>quantile</code>, <code>logLik</code>, <code>AIC</code>, 
<code>BIC</code>, <code>vcov</code> and <code>coef</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fitdist</span><span class="op">(</span><span class="va">data</span>, <span class="va">distr</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mle"</span>, <span class="st">"mme"</span>, <span class="st">"qme"</span>, <span class="st">"mge"</span>, <span class="st">"mse"</span><span class="op">)</span>, </span>
<span>    start<span class="op">=</span><span class="cn">NULL</span>, fix.arg<span class="op">=</span><span class="cn">NULL</span>, <span class="va">discrete</span>, keepdata <span class="op">=</span> <span class="cn">TRUE</span>, keepdata.nb<span class="op">=</span><span class="fl">100</span>, <span class="va">...</span><span class="op">)</span></span>
<span>    </span>
<span><span class="co"># S3 method for fitdist</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for fitdist</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, breaks<span class="op">=</span><span class="st">"default"</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for fitdist</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for fitdist</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for fitdist</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span>, k <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for fitdist</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">BIC</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for fitdist</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for fitdist</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>A numeric vector.</p></dd>

<dt>distr</dt>
<dd><p>A character string <code>"name"</code> naming a distribution for which the corresponding
    density function <code>dname</code>, the corresponding distribution function <code>pname</code> and the 
    corresponding quantile function <code>qname</code> must be defined, or directly the density function.</p></dd>

<dt>method</dt>
<dd><p>A character string coding for the fitting method: 
    <code>"mle"</code> for 'maximum likelihood estimation', <code>"mme"</code> for 'moment matching estimation', 
    <code>"qme"</code> for 'quantile matching estimation', <code>"mge"</code> for 'maximum goodness-of-fit estimation'
    and <code>"mse"</code> for 'maximum spacing estimation'.</p></dd>

<dt>start</dt>
<dd><p>A named list giving the initial values of parameters of the named distribution
    or a function of data computing initial values and returning a named list.
    This argument may be omitted (default) for some distributions for which reasonable 
    starting values are computed (see the 'details' section of  <code><a href="mledist.html">mledist</a></code>). 
    It may not be into account for closed-form formulas.</p></dd>

<dt>fix.arg</dt>
<dd><p>An optional named list giving the values of fixed parameters of the named distribution
    or a function of data computing (fixed) parameter values and returning a named list. 
    Parameters with fixed value are thus NOT estimated by this maximum likelihood procedure.
    The use of this argument is not possible if <code>method="mme"</code> and a closed-form formula is used.</p></dd>

<dt>keepdata</dt>
<dd><p>a logical. If <code>TRUE</code>, dataset is returned, 
    otherwise only a sample subset is returned.</p></dd>

<dt>keepdata.nb</dt>
<dd><p>When <code>keepdata=FALSE</code>, the length (&gt;1) of the subset returned.</p></dd>

<dt>discrete</dt>
<dd><p>If TRUE, the distribution is considered as discrete.
    If <code>discrete</code> is missing, 
	  <code>discrete</code> is automaticaly set to <code>TRUE</code> when <code>distr</code> belongs to 
	  <code>"binom"</code>, <code>"nbinom"</code>, <code>"geom"</code>,
    <code>"hyper"</code> or <code>"pois"</code> and to <code>FALSE</code> in the other cases. It is thus recommended
    to enter this argument when using another discrete distribution. This argument will not directly affect
    the results of the fit but will be passed to functions <code><a href="gofstat.html">gofstat</a></code>, <code><a href="plotdist.html">plotdist</a></code> 
    and <code><a href="graphcomp.html">cdfcomp</a></code>.</p></dd>

<dt>x</dt>
<dd><p>An object of class <code>"fitdist"</code>.</p></dd>

<dt>object</dt>
<dd><p>An object of class <code>"fitdist"</code>.</p></dd>

<dt>breaks</dt>
<dd><p>If <code>"default"</code> the histogram is plotted with the function <code>hist</code> 
    with its default breaks definition. Else <code>breaks</code> is passed to the function <code>hist</code>.
    This argument is not taken into account with discrete distributions: <code>"binom"</code>, 
    <code>"nbinom"</code>, <code>"geom"</code>, <code>"hyper"</code> and <code>"pois"</code>.</p></dd>

<dt>k</dt>
<dd><p>penalty per parameter to be passed to the AIC generic function (2 by default).</p></dd>

<dt>...</dt>
<dd><p>Further arguments to be passed to generic functions, or to one of the functions
    <code>"mledist"</code>,  <code>"mmedist"</code>, <code>"qmedist"</code> or <code>"mgedist"</code>
    depending of the chosen method. See <code><a href="mledist.html">mledist</a></code>, <code><a href="mmedist.html">mmedist</a></code>, <code><a href="qmedist.html">qmedist</a></code>, 
    <code><a href="mgedist.html">mgedist</a></code> for details on parameter estimation.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    

<p>It is assumed that the <code>distr</code> argument specifies the distribution by the
    probability density function, the cumulative distribution function and
    the quantile function (d, p, q).</p>
<p>The four possible fitting methods are described below:</p><dl><dt>When <code>method="mle"</code></dt>
<dd><p>Maximum likelihood estimation consists in maximizing the log-likelihood.
    A numerical optimization is carried out in <code><a href="mledist.html">mledist</a></code> via <code>optim</code>
    to find the best values (see <code><a href="mledist.html">mledist</a></code> for details).</p></dd>

    <dt>When <code>method="mme"</code></dt>
<dd><p>Moment matching estimation consists in equalizing theoretical and empirical moments.
    Estimated values of the distribution parameters are computed by a closed-form 
    formula for the following distributions : <code>"norm"</code>, <code>"lnorm"</code>, 
    <code>"pois"</code>, <code>"exp"</code>, <code>"gamma"</code>, 
    <code>"nbinom"</code>, <code>"geom"</code>, <code>"beta"</code>, <code>"unif"</code> and <code>"logis"</code>.
    Otherwise the theoretical and the empirical moments are matched numerically, 
    by minimization of the sum of squared differences between observed and theoretical moments. 
    In this last case, further arguments are needed in the call to <code>fitdist</code>: <code>order</code> and <code>memp</code>
    (see <code><a href="mmedist.html">mmedist</a></code> for details).</p></dd>

    <dt>When <code>method = "qme"</code></dt>
<dd><p>Quantile matching estimation consists in equalizing theoretical and empirical quantile.
    A numerical optimization is carried out in <code><a href="qmedist.html">qmedist</a></code> via <code>optim</code>
    to minimize of the sum of squared differences between observed and theoretical quantiles.
    The use of this method requires an additional argument <code>probs</code>, 
    defined as the numeric vector of the probabilities for which the quantile(s) is(are) to be matched
    (see <code><a href="qmedist.html">qmedist</a></code> for details).</p></dd>

    <dt>When <code>method = "mge"</code></dt>
<dd><p>Maximum goodness-of-fit estimation consists in maximizing a goodness-of-fit statistics.
    A numerical optimization is carried out in <code><a href="mgedist.html">mgedist</a></code> via <code>optim</code>
    to minimize the goodness-of-fit distance. The use of this method 
    requires an additional argument <code>gof</code> coding for the goodness-of-fit distance chosen. 
    One can use the classical Cramer-von Mises distance (<code>"CvM"</code>), the classical
    Kolmogorov-Smirnov distance (<code>"KS"</code>), the classical Anderson-Darling distance (<code>"AD"</code>)
    which gives more weight to the tails of the distribution, 
    or one of the variants of this last distance proposed by Luceno (2006)
    (see <code><a href="mgedist.html">mgedist</a></code> for more details). This method is not suitable for discrete distributions.</p></dd>

    <dt>When <code>method = "mse"</code></dt>
<dd><p>Maximum goodness-of-fit estimation consists in maximizing the average log spacing.
    A numerical optimization is carried out in <code><a href="msedist.html">msedist</a></code> via <code>optim</code>.</p></dd>


</dl><p>By default, direct optimization of the log-likelihood (or other criteria depending
    of the chosen method) is performed using <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code>, 
    with the "Nelder-Mead" method for distributions characterized by more than one parameter
    and the "BFGS" method for distributions characterized by only one parameter. 
    The optimization algorithm used in <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code> can be chosen or another optimization function
    can be specified using ... argument (see <code><a href="mledist.html">mledist</a></code> for details).
    <code>start</code> may be omitted (i.e. <code>NULL</code>) for some classic distributions
    (see the 'details' section of  <code><a href="mledist.html">mledist</a></code>).
    Note that when errors are raised by <code>optim</code>, it's a good idea to start by adding traces during
    the optimization process by adding <code>control=list(trace=1, REPORT=1)</code> in ... argument.</p>    
<p>Once the parameter(s) is(are) estimated, <code>fitdist</code> computes the log-likelihood 
    for every estimation method and for maximum likelihood estimation the standard errors of 
    the estimates calculated from the Hessian at the solution found by <code>optim</code> 
    or by the user-supplied function passed to mledist.</p>
<p>By default (<code>keepdata = TRUE</code>), the object returned by <code>fitdist</code> contains 
    the data vector given in input.
    When dealing with large datasets, we can remove the original dataset from the output by
    setting <code>keepdata = FALSE</code>. In such a case, only <code>keepdata.nb</code> points (at most) 
    are kept by random subsampling <code>keepdata.nb</code>-2 points from the dataset and 
    adding the minimum and the maximum. If combined with <code><a href="bootdist.html">bootdist</a></code>, and use with
    non-parametric bootstrap be aware that bootstrap is performed on the subset
    randomly selected in <code>fitdist</code>. Currently, the graphical comparisons of multiple fits 
    is not available in this framework.</p>    
<p>Weighted version of the estimation process is available for <code>method = "mle", "mme", "qme"</code>
    by using <code>weights=...</code>. See the corresponding man page for details.
    Weighted maximum GOF estimation (when <code>method = "mge"</code>) is not allowed. 
    It is not yet possible to take into account weighths in functions <code>plotdist</code>, 
    <code>plot.fitdist</code>, <code>cdfcomp</code>, <code>denscomp</code>, <code>ppcomp</code>, 
    <code>qqcomp</code>, <code>gofstat</code> and <code>descdist</code> (developments planned in the future).</p>
<p>NB: if your data values are particularly small or large, a scaling may be needed 
    before the optimization process. See example (14) in this man page and 
    examples (14,15) in the test file of the package.
    Please also take a look at the <code>Rmpfr</code> package available on CRAN for numerical
    accuracy issues.</p>    
    

    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p></p>
<p><code>fitdist</code> returns an object of class <code>"fitdist"</code>, a list with the following components:</p>
<dl><dt>estimate</dt>
<dd><p>the parameter estimates.</p></dd>

    <dt>method</dt>
<dd><p>the character string coding for the fitting method : 
        <code>"mle"</code> for 'maximum likelihood estimation', 
        <code>"mme"</code> for 'matching moment estimation',
        <code>"qme"</code> for 'matching quantile estimation'
        <code>"mge"</code> for 'maximum goodness-of-fit estimation'
        and <code>"mse"</code> for 'maximum spacing estimation'.</p></dd>

    <dt>sd</dt>
<dd><p>the estimated standard errors, <code>NA</code> if numerically not computable
        or <code>NULL</code> if not available.</p></dd>

    <dt>cor</dt>
<dd><p>the estimated correlation matrix, <code>NA</code> if numerically not computable
        or <code>NULL</code> if not available.</p></dd>

    <dt>vcov</dt>
<dd><p>the estimated variance-covariance matrix, <code>NULL</code> if not available.</p></dd>

    <dt>loglik</dt>
<dd><p>the log-likelihood.</p></dd>

    <dt>aic</dt>
<dd><p>the Akaike information criterion.</p></dd>

    <dt>bic</dt>
<dd><p>the the so-called BIC or SBC (Schwarz Bayesian criterion).</p></dd>

    <dt>n</dt>
<dd><p>the length of the data set.</p></dd>

    <dt>data</dt>
<dd><p>the data set.</p></dd>

    <dt>distname</dt>
<dd><p>the name of the distribution.</p></dd>

    <dt>fix.arg</dt>
<dd><p>the named list giving the values of parameters of the named distribution
        that must be kept fixed rather than estimated by maximum likelihood or <code>NULL</code> 
        if there are no such parameters.</p></dd>

    <dt>fix.arg.fun</dt>
<dd><p>the function used to set the value of <code>fix.arg</code> or <code>NULL</code>.</p></dd>
    
    <dt>dots</dt>
<dd><p>the list of  further arguments passed in ... to be used in <code><a href="bootdist.html">bootdist</a></code> 
        in iterative calls to <code><a href="mledist.html">mledist</a></code>, <code><a href="mmedist.html">mmedist</a></code>,
        <code><a href="qmedist.html">qmedist</a></code>, <code><a href="mgedist.html">mgedist</a></code> or 
        <code>NULL</code> if no such arguments.</p></dd>

    <dt>convergence</dt>
<dd><p>an integer code for the convergence of 
    <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code>/<code><a href="https://rdrr.io/r/stats/constrOptim.html" class="external-link">constrOptim</a></code> defined as below
    or defined by the user in the user-supplied optimization function. 
        <code>0</code> indicates successful convergence.
        <code>1</code> indicates that the iteration limit of <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code> has been reached.
        <code>10</code> indicates degeneracy of the Nealder-Mead simplex.
        <code>100</code> indicates that <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code> encountered an internal error.</p></dd>
    
    <dt>discrete</dt>
<dd><p>the input argument or the automatic definition by the function to be passed
        to functions <code><a href="gofstat.html">gofstat</a></code>, <code><a href="plotdist.html">plotdist</a></code> 
        and <code><a href="graphcomp.html">cdfcomp</a></code>.</p></dd>

    
    <dt>weights</dt>
<dd><p>the vector of weigths used in the estimation process or <code>NULL</code>.</p></dd>
    

</dl><p>Generic functions:</p><dl><dt><code>print</code></dt>
<dd><p>The print of a <code>"fitdist"</code> object shows few traces about the fitting method and 
    the fitted distribution.</p></dd>

    <dt><code>summary</code></dt>
<dd><p>The summary provides the parameter estimates of the fitted distribution, the log-likelihood, 
    AIC and BIC statistics and when the maximum likelihood is used, the standard errors of the 
    parameter estimates and the correlation matrix between parameter estimates.</p></dd>

    <dt><code>plot</code></dt>
<dd><p>The plot of an object of class "fitdist" returned by <code>fitdist</code> uses the function 
    <code><a href="plotdist.html">plotdist</a></code>. An object of class "fitdist" or a list of objects of class
    "fitdist" corresponding to various fits using the same data set may also be plotted
    using a cdf plot (function <code><a href="graphcomp.html">cdfcomp</a></code>),
    a density plot(function <code><a href="graphcomp.html">denscomp</a></code>),
    a density Q-Q plot (function <code><a href="graphcomp.html">qqcomp</a></code>),
    or a P-P plot (function <code><a href="graphcomp.html">ppcomp</a></code>).</p></dd>

    <dt><code>logLik</code></dt>
<dd><p>Extracts the estimated log-likelihood from the <code>"fitdist"</code> object.</p></dd>

    <dt><code>AIC</code></dt>
<dd><p>Extracts the AIC from the <code>"fitdist"</code> object.</p></dd>

    <dt><code>BIC</code></dt>
<dd><p>Extracts the estimated BIC from the <code>"fitdist"</code> object.</p></dd>

    <dt><code>vcov</code></dt>
<dd><p>Extracts the estimated var-covariance matrix from the <code>"fitdist"</code> object
    (only available When <code>method = "mle"</code>).</p></dd>

    <dt><code>coef</code></dt>
<dd><p>Extracts the fitted coefficients from the <code>"fitdist"</code> object.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>See <code><a href="fitdistrplus.html">fitdistrplus</a></code> for an overview of the package.
    See <code><a href="mledist.html">mledist</a></code>, <code><a href="mmedist.html">mmedist</a></code>, <code><a href="qmedist.html">qmedist</a></code>, 
    <code><a href="mgedist.html">mgedist</a></code>, <code><a href="msedist.html">msedist</a></code> for details on parameter estimation.
    See <code><a href="gofstat.html">gofstat</a></code> for goodness-of-fit statistics.
    See <code><a href="plotdist.html">plotdist</a></code>, <code><a href="graphcomp.html">graphcomp</a></code>, <code><a href="CIcdfplot.html">CIcdfplot</a></code> for graphs
    (with or without uncertainty and/or multiple fits).
    See <code><a href="logLik-plot.html">llplot</a></code> for (log-)likelihood plots in the
    neighborhood of the fitted value.
    See <code><a href="bootdist.html">bootdist</a></code> for bootstrap procedures 
    and <code><a href="fitdistcens.html">fitdistcens</a></code> for censored-data fitting methods.
    See <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code> for base R optimization procedures.
    See <code><a href="quantile.html">quantile.fitdist</a></code>, another generic function, which calculates 
    quantiles from the fitted distribution.
    See <code><a href="quantile.html">quantile</a></code> for base R quantile computation.</p></div>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Cullen AC and Frey HC (1999), <em>Probabilistic techniques in exposure assessment</em>.
Plenum Press, USA, pp. 81-155.</p>
<p>Venables WN and Ripley BD (2002), <em>Modern applied statistics with S</em>.
Springer, New York, pp. 435-446.</p>
<p>Vose D (2000), <em>Risk analysis, a quantitative guide</em>.
John Wiley &amp; Sons Ltd, Chischester, England, pp. 99-143.</p>
<p>Delignette-Muller ML and Dutang C (2015), <em>fitdistrplus: An R Package for Fitting Distributions</em>.
Journal of Statistical Software, 64(4), 1-34.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Marie-Laure Delignette-Muller and Christophe Dutang.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (1) fit of a gamma distribution by maximum likelihood estimation</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">groundbeef</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">serving</span> <span class="op">&lt;-</span> <span class="va">groundbeef</span><span class="op">$</span><span class="va">serving</span></span></span>
<span class="r-in"><span><span class="va">fitg</span> <span class="op">&lt;-</span> <span class="fu">fitdist</span><span class="op">(</span><span class="va">serving</span>, <span class="st">"gamma"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fitg</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting of the distribution ' gamma ' by maximum likelihood </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameters : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape  4.009212  0.3420423</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scale 18.369492  1.6696165</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loglikelihood:  -1253.625   AIC:  2511.25   BIC:  2518.325 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation matrix:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            shape      scale</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape  1.0000000 -0.9386832</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scale -0.9386832  1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fitg</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fitdist-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fitg</span>, demp <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fitdist-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fitg</span>, histo <span class="op">=</span> <span class="cn">FALSE</span>, demp <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fitdist-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="graphcomp.html">cdfcomp</a></span><span class="op">(</span><span class="va">fitg</span>, addlegend<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fitdist-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="graphcomp.html">denscomp</a></span><span class="op">(</span><span class="va">fitg</span>, addlegend<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fitdist-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="graphcomp.html">ppcomp</a></span><span class="op">(</span><span class="va">fitg</span>, addlegend<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fitdist-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="graphcomp.html">qqcomp</a></span><span class="op">(</span><span class="va">fitg</span>, addlegend<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fitdist-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (2) use the moment matching estimation (using a closed formula)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fitgmme</span> <span class="op">&lt;-</span> <span class="fu">fitdist</span><span class="op">(</span><span class="va">serving</span>, <span class="st">"gamma"</span>, method<span class="op">=</span><span class="st">"mme"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fitgmme</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting of the distribution ' gamma ' by matching moments </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameters : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape 4.22848617</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate  0.05741663</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loglikelihood:  -1253.825   AIC:  2511.65   BIC:  2518.724 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (3) Comparison of various fits </span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fitW</span> <span class="op">&lt;-</span> <span class="fu">fitdist</span><span class="op">(</span><span class="va">serving</span>, <span class="st">"weibull"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fitg</span> <span class="op">&lt;-</span> <span class="fu">fitdist</span><span class="op">(</span><span class="va">serving</span>, <span class="st">"gamma"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fitln</span> <span class="op">&lt;-</span> <span class="fu">fitdist</span><span class="op">(</span><span class="va">serving</span>, <span class="st">"lnorm"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fitW</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting of the distribution ' weibull ' by maximum likelihood </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameters : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape  2.185487  0.1045621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scale 83.348049  2.5273258</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loglikelihood:  -1255.225   AIC:  2514.449   BIC:  2521.524 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation matrix:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           shape     scale</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape 1.0000000 0.3216267</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scale 0.3216267 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fitg</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting of the distribution ' gamma ' by maximum likelihood </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameters : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape  4.009212  0.3420423</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scale 18.369492  1.6696165</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loglikelihood:  -1253.625   AIC:  2511.25   BIC:  2518.325 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation matrix:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            shape      scale</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape  1.0000000 -0.9386832</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scale -0.9386832  1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fitln</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting of the distribution ' lnorm ' by maximum likelihood </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameters : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> meanlog 4.1693701 0.03366988</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sdlog   0.5366095 0.02380783</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loglikelihood:  -1261.319   AIC:  2526.639   BIC:  2533.713 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation matrix:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         meanlog sdlog</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> meanlog       1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sdlog         0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="graphcomp.html">cdfcomp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">fitW</span>, <span class="va">fitg</span>, <span class="va">fitln</span><span class="op">)</span>, legendtext<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Weibull"</span>, <span class="st">"gamma"</span>, <span class="st">"lognormal"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fitdist-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="graphcomp.html">denscomp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">fitW</span>, <span class="va">fitg</span>, <span class="va">fitln</span><span class="op">)</span>, legendtext<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Weibull"</span>, <span class="st">"gamma"</span>, <span class="st">"lognormal"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fitdist-9.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="graphcomp.html">qqcomp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">fitW</span>, <span class="va">fitg</span>, <span class="va">fitln</span><span class="op">)</span>, legendtext<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Weibull"</span>, <span class="st">"gamma"</span>, <span class="st">"lognormal"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fitdist-10.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="graphcomp.html">ppcomp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">fitW</span>, <span class="va">fitg</span>, <span class="va">fitln</span><span class="op">)</span>, legendtext<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Weibull"</span>, <span class="st">"gamma"</span>, <span class="st">"lognormal"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fitdist-11.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="gofstat.html">gofstat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">fitW</span>, <span class="va">fitg</span>, <span class="va">fitln</span><span class="op">)</span>, fitnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Weibull"</span>, <span class="st">"gamma"</span>, <span class="st">"lognormal"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Goodness-of-fit statistics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                Weibull     gamma lognormal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Kolmogorov-Smirnov statistic 0.1396194 0.1280934 0.1493090</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cramer-von Mises statistic   0.6839428 0.6937261 0.8277358</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Anderson-Darling statistic   3.5729448 3.5675483 4.5436542</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Goodness-of-fit criteria</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                 Weibull    gamma lognormal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Akaike's Information Criterion 2514.449 2511.250  2526.639</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bayesian Information Criterion 2521.524 2518.325  2533.713</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (4) defining your own distribution functions, here for the Gumbel distribution</span></span></span>
<span class="r-in"><span><span class="co"># for other distributions, see the CRAN task view </span></span></span>
<span class="r-in"><span><span class="co"># dedicated to probability distributions</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dgumbel</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">a</span>, <span class="va">b</span><span class="op">)</span> <span class="fl">1</span><span class="op">/</span><span class="va">b</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">(</span><span class="va">a</span><span class="op">-</span><span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="va">b</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">(</span><span class="va">a</span><span class="op">-</span><span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="va">b</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pgumbel</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">q</span>, <span class="va">a</span>, <span class="va">b</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">(</span><span class="va">a</span><span class="op">-</span><span class="va">q</span><span class="op">)</span><span class="op">/</span><span class="va">b</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">qgumbel</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">p</span>, <span class="va">a</span>, <span class="va">b</span><span class="op">)</span> <span class="va">a</span><span class="op">-</span><span class="va">b</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fitgumbel</span> <span class="op">&lt;-</span> <span class="fu">fitdist</span><span class="op">(</span><span class="va">serving</span>, <span class="st">"gumbel"</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">10</span>, b<span class="op">=</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in fitdist(serving, "gumbel", start = list(a = 10, b = 10)):</span> The  dgumbel  function must be defined</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fitgumbel</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'fitgumbel' not found</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fitgumbel</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'fitgumbel' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (5) fit discrete distributions (Poisson and negative binomial)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">toxocara</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">number</span> <span class="op">&lt;-</span> <span class="va">toxocara</span><span class="op">$</span><span class="va">number</span></span></span>
<span class="r-in"><span><span class="va">fitp</span> <span class="op">&lt;-</span> <span class="fu">fitdist</span><span class="op">(</span><span class="va">number</span>,<span class="st">"pois"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fitp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting of the distribution ' pois ' by maximum likelihood </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameters : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda 8.679245  0.4046719</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loglikelihood:  -507.5334   AIC:  1017.067   BIC:  1019.037 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fitp</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fitdist-12.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">fitnb</span> <span class="op">&lt;-</span> <span class="fu">fitdist</span><span class="op">(</span><span class="va">number</span>,<span class="st">"nbinom"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fitnb</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting of the distribution ' nbinom ' by maximum likelihood </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameters : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> size 0.3971457 0.08289027</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mu   8.6802520 1.93501003</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loglikelihood:  -159.3441   AIC:  322.6882   BIC:  326.6288 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation matrix:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               size            mu</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> size  1.0000000000 -0.0001038553</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mu   -0.0001038553  1.0000000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fitnb</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fitdist-13.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="graphcomp.html">cdfcomp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">fitp</span>,<span class="va">fitnb</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fitdist-14.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="gofstat.html">gofstat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">fitp</span>,<span class="va">fitnb</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chi-squared statistic:  31256.96 7.48606 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Degree of freedom of the Chi-squared distribution:  5 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chi-squared p-value:  0 0.1123255 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    the p-value may be wrong with some theoretical counts &lt; 5  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chi-squared table:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       obscounts theo 1-mle-pois theo 2-mle-nbinom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;= 0         14     0.009014207         15.295027</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;= 1          8     0.078236512          5.808596</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;= 3          6     1.321767215          6.845015</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;= 4          6     2.131297776          2.407815</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;= 9          6    29.827829221          7.835196</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;= 21         6    19.626223732          8.271110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; 21          7     0.005631339          6.537242</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Goodness-of-fit criteria</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                1-mle-pois 2-mle-nbinom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Akaike's Information Criterion   1017.067     322.6882</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bayesian Information Criterion   1019.037     326.6288</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (6) how to change the optimisation method?</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">groundbeef</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">serving</span> <span class="op">&lt;-</span> <span class="va">groundbeef</span><span class="op">$</span><span class="va">serving</span></span></span>
<span class="r-in"><span><span class="fu">fitdist</span><span class="op">(</span><span class="va">serving</span>, <span class="st">"gamma"</span>, optim.method<span class="op">=</span><span class="st">"Nelder-Mead"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting of the distribution ' gamma ' by maximum likelihood </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape  4.009212  0.3420423</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scale 18.369492  1.6696165</span>
<span class="r-in"><span><span class="fu">fitdist</span><span class="op">(</span><span class="va">serving</span>, <span class="st">"gamma"</span>, optim.method<span class="op">=</span><span class="st">"BFGS"</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting of the distribution ' gamma ' by maximum likelihood </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape  4.008381  0.3419114</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scale 18.372884  1.6696162</span>
<span class="r-in"><span><span class="fu">fitdist</span><span class="op">(</span><span class="va">serving</span>, <span class="st">"gamma"</span>, optim.method<span class="op">=</span><span class="st">"SANN"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting of the distribution ' gamma ' by maximum likelihood </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape  4.01234   0.341034</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scale 18.34582   1.660326</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (7) custom optimization function</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co">#create the sample</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mysample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mystart</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rate<span class="op">=</span><span class="fl">8</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res1</span> <span class="op">&lt;-</span> <span class="fu">fitdist</span><span class="op">(</span><span class="va">mysample</span>, <span class="va">dexp</span>, start<span class="op">=</span> <span class="va">mystart</span>, optim.method<span class="op">=</span><span class="st">"Nelder-Mead"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#show the result</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting of the distribution ' exp ' by maximum likelihood </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameters : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate 5.120312  0.5120312</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loglikelihood:  63.32596   AIC:  -124.6519   BIC:  -122.0467 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#the warning tell us to use optimise, because the Nelder-Mead is not adequate.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#to meet the standard 'fn' argument and specific name arguments, we wrap optimize, </span></span></span>
<span class="r-in"><span><span class="va">myoptimize</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">fn</span>, <span class="va">par</span>, <span class="va">...</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/optimize.html" class="external-link">optimize</a></span><span class="op">(</span>f<span class="op">=</span><span class="va">fn</span>, <span class="va">...</span>, maximum<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>  </span></span>
<span class="r-in"><span>    <span class="co">#assume the optimization function minimize</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="va">standardres</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">res</span>, convergence<span class="op">=</span><span class="fl">0</span>, value<span class="op">=</span><span class="va">res</span><span class="op">$</span><span class="va">objective</span>, </span></span>
<span class="r-in"><span>        par<span class="op">=</span><span class="va">res</span><span class="op">$</span><span class="va">minimum</span>, hessian<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">standardres</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#call fitdist with a 'custom' optimization function</span></span></span>
<span class="r-in"><span><span class="va">res2</span> <span class="op">&lt;-</span> <span class="fu">fitdist</span><span class="op">(</span><span class="va">mysample</span>, <span class="st">"exp"</span>, start<span class="op">=</span><span class="va">mystart</span>, custom.optim<span class="op">=</span><span class="va">myoptimize</span>, </span></span>
<span class="r-in"><span>    interval<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#show the result</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting of the distribution ' exp ' by maximum likelihood </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameters : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate 5.120531         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loglikelihood:  63.32596   AIC:  -124.6519   BIC:  -122.0467 </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (8) custom optimization function - another example with the genetic algorithm</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span>    <span class="co">#set a sample</span></span></span>
<span class="r-in"><span>    <span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu">fitdist</span><span class="op">(</span><span class="va">serving</span>, <span class="st">"gamma"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting of the distribution ' gamma ' by maximum likelihood </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameters : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape  4.009212  0.3420423</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scale 18.369492  1.6696165</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loglikelihood:  -1253.625   AIC:  2511.25   BIC:  2518.325 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation matrix:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            shape      scale</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape  1.0000000 -0.9386832</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scale -0.9386832  1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co">#wrap genoud function rgenoud package</span></span></span>
<span class="r-in"><span>    <span class="va">mygenoud</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">fn</span>, <span class="va">par</span>, <span class="va">...</span><span class="op">)</span> </span></span>
<span class="r-in"><span>    <span class="op">{</span></span></span>
<span class="r-in"><span>        <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/JasjeetSekhon/rgenoud" class="external-link">rgenoud</a></span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rgenoud/man/genoud.html" class="external-link">genoud</a></span><span class="op">(</span><span class="va">fn</span>, starting.values<span class="op">=</span><span class="va">par</span>, <span class="va">...</span><span class="op">)</span>        </span></span>
<span class="r-in"><span>        <span class="va">standardres</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">res</span>, convergence<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span>            </span></span>
<span class="r-in"><span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">standardres</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co">#call fitdist with a 'custom' optimization function</span></span></span>
<span class="r-in"><span>    <span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu">fitdist</span><span class="op">(</span><span class="va">serving</span>, <span class="st">"gamma"</span>, custom.optim<span class="op">=</span><span class="va">mygenoud</span>, nvars<span class="op">=</span><span class="fl">2</span>,    </span></span>
<span class="r-in"><span>        Domains<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span>, boundary.enforcement<span class="op">=</span><span class="fl">1</span>, </span></span>
<span class="r-in"><span>        print.level<span class="op">=</span><span class="fl">1</span>, hessian<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: rgenoud</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ##  rgenoud (Version 5.9-0.10, Build Date: 2023-12-13)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ##  See http://sekhon.berkeley.edu/rgenoud for additional documentation.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ##  Please cite software as:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ##   Walter Mebane, Jr. and Jasjeet S. Sekhon. 2011.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ##   ``Genetic Optimization Using Derivatives: The rgenoud package for R.''</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ##   Journal of Statistical Software, 42(11): 1-26. </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ##</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fri Mar 22 09:27:40 2024</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Domains:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.000000e+00   &lt;=  X1   &lt;=    1.000000e+01 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.000000e+00   &lt;=  X2   &lt;=    1.000000e+01 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data Type: Floating Point</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Operators (code number, name, population) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	(1) Cloning........................... 	122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	(2) Uniform Mutation.................. 	125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	(3) Boundary Mutation................. 	125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	(4) Non-Uniform Mutation.............. 	125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	(5) Polytope Crossover................ 	125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	(6) Simple Crossover.................. 	126</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	(7) Whole Non-Uniform Mutation........ 	125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	(8) Heuristic Crossover............... 	126</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	(9) Local-Minimum Crossover........... 	0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HARD Maximum Number of Generations: 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum Nonchanging Generations: 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Population size       : 1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence Tolerance: 1.000000e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Using the BFGS Derivative Based Optimizer on the Best Individual Each Generation.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Checking Gradients before Stopping.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Not Using Out of Bounds Individuals But Allowing Trespassing.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Minimization Problem.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Generation#	    Solution Value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       0 	1.258660e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       1 	1.253625e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Doubling 'wait.generations' limit to 20 (from 10) because at least one gradient is too large.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G[1]: 2.412395e-02	 Solution Tolerance: 1.000000e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Doubling 'wait.generations' limit to 40 (from 20) because at least one gradient is too large.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G[1]: 2.631079e-02	 Solution Tolerance: 1.000000e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Doubling 'wait.generations' limit to 80 (from 40) because at least one gradient is too large.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G[1]: -1.363246e-03	 Solution Tolerance: 1.000000e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Doubling 'wait.generations' limit to 160 (from 80) because at least one gradient is too large.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G[2]: 3.134842e-03	 Solution Tolerance: 1.000000e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NOTE: HARD MAXIMUM GENERATION LIMIT HIT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         At least one gradient is too large</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Solution Fitness Value: 1.253625e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameters at the Solution (parameter, gradient):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  X[ 1] :	4.008337e+00	G[ 1] :	-2.464680e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  X[ 2] :	5.442733e-02	G[ 2] :	6.781599e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Solution Found Generation 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Generations Run 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fri Mar 22 09:27:52 2024</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total run time : 0 hours 0 minutes and 12 seconds</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting of the distribution ' gamma ' by maximum likelihood </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameters : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         estimate  Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape 4.00833723 0.341343681</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scale 0.05442733 0.004936213</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loglikelihood:  -1253.625   AIC:  2511.25   BIC:  2518.325 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation matrix:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]      [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 1.0000000 0.9384394</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.9384394 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (9) estimation of the standard deviation of a gamma distribution </span></span></span>
<span class="r-in"><span><span class="co"># by maximum likelihood with the shape fixed at 4 using the argument fix.arg</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">groundbeef</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">serving</span> <span class="op">&lt;-</span> <span class="va">groundbeef</span><span class="op">$</span><span class="va">serving</span></span></span>
<span class="r-in"><span><span class="va">f1c</span>  <span class="op">&lt;-</span> <span class="fu">fitdist</span><span class="op">(</span><span class="va">serving</span>,<span class="st">"gamma"</span>,start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rate<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span>,fix.arg<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>shape<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">f1c</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting of the distribution ' gamma ' by maximum likelihood </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameters : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        estimate  Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate 0.05431772 0.001703521</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fixed parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape     4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loglikelihood:  -1253.625   AIC:  2509.251   BIC:  2512.788 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">f1c</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fitdist-15.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (10) fit of a Weibull distribution to serving size data </span></span></span>
<span class="r-in"><span><span class="co"># by maximum likelihood estimation</span></span></span>
<span class="r-in"><span><span class="co"># or by quantile matching estimation (in this example </span></span></span>
<span class="r-in"><span><span class="co"># matching first and third quartiles)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">groundbeef</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">serving</span> <span class="op">&lt;-</span> <span class="va">groundbeef</span><span class="op">$</span><span class="va">serving</span></span></span>
<span class="r-in"><span><span class="va">fWmle</span> <span class="op">&lt;-</span> <span class="fu">fitdist</span><span class="op">(</span><span class="va">serving</span>, <span class="st">"weibull"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fWmle</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting of the distribution ' weibull ' by maximum likelihood </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameters : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape  2.185487  0.1045621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scale 83.348049  2.5273258</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loglikelihood:  -1255.225   AIC:  2514.449   BIC:  2521.524 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation matrix:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           shape     scale</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape 1.0000000 0.3216267</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scale 0.3216267 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fWmle</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fitdist-16.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="gofstat.html">gofstat</a></span><span class="op">(</span><span class="va">fWmle</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Goodness-of-fit statistics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                              1-mle-weibull</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Kolmogorov-Smirnov statistic     0.1396194</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cramer-von Mises statistic       0.6839428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Anderson-Darling statistic       3.5729448</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Goodness-of-fit criteria</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                1-mle-weibull</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Akaike's Information Criterion      2514.449</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bayesian Information Criterion      2521.524</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fWqme</span> <span class="op">&lt;-</span> <span class="fu">fitdist</span><span class="op">(</span><span class="va">serving</span>, <span class="st">"weibull"</span>, method<span class="op">=</span><span class="st">"qme"</span>, probs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.75</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fWqme</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting of the distribution ' weibull ' by matching quantiles </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameters : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape  2.267902</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scale 86.592340</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loglikelihood:  -1256.126   AIC:  2516.252   BIC:  2523.327 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fWqme</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fitdist-17.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="gofstat.html">gofstat</a></span><span class="op">(</span><span class="va">fWqme</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Goodness-of-fit statistics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                              1-qme-weibull</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Kolmogorov-Smirnov statistic     0.1692005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cramer-von Mises statistic       0.9657979</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Anderson-Darling statistic       4.8445844</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Goodness-of-fit criteria</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                1-qme-weibull</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Akaike's Information Criterion      2516.252</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bayesian Information Criterion      2523.327</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (11) Fit of a Pareto distribution by numerical moment matching estimation</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span>    <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://gitlab.com/vigou3/actuar" class="external-link">actuar</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: actuar</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘actuar’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:stats’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     sd, var</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following object is masked from ‘package:grDevices’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     cm</span>
<span class="r-in"><span>    <span class="co">#simulate a sample</span></span></span>
<span class="r-in"><span>    <span class="va">x4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/actuar/man/Pareto.html" class="external-link">rpareto</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">6</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co">#empirical raw moment</span></span></span>
<span class="r-in"><span>    <span class="va">memp</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">order</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="va">order</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co">#fit</span></span></span>
<span class="r-in"><span>    <span class="va">fP</span> <span class="op">&lt;-</span> <span class="fu">fitdist</span><span class="op">(</span><span class="va">x4</span>, <span class="st">"pareto"</span>, method<span class="op">=</span><span class="st">"mme"</span>, order<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, memp<span class="op">=</span><span class="st">"memp"</span>, </span></span>
<span class="r-in"><span>      start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>shape<span class="op">=</span><span class="fl">10</span>, scale<span class="op">=</span><span class="fl">10</span><span class="op">)</span>, lower<span class="op">=</span><span class="fl">1</span>, upper<span class="op">=</span><span class="cn">Inf</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in mmedist(data, distname, start = arg_startfix$start.arg, fix.arg = arg_startfix$fix.arg,     checkstartfix = TRUE, ...):</span> the empirical moment must be defined as a function</span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fP</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'fP' not found</span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fP</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'fP' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (12) Fit of a Weibull distribution to serving size data by maximum </span></span></span>
<span class="r-in"><span><span class="co"># goodness-of-fit estimation using all the distances available</span></span></span>
<span class="r-in"><span><span class="co"># </span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">groundbeef</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">serving</span> <span class="op">&lt;-</span> <span class="va">groundbeef</span><span class="op">$</span><span class="va">serving</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">f1</span> <span class="op">&lt;-</span> <span class="fu">fitdist</span><span class="op">(</span><span class="va">serving</span>, <span class="st">"weibull"</span>, method<span class="op">=</span><span class="st">"mge"</span>, gof<span class="op">=</span><span class="st">"CvM"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting of the distribution ' weibull ' by maximum goodness-of-fit </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape  2.093681</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scale 82.655261</span>
<span class="r-in"><span><span class="op">(</span><span class="va">f2</span> <span class="op">&lt;-</span> <span class="fu">fitdist</span><span class="op">(</span><span class="va">serving</span>, <span class="st">"weibull"</span>, method<span class="op">=</span><span class="st">"mge"</span>, gof<span class="op">=</span><span class="st">"KS"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting of the distribution ' weibull ' by maximum goodness-of-fit </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape  2.065642</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scale 81.450333</span>
<span class="r-in"><span><span class="op">(</span><span class="va">f3</span> <span class="op">&lt;-</span> <span class="fu">fitdist</span><span class="op">(</span><span class="va">serving</span>, <span class="st">"weibull"</span>, method<span class="op">=</span><span class="st">"mge"</span>, gof<span class="op">=</span><span class="st">"AD"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting of the distribution ' weibull ' by maximum goodness-of-fit </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape  2.125685</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scale 82.890296</span>
<span class="r-in"><span><span class="op">(</span><span class="va">f4</span> <span class="op">&lt;-</span> <span class="fu">fitdist</span><span class="op">(</span><span class="va">serving</span>, <span class="st">"weibull"</span>, method<span class="op">=</span><span class="st">"mge"</span>, gof<span class="op">=</span><span class="st">"ADR"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting of the distribution ' weibull ' by maximum goodness-of-fit </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape  2.072016</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scale 82.764844</span>
<span class="r-in"><span><span class="op">(</span><span class="va">f5</span> <span class="op">&lt;-</span> <span class="fu">fitdist</span><span class="op">(</span><span class="va">serving</span>, <span class="st">"weibull"</span>, method<span class="op">=</span><span class="st">"mge"</span>, gof<span class="op">=</span><span class="st">"ADL"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting of the distribution ' weibull ' by maximum goodness-of-fit </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape  2.197232</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scale 82.015202</span>
<span class="r-in"><span><span class="op">(</span><span class="va">f6</span> <span class="op">&lt;-</span> <span class="fu">fitdist</span><span class="op">(</span><span class="va">serving</span>, <span class="st">"weibull"</span>, method<span class="op">=</span><span class="st">"mge"</span>, gof<span class="op">=</span><span class="st">"AD2R"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting of the distribution ' weibull ' by maximum goodness-of-fit </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape  1.903196</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scale 81.332023</span>
<span class="r-in"><span><span class="op">(</span><span class="va">f7</span> <span class="op">&lt;-</span> <span class="fu">fitdist</span><span class="op">(</span><span class="va">serving</span>, <span class="st">"weibull"</span>, method<span class="op">=</span><span class="st">"mge"</span>, gof<span class="op">=</span><span class="st">"AD2L"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting of the distribution ' weibull ' by maximum goodness-of-fit </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape  2.48330</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scale 78.26215</span>
<span class="r-in"><span><span class="op">(</span><span class="va">f8</span> <span class="op">&lt;-</span> <span class="fu">fitdist</span><span class="op">(</span><span class="va">serving</span>, <span class="st">"weibull"</span>, method<span class="op">=</span><span class="st">"mge"</span>, gof<span class="op">=</span><span class="st">"AD2"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting of the distribution ' weibull ' by maximum goodness-of-fit </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape  2.081305</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scale 85.283908</span>
<span class="r-in"><span><span class="fu"><a href="graphcomp.html">cdfcomp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">f1</span>, <span class="va">f2</span>, <span class="va">f3</span>, <span class="va">f4</span>, <span class="va">f5</span>, <span class="va">f6</span>, <span class="va">f7</span>, <span class="va">f8</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fitdist-18.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="graphcomp.html">cdfcomp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">f1</span>, <span class="va">f2</span>, <span class="va">f3</span>, <span class="va">f4</span>, <span class="va">f5</span>, <span class="va">f6</span>, <span class="va">f7</span>, <span class="va">f8</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>  xlogscale<span class="op">=</span><span class="cn">TRUE</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">250</span><span class="op">)</span>, verticals<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fitdist-19.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="graphcomp.html">denscomp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">f1</span>, <span class="va">f2</span>, <span class="va">f3</span>, <span class="va">f4</span>, <span class="va">f5</span>, <span class="va">f6</span>, <span class="va">f7</span>, <span class="va">f8</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fitdist-20.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (13) Fit of a uniform distribution using maximum likelihood </span></span></span>
<span class="r-in"><span><span class="co"># (a closed formula is used in this special case where the loglikelihood is not defined),</span></span></span>
<span class="r-in"><span><span class="co"># or maximum goodness-of-fit with Cramer-von Mises or Kolmogorov-Smirnov distance</span></span></span>
<span class="r-in"><span><span class="co"># </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">u</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">50</span>, min<span class="op">=</span><span class="fl">5</span>, max<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fumle</span> <span class="op">&lt;-</span> <span class="fu">fitdist</span><span class="op">(</span><span class="va">u</span>, <span class="st">"unif"</span>, method<span class="op">=</span><span class="st">"mle"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fumle</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting of the distribution ' unif ' by maximum likelihood </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameters : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> min 5.047479         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> max 9.960752         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loglikelihood:  -79.59702   AIC:  163.194   BIC:  167.0181 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation matrix:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fumle</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fitdist-21.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="gofstat.html">gofstat</a></span><span class="op">(</span><span class="va">fumle</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Goodness-of-fit statistics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                              1-mle-unif</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Kolmogorov-Smirnov statistic  0.1340723</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cramer-von Mises statistic    0.1566892</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Anderson-Darling statistic          Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Goodness-of-fit criteria</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                1-mle-unif</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Akaike's Information Criterion   163.1940</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bayesian Information Criterion   167.0181</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fuCvM</span> <span class="op">&lt;-</span> <span class="fu">fitdist</span><span class="op">(</span><span class="va">u</span>, <span class="st">"unif"</span>, method<span class="op">=</span><span class="st">"mge"</span>, gof<span class="op">=</span><span class="st">"CvM"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fuCvM</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting of the distribution ' unif ' by maximum goodness-of-fit </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameters : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> min 5.110497</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> max 9.552878</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loglikelihood:  -Inf   AIC:  Inf   BIC:  Inf </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fuCvM</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fitdist-22.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="gofstat.html">gofstat</a></span><span class="op">(</span><span class="va">fuCvM</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Goodness-of-fit statistics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                              1-mge-unif</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Kolmogorov-Smirnov statistic 0.11370966</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cramer-von Mises statistic   0.07791651</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Anderson-Darling statistic          Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Goodness-of-fit criteria</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                1-mge-unif</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Akaike's Information Criterion        Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bayesian Information Criterion        Inf</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fuKS</span> <span class="op">&lt;-</span> <span class="fu">fitdist</span><span class="op">(</span><span class="va">u</span>, <span class="st">"unif"</span>, method<span class="op">=</span><span class="st">"mge"</span>, gof<span class="op">=</span><span class="st">"KS"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fuKS</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting of the distribution ' unif ' by maximum goodness-of-fit </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameters : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> min 5.092357</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> max 9.323818</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loglikelihood:  -Inf   AIC:  Inf   BIC:  Inf </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fuKS</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fitdist-23.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="gofstat.html">gofstat</a></span><span class="op">(</span><span class="va">fuKS</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Goodness-of-fit statistics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                              1-mge-unif</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Kolmogorov-Smirnov statistic 0.09216159</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cramer-von Mises statistic   0.12241830</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Anderson-Darling statistic          Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Goodness-of-fit criteria</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                1-mge-unif</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Akaike's Information Criterion        Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bayesian Information Criterion        Inf</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (14) scaling problem</span></span></span>
<span class="r-in"><span><span class="co"># the simulated dataset (below) has particularly small values, hence without scaling (10^0),</span></span></span>
<span class="r-in"><span><span class="co"># the optimization raises an error. The for loop shows how scaling by 10^i</span></span></span>
<span class="r-in"><span><span class="co"># for i=1,...,6 makes the fitting procedure work correctly.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1e-4</span>, <span class="fl">2e-4</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">0</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">i</span>, <span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu">fitdist</span><span class="op">(</span><span class="va">x2</span><span class="op">*</span><span class="fl">10</span><span class="op">^</span><span class="va">i</span>, <span class="st">"cauchy"</span>, method<span class="op">=</span><span class="st">"mle"</span><span class="op">)</span><span class="op">$</span><span class="va">estimate</span>, silent<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;simpleError in optim(par = vstart, fn = fnobj, fix.arg = fix.arg, obs = data,     gr = gradient, ddistnam = ddistname, hessian = TRUE, method = meth,     lower = lower, upper = upper, ...): non-finite finite-difference value [2]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0 Error in fitdist(x2 * 10^i, "cauchy", method = "mle") : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   the function mle failed to estimate the parameters, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 with the error code 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;simpleError in optim(par = vstart, fn = fnobj, fix.arg = fix.arg, obs = data,     gr = gradient, ddistnam = ddistname, hessian = TRUE, method = meth,     lower = lower, upper = upper, ...): non-finite finite-difference value [2]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Error in fitdist(x2 * 10^i, "cauchy", method = "mle") : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   the function mle failed to estimate the parameters, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 with the error code 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.001870693 0.01100646 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.01871473 0.1100713 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.1870693 1.100646 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 1.876032 11.0131 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 18.76032 110.131 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (15) Fit of a normal distribution on acute toxicity values of endosulfan in log10 for</span></span></span>
<span class="r-in"><span><span class="co"># nonarthropod invertebrates, using maximum likelihood estimation</span></span></span>
<span class="r-in"><span><span class="co"># to estimate what is called a species sensitivity distribution </span></span></span>
<span class="r-in"><span><span class="co"># (SSD) in ecotoxicology, followed by estimation of the 5 percent quantile value of </span></span></span>
<span class="r-in"><span><span class="co"># the fitted distribution (which is called the 5 percent hazardous concentration, HC5,</span></span></span>
<span class="r-in"><span><span class="co"># in ecotoxicology) and estimation of other quantiles.</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">endosulfan</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ATV</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">endosulfan</span>, <span class="va">group</span> <span class="op">==</span> <span class="st">"NonArthroInvert"</span><span class="op">)</span><span class="op">$</span><span class="va">ATV</span></span></span>
<span class="r-in"><span><span class="va">log10ATV</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">endosulfan</span>, <span class="va">group</span> <span class="op">==</span> <span class="st">"NonArthroInvert"</span><span class="op">)</span><span class="op">$</span><span class="va">ATV</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fln</span> <span class="op">&lt;-</span> <span class="fu">fitdist</span><span class="op">(</span><span class="va">log10ATV</span>, <span class="st">"norm"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="quantile.html">quantile</a></span><span class="op">(</span><span class="va">fln</span>, probs <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated quantiles for each specified probability (non-censored data)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            p=0.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> estimate 1.744227</span>
<span class="r-in"><span><span class="fu"><a href="quantile.html">quantile</a></span><span class="op">(</span><span class="va">fln</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated quantiles for each specified probability (non-censored data)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            p=0.05    p=0.1  p=0.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> estimate 1.744227 2.080093 2.4868</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (16) Fit of a triangular distribution using Cramer-von Mises or</span></span></span>
<span class="r-in"><span><span class="co"># Kolmogorov-Smirnov distance</span></span></span>
<span class="r-in"><span><span class="co"># </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">mc2d</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: mc2d</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: mvtnorm</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘mc2d’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:base’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     pmax, pmin</span>
<span class="r-in"><span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mc2d/man/triangular.html" class="external-link">rtriang</a></span><span class="op">(</span><span class="fl">100</span>, min<span class="op">=</span><span class="fl">5</span>, mode<span class="op">=</span><span class="fl">6</span>, max<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fCvM</span> <span class="op">&lt;-</span> <span class="fu">fitdist</span><span class="op">(</span><span class="va">t</span>, <span class="st">"triang"</span>, method<span class="op">=</span><span class="st">"mge"</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>min<span class="op">=</span><span class="fl">4</span>, mode<span class="op">=</span><span class="fl">6</span>,max<span class="op">=</span><span class="fl">9</span><span class="op">)</span>, gof<span class="op">=</span><span class="st">"CvM"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Some parameter names have no starting/fixed value but have a default value: mean.</span>
<span class="r-in"><span><span class="va">fKS</span> <span class="op">&lt;-</span> <span class="fu">fitdist</span><span class="op">(</span><span class="va">t</span>, <span class="st">"triang"</span>, method<span class="op">=</span><span class="st">"mge"</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>min<span class="op">=</span><span class="fl">4</span>, mode<span class="op">=</span><span class="fl">6</span>,max<span class="op">=</span><span class="fl">9</span><span class="op">)</span>, gof<span class="op">=</span><span class="st">"KS"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Some parameter names have no starting/fixed value but have a default value: mean.</span>
<span class="r-in"><span><span class="fu"><a href="graphcomp.html">cdfcomp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">fCvM</span>,<span class="va">fKS</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fitdist-24.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (17) fit a non classical discrete distribution (the zero inflated Poisson distribution)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://www.gamlss.com/" class="external-link">gamlss.dist</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: gamlss.dist</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss.dist/man/ZIP.html" class="external-link">rZIP</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">30</span>, mu <span class="op">=</span> <span class="fl">5</span>, sigma <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plotdist.html">plotdist</a></span><span class="op">(</span><span class="va">x</span>, discrete <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fitdist-25.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">fitzip</span> <span class="op">&lt;-</span> <span class="fu">fitdist</span><span class="op">(</span><span class="va">x</span>, <span class="st">"ZIP"</span>, start <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fl">4</span>, sigma <span class="op">=</span> <span class="fl">0.15</span><span class="op">)</span>, discrete <span class="op">=</span> <span class="cn">TRUE</span>, </span></span>
<span class="r-in"><span>  optim.method <span class="op">=</span> <span class="st">"L-BFGS-B"</span>, lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">Inf</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The dZIP function should return a zero-length vector when input has length zero</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The pZIP function should return a zero-length vector when input has length zero</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fitzip</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting of the distribution ' ZIP ' by maximum likelihood </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameters : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mu    4.3166139  0.4341218</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma 0.1891806  0.0741692</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loglikelihood:  -67.13886   AIC:  138.2777   BIC:  141.0801 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation matrix:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               mu      sigma</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mu    1.00000000 0.06418863</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma 0.06418863 1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fitzip</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fitdist-26.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">fitp</span> <span class="op">&lt;-</span> <span class="fu">fitdist</span><span class="op">(</span><span class="va">x</span>, <span class="st">"pois"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="graphcomp.html">cdfcomp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">fitzip</span>, <span class="va">fitp</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fitdist-27.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="gofstat.html">gofstat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">fitzip</span>, <span class="va">fitp</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chi-squared statistic:  3.579721 35.91516 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Degree of freedom of the Chi-squared distribution:  3 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chi-squared p-value:  0.3105689 3.012341e-07 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    the p-value may be wrong with some theoretical counts &lt; 5  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chi-squared table:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      obscounts theo 1-mle-ZIP theo 2-mle-pois</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;= 0         6       6.000030       0.9059215</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;= 2         7       4.425490       8.7194943</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;= 4         5       9.047502      12.1379326</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;= 5         5       4.054138       3.9650580</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;= 7         5       4.715296       3.4694258</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; 7          2       1.757544       0.8021677</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Goodness-of-fit criteria</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                1-mle-ZIP 2-mle-pois</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Akaike's Information Criterion  138.2777   153.7397</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bayesian Information Criterion  141.0801   155.1409</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (18) examples with distributions in actuar (predefined starting values)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://gitlab.com/vigou3/actuar" class="external-link">actuar</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.3</span>,<span class="fl">0.1</span>,<span class="fl">2.7</span>,<span class="fl">2.2</span>,<span class="fl">0.4</span>,<span class="fl">2.6</span>,<span class="fl">0.2</span>,<span class="fl">1.</span>,<span class="fl">7.3</span>,<span class="fl">3.2</span>,<span class="fl">0.8</span>,<span class="fl">1.2</span>,<span class="fl">33.7</span>,<span class="fl">14.</span>,</span></span>
<span class="r-in"><span>       <span class="fl">21.4</span>,<span class="fl">7.7</span>,<span class="fl">1.</span>,<span class="fl">1.9</span>,<span class="fl">0.7</span>,<span class="fl">12.6</span>,<span class="fl">3.2</span>,<span class="fl">7.3</span>,<span class="fl">4.9</span>,<span class="fl">4000.</span>,<span class="fl">2.5</span>,<span class="fl">6.7</span>,<span class="fl">3.</span>,<span class="fl">63.</span>,</span></span>
<span class="r-in"><span>       <span class="fl">6.</span>,<span class="fl">1.6</span>,<span class="fl">10.1</span>,<span class="fl">1.2</span>,<span class="fl">1.5</span>,<span class="fl">1.2</span>,<span class="fl">30.</span>,<span class="fl">3.2</span>,<span class="fl">3.5</span>,<span class="fl">1.2</span>,<span class="fl">0.2</span>,<span class="fl">1.9</span>,<span class="fl">0.7</span>,<span class="fl">17.</span>,</span></span>
<span class="r-in"><span>       <span class="fl">2.8</span>,<span class="fl">4.8</span>,<span class="fl">1.3</span>,<span class="fl">3.7</span>,<span class="fl">0.2</span>,<span class="fl">1.8</span>,<span class="fl">2.6</span>,<span class="fl">5.9</span>,<span class="fl">2.6</span>,<span class="fl">6.3</span>,<span class="fl">1.4</span>,<span class="fl">0.8</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#log logistic</span></span></span>
<span class="r-in"><span><span class="va">ft_llogis</span> <span class="op">&lt;-</span> <span class="fu">fitdist</span><span class="op">(</span><span class="va">x</span>,<span class="st">'llogis'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3837053</span>, <span class="fl">0.8576858</span>, <span class="fl">0.3552237</span>, <span class="fl">0.6226119</span>, <span class="fl">0.4783756</span>, <span class="fl">0.3139799</span>, <span class="fl">0.4051403</span>, </span></span>
<span class="r-in"><span>       <span class="fl">0.4537631</span>, <span class="fl">0.4711057</span>, <span class="fl">0.5647414</span>, <span class="fl">0.6479617</span>, <span class="fl">0.7134207</span>, <span class="fl">0.5259464</span>, <span class="fl">0.5949068</span>, </span></span>
<span class="r-in"><span>       <span class="fl">0.3509200</span>, <span class="fl">0.3783077</span>, <span class="fl">0.5226465</span>, <span class="fl">1.0241043</span>, <span class="fl">0.4384580</span>, <span class="fl">1.3341520</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#inverse weibull</span></span></span>
<span class="r-in"><span><span class="va">ft_iw</span> <span class="op">&lt;-</span> <span class="fu">fitdist</span><span class="op">(</span><span class="va">x</span>,<span class="st">'invweibull'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Marie-Laure Delignette-Muller, Christophe Dutang, Aurelie Siberchicot.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

