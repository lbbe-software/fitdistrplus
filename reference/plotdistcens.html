<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Plot of empirical and theoretical distributions for censored data — plotdistcens • fitdistrplus</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Plot of empirical and theoretical distributions for censored data — plotdistcens"><meta property="og:description" content="Plots an empirical distribution for censored data with a theoretical one if specified."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fitdistrplus</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1-8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/FAQ.html">Frequently Asked Questions</a>
    </li>
    <li>
      <a href="../articles/Optimalgo.html">Which optimization algorithm to choose?</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/aursiber/fitdistrplus/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot of empirical and theoretical distributions for censored data</h1>
    
    <div class="hidden name"><code>plotdistcens.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Plots an empirical distribution for censored data with a theoretical one if specified.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plotdistcens</span><span class="op">(</span><span class="va">censdata</span>, <span class="va">distr</span>, <span class="va">para</span>, leftNA <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, rightNA <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>    NPMLE <span class="op">=</span> <span class="cn">TRUE</span>, Turnbull.confint <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>    NPMLE.method <span class="op">=</span> <span class="st">"Wang"</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>censdata</dt>
<dd><p>A dataframe of two columns respectively named <code>left</code> 
    and <code>right</code>, describing each observed value as an interval.
    The <code>left</code> column contains either <code>NA</code> for left censored observations,
     the left bound of the interval for interval censored observations,
     or the observed value for non-censored observations.
     The <code>right</code> column contains either <code>NA</code> for right censored observations,
     the right bound of the interval for interval censored observations,
     or the observed value for non-censored observations.</p></dd>

<dt>distr</dt>
<dd><p>A character string <code>"name"</code> naming a distribution, for which the corresponding 
    density function <code>dname</code> and the corresponding distribution function <code>pname</code>
    must be defined, or directly the density function.</p></dd>

<dt>para</dt>
<dd><p>A named list giving the parameters of the named distribution. This argument may be 
    omitted only if <code>distr</code> is omitted.</p></dd>

<dt>leftNA</dt>
<dd><p>the real value of the left bound of left censored observations : <code>-Inf</code> 
    or a finite value such as <code>0</code> for positive data for example.</p></dd>

<dt>rightNA</dt>
<dd><p>the real value of the right bound of right censored observations : <code>Inf</code>
     or a finite value such as a realistic maximum value.</p></dd>

<dt>NPMLE</dt>
<dd><p>if TRUE an NPMLE (nonparametric maximum likelihood estimate) technique is 
    used to estimate the cdf curve of the censored data
    and previous arguments <code>leftNA</code> and <code>rightNA</code> are not used (see details)</p></dd>

<dt>Turnbull.confint</dt>
<dd><p>if TRUE confidence intervals will be added to the Turnbull plot.
    In that case NPMLE.method is forced to <code>"Turnbull.middlepoints"</code></p></dd>

<dt>NPMLE.method</dt>
<dd><p>Three NPMLE techniques are provided, <code>"Wang"</code>, the default one,
    rewritten from the package npsurv using function constrOptim from the package stats 
    for optimisation, <code>"Turnbull.middlepoints"</code>, an older one which is implemented in 
    the package survival and <code>"Turnbull.intervals"</code> that uses the same Turnbull algorithm 
    from the package survival but associates an interval to each equivalence class instead of the 
    middlepoint of this interval  (see details). Only <code>"Wang"</code> and
    <code>"Turnbull.intervals"</code> enable the derivation of a Q-Q plot and a P-P plot.</p></dd>

<dt>...</dt>
<dd><p>further graphical arguments passed to other methods. The title of the plot 
 can be modified using the argument <code>main</code> only for the CDF plot.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>If <code>NPMLE</code> is <code>TRUE</code>, and <code>NPMLE.method</code> is <code>"Wang"</code> ,
    empirical distributions are plotted
    in cdf using either the constrained Newton method (Wang, 2008)
    or the hierarchical constrained Newton method (Wang, 2013) 
    to compute the overall empirical cdf curve. 
     If <code>NPMLE</code> is <code>TRUE</code>, and <code>NPMLE.method</code> is <code>"Turnbull.intervals"</code> ,
    empirical are plotted
    in cdf using the EM approach of Turnbull  (Turnbull, 1974).
    In those two cases, grey rectangles represent areas
    where the empirical distribution function is not unique. In cases
    where a theoretical distribution is specified, two goodness-of-fit plots
    are also provided, a Q-Q plot (plot of the quantiles of the theoretical fitted 
    distribution (x-axis) against the empirical quantiles of the data) and a P-P plot
    (i.e. for each value of the data set, plot of the cumulative density function 
    of the fitted distribution (x-axis) against the empirical cumulative density function 
    (y-axis)). Grey rectangles in a Q-Q plot or a P-P plot also represent areas of 
    non uniqueness of empirical quantiles or probabilities, directly derived from 
    non uniqueness areas of the empirical cumulative distribution.</p>
<p>If <code>NPMLE</code> is <code>TRUE</code>, and <code>NPMLE.method</code> is <code>"Turnbull.middlepoints"</code>,
    empirical and, if specified, theoretical distributions are plotted
    in cdf using the EM approach of Turnbull (Turnbull, 1974) 
    to compute the overall 
    empirical cdf curve, with confidence intervals if <code>Turnbull.confint</code> is <code>TRUE</code>, 
    by calls to functions <code><a href="https://rdrr.io/pkg/survival/man/survfit.html" class="external-link">survfit</a></code> and <code><a href="https://rdrr.io/pkg/survival/man/plot.survfit.html" class="external-link">plot.survfit</a></code> from the 
    <code>survival</code> package.</p>    
<p>If <code>NPMLE</code> is <code>FALSE</code> empirical and, if specified, theoretical distributions 
    are plotted in cdf, with data directly reported as segments for interval, 
    left and right censored data, 
    and as points for non-censored data. Before plotting, observations are ordered and a rank r
    is associated to each of them. Left censored observations are ordered
    first, by their right bounds. Interval censored and non censored observations
    are then ordered by their mid-points and, at last, right censored observations are
    ordered by their left bounds. If <code>leftNA</code> (resp. <code>rightNA</code>) is finite,
    left censored (resp. right censored) observations are considered as interval censored
    observations and ordered by mid-points with non-censored and interval censored data.
    It is sometimes necessary to fix <code>rightNA</code> or <code>leftNA</code> to a realistic 
    extreme value, even if not exactly known, to obtain a reasonable global ranking of 
    observations. After ranking, each of the n observations is plotted as a point (one x-value) 
    or a segment (an interval of possible x-values),
    with an y-value equal to r/n, r being the rank of each observation in the global ordering
    previously described. This second method may be interesting but 
    is certainly less rigorous than the other methods
    that should be prefered.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="plotdist.html">plotdist</a></code>, <code><a href="https://rdrr.io/pkg/survival/man/survfit.formula.html" class="external-link">survfit.formula</a></code>.</p></div>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Turnbull BW (1974), <em>Nonparametric estimation of a survivorship function with doubly
censored data</em>. Journal of American Statistical Association, 69, 169-173.</p>
<p>Wang Y (2008), <em>Dimension-reduced nonparametric maximum likelihood computation
for interval-censored data</em>. Computational Statistics &amp; Data Analysis, 52, 2388-2402.</p>
<p>Wang Y and Taylor SM (2013), <em>Efficient computation of nonparametric survival
functions via a hierarchical mixture formulation</em>. Statistics and Computing, 23, 713-725.</p>
<p>Wang, Y., &amp; Fani, S. (2018), <em>Nonparametric maximum likelihood computation of a U-shaped hazard function</em>. Statistics and Computing, 28(1), 187-200.</p>
<p>Delignette-Muller ML and Dutang C (2015), <em>fitdistrplus: An R Package for Fitting Distributions</em>.
Journal of Statistical Software, 64(4), 1-34.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Marie-Laure Delignette-Muller and Christophe Dutang.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># (1) Plot of an empirical censored distribution (censored data) as a CDF</span></span></span>
<span class="r-in"><span><span class="co"># using the default Wang method</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">smokedfish</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">smokedfish</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plotdistcens</span><span class="op">(</span><span class="va">d1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotdistcens-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (2) Add the CDF of a normal distribution </span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="fu">plotdistcens</span><span class="op">(</span><span class="va">d1</span>, <span class="st">"norm"</span>, para<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="op">-</span><span class="fl">1.6</span>, sd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotdistcens-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (3) Various plots of the same empirical distribution </span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># default Wang plot with representation of equivalence classess</span></span></span>
<span class="r-in"><span><span class="fu">plotdistcens</span><span class="op">(</span><span class="va">d1</span>, NPMLE <span class="op">=</span> <span class="cn">TRUE</span>, NPMLE.method <span class="op">=</span> <span class="st">"Wang"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotdistcens-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># same plot but using the Turnbull alorithm from the package survival</span></span></span>
<span class="r-in"><span><span class="fu">plotdistcens</span><span class="op">(</span><span class="va">d1</span>, NPMLE <span class="op">=</span> <span class="cn">TRUE</span>, NPMLE.method <span class="op">=</span> <span class="st">"Wang"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Turnbull plot with middlepoints (as in the package survival)</span></span></span>
<span class="r-in"><span><span class="fu">plotdistcens</span><span class="op">(</span><span class="va">d1</span>, NPMLE <span class="op">=</span> <span class="cn">TRUE</span>, NPMLE.method <span class="op">=</span> <span class="st">"Turnbull.middlepoints"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Turnbull plot with middlepoints and confidence intervals</span></span></span>
<span class="r-in"><span><span class="fu">plotdistcens</span><span class="op">(</span><span class="va">d1</span>, NPMLE <span class="op">=</span> <span class="cn">TRUE</span>, NPMLE.method <span class="op">=</span> <span class="st">"Turnbull.middlepoints"</span>, Turnbull.confint <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotdistcens-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># with intervals and points</span></span></span>
<span class="r-in"><span><span class="fu">plotdistcens</span><span class="op">(</span><span class="va">d1</span>,rightNA<span class="op">=</span><span class="fl">3</span>, NPMLE <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotdistcens-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># with intervals and points</span></span></span>
<span class="r-in"><span><span class="co"># defining a minimum value for left censored values</span></span></span>
<span class="r-in"><span><span class="fu">plotdistcens</span><span class="op">(</span><span class="va">d1</span>,leftNA<span class="op">=</span><span class="op">-</span><span class="fl">3</span>, NPMLE <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotdistcens-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Marie-Laure Delignette-Muller, Christophe Dutang, Aurelie Siberchicot.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

