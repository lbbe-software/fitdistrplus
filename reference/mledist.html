<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Fit of univariate distributions using maximum likelihood for censored or non censored data."><title>Maximum likelihood fit of univariate distributions — mledist • fitdistrplus</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Maximum likelihood fit of univariate distributions — mledist"><meta property="og:description" content="Fit of univariate distributions using maximum likelihood for censored or non censored data."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">fitdistrplus</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1-9</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/FAQ.html">Frequently Asked Questions</a>
    <a class="dropdown-item" href="../articles/Optimalgo.html">Which optimization algorithm to choose?</a>
    <a class="dropdown-item" href="../articles/fitdistrplus_vignette.html">Overview of the fitdistrplus package</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/aursiber/fitdistrplus/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Maximum likelihood fit of univariate distributions</h1>
      
      <div class="d-none name"><code>mledist.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fit of univariate distributions using maximum likelihood for censored or non censored data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mledist</span><span class="op">(</span><span class="va">data</span>, <span class="va">distr</span>, start <span class="op">=</span> <span class="cn">NULL</span>, fix.arg <span class="op">=</span> <span class="cn">NULL</span>, optim.method <span class="op">=</span> <span class="st">"default"</span>, </span>
<span>    lower <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, upper <span class="op">=</span> <span class="cn">Inf</span>, custom.optim <span class="op">=</span> <span class="cn">NULL</span>, weights <span class="op">=</span> <span class="cn">NULL</span>, silent <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>    gradient <span class="op">=</span> <span class="cn">NULL</span>, checkstartfix<span class="op">=</span><span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>A numeric vector for non censored data or
    a dataframe of two columns respectively named <code>left</code> 
    and <code>right</code>, describing each observed value as an interval for censored data.
    In that case the <code>left</code> column contains either <code>NA</code> for left censored observations,
     the left bound of the interval for interval censored observations,
     or the observed value for non-censored observations.
     The <code>right</code> column contains either <code>NA</code> for right censored observations,
     the right bound of the interval for interval censored observations,
     or the observed value for non-censored observations.</p></dd>

<dt>distr</dt>
<dd><p>A character string <code>"name"</code> naming a distribution 
     for which the corresponding density function <code>dname</code> 
     and the corresponding distribution function <code>pname</code> must be classically defined.</p></dd>

<dt>start</dt>
<dd><p>A named list giving the initial values of parameters of the named distribution
    or a function of data computing initial values and returning a named list.
    This argument may be omitted (default) for some distributions for which reasonable 
    starting values are computed (see details).</p></dd>

<dt>fix.arg</dt>
<dd><p>An optional named list giving the values of fixed parameters of the named distribution
    or a function of data computing (fixed) parameter values and returning a named list. 
    Parameters with fixed value are thus NOT estimated by this maximum likelihood procedure.</p></dd>

<dt>optim.method</dt>
<dd><p><code>"default"</code> (see details) or an optimization method 
    to pass to <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code>.</p></dd>

<dt>lower</dt>
<dd><p>Left bounds on the parameters for the <code>"L-BFGS-B"</code> method 
    (see <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code>).</p></dd>

<dt>upper</dt>
<dd><p>Right bounds on the parameters for the <code>"L-BFGS-B"</code> method 
    (see <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code>).</p></dd>

<dt>custom.optim</dt>
<dd><p>a function carrying the MLE optimisation (see details).</p></dd>

<dt>weights</dt>
<dd><p>an optional vector of weights to be used in the fitting process. 
    Should be <code>NULL</code> or a numeric vector with strictly positive integers 
    (typically the number of occurences of each observation). If non-<code>NULL</code>, 
    weighted MLE is used, otherwise ordinary MLE.</p></dd>

<dt>silent</dt>
<dd><p>A logical to remove or show warnings when bootstraping.</p></dd>
    
<dt>gradient</dt>
<dd><p>A function to return the gradient of the log-likelihood for the <code>"BFGS"</code>, <code>"CG"</code> 
    and <code>"L-BFGS-B"</code> methods. If it is <code>NULL</code>, a finite-difference approximation will be used,
    see details.</p></dd>

<dt>checkstartfix</dt>
<dd><p>A logical to test starting and fixed values. Do not change it.</p></dd>
    
<dt>...</dt>
<dd><p>further arguments passed to the <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code>, 
    <code><a href="https://rdrr.io/r/stats/constrOptim.html" class="external-link">constrOptim</a></code> or <code>custom.optim</code> function.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function is not intended to be called directly but is internally called in
    <code><a href="fitdist.html">fitdist</a></code> and <code><a href="bootdist.html">bootdist</a></code> when used with the maximum likelihood method
    and <code><a href="fitdistcens.html">fitdistcens</a></code> and <code><a href="bootdistcens.html">bootdistcens</a></code>.</p>
<p>It is assumed that the <code>distr</code> argument specifies the distribution by the
    probability density function and the cumulative distribution function (d, p).
    The quantile function and the random generator function (q, r) may be
    needed by other function such as <code><a href="mmedist.html">mmedist</a></code>, <code><a href="qmedist.html">qmedist</a></code>, <code><a href="mgedist.html">mgedist</a></code>, 
    <code><a href="fitdist.html">fitdist</a></code>,<code><a href="fitdistcens.html">fitdistcens</a></code>, <code><a href="bootdistcens.html">bootdistcens</a></code> and <code><a href="bootdist.html">bootdist</a></code>.</p>  
<p>For the following named distributions, reasonable starting values will 
    be computed if <code>start</code> is omitted (i.e. <code>NULL</code>) : <code>"norm"</code>, <code>"lnorm"</code>,
    <code>"exp"</code> and <code>"pois"</code>, <code>"cauchy"</code>, <code>"gamma"</code>, <code>"logis"</code>,
    <code>"nbinom"</code> (parametrized by mu and size), <code>"geom"</code>, <code>"beta"</code>, <code>"weibull"</code>
    from the <code>stats</code> package; 
    <code>"invgamma"</code>, <code>"llogis"</code>, <code>"invweibull"</code>, <code>"pareto1"</code>, <code>"pareto"</code>,
    <code>"lgamma"</code>, <code>"trgamma"</code>, <code>"invtrgamma"</code>
    from the <code>actuar</code> package. 
    Note that these starting values may not be good enough if the fit is poor. 
    The function uses a closed-form formula to fit the uniform distribution.
    If <code>start</code> is a list, then it should be a named list with the same names as in
    the d,p,q,r functions of the chosen distribution.
    If <code>start</code> is a function of data, then the function should return a named list with the same names as in
    the d,p,q,r functions of the chosen distribution.</p>    
<p>The <code>mledist</code> function allows user to set a fixed values for some parameters.
    As for <code>start</code>, if <code>fix.arg</code> is a list, then it should be a named list with the same names as in
    the d,p,q,r functions of the chosen distribution.
    If <code>fix.arg</code> is a function of data, then the function should return a named list with the 
    same names as in the d,p,q,r functions of the chosen distribution.</p>
<p>When <code>custom.optim=NULL</code> (the default), maximum likelihood estimations 
    of the distribution parameters are computed with the R base <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code> or <code><a href="https://rdrr.io/r/stats/constrOptim.html" class="external-link">constrOptim</a></code>.
    If no finite bounds (<code>lower=-Inf</code> and <code>upper=Inf</code>) are supplied,  
    <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code> is used with the method specified by <code>optim.method</code>.
    Note that <code>optim.method="default"</code> means <code>optim.method="Nelder-Mead"</code> for distributions 
    with at least two parameters and <code>optim.method="BFGS"</code> for distributions with only one parameter.
    If finite bounds are supplied (among <code>lower</code> and <code>upper</code>) and <code>gradient != NULL</code>, 
    <code><a href="https://rdrr.io/r/stats/constrOptim.html" class="external-link">constrOptim</a></code> is used.
    If finite bounds are supplied (among <code>lower</code> and <code>upper</code>) and <code>gradient == NULL</code>, 
    <code><a href="https://rdrr.io/r/stats/constrOptim.html" class="external-link">constrOptim</a></code> is used when <code>optim.method="Nelder-Mead"</code>;
    <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code> is used when <code>optim.method="L-BFGS-B"</code> or <code>"Brent"</code>;
    in other case, an error is raised (same behavior as <code><a href="https://rdrr.io/r/stats/constrOptim.html" class="external-link">constrOptim</a></code>).</p>    
    
<p>When errors are raised by <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code>, it's a good idea to start by adding traces during
    the optimization process by adding <code>control=list(trace=1, REPORT=1)</code>.</p>    
<p>If <code>custom.optim</code> is not <code>NULL</code>, then the user-supplied function is used 
    instead of the R base <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code>. The <code>custom.optim</code> must have (at least) 
    the following arguments
    <code>fn</code> for the function to be optimized, <code>par</code> for the initialized parameters.
    Internally the function to be optimized will also have other arguments, 
    such as <code>obs</code> with observations and <code>ddistname</code>
    with distribution name for non censored data (Beware of potential conflicts with optional
    arguments of <code>custom.optim</code>). It is assumed that <code>custom.optim</code> should carry 
    out a MINIMIZATION. 
    Finally, it should return at least the following components <code>par</code> for the estimate, 
    <code>convergence</code> for the convergence code, <code>value</code> for <code>fn(par)</code>, 
    <code>hessian</code>, <code>counts</code> for the number of calls (function and gradient)
    and <code>message</code> (default to <code>NULL</code>) for the error message 
    when <code>custom.optim</code> raises an error, 
    see the returned value of <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code>. 
    See examples in <code><a href="fitdist.html">fitdist</a></code> and <code><a href="fitdistcens.html">fitdistcens</a></code>.</p>    
<p>Optionally, a vector of <code>weights</code> can be used in the fitting process. 
    By default (when <code>weigths=NULL</code>), ordinary MLE is carried out, otherwise 
    the specified weights are used to balance the log-likelihood contributions.
    It is not yet possible to take into account weights in functions <code>plotdist</code>, 
    <code>plotdistcens</code>, <code>plot.fitdist</code>, <code>plot.fitdistcens</code>, <code>cdfcomp</code>, 
    <code>cdfcompcens</code>, <code>denscomp</code>, <code>ppcomp</code>, <code>qqcomp</code>, <code>gofstat</code>, 
    <code>descdist</code>, <code>bootdist</code>, <code>bootdistcens</code> and <code>mgedist</code>.
    (developments planned in the future).</p>
    
<p>NB: if your data values are particularly small or large, a scaling may be needed 
    before the optimization process. See Example (7).</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p></p>
<p><code>mledist</code> returns a list with following components,</p>
<dl><dt>estimate</dt>
<dd><p>the parameter estimates.</p></dd>

    <dt>convergence</dt>
<dd><p>an integer code for the convergence of 
    <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code>/<code><a href="https://rdrr.io/r/stats/constrOptim.html" class="external-link">constrOptim</a></code> defined as below
    or defined by the user in the user-supplied optimization function. 
        <code>0</code> indicates successful convergence.
        <code>1</code> indicates that the iteration limit of <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code> has been reached.
        <code>10</code> indicates degeneracy of the Nealder-Mead simplex.
        <code>100</code> indicates that <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code> encountered an internal error.</p></dd>

    <dt>value</dt>
<dd><p>the minimal value reached for the criterion to minimize.</p></dd>
    
    <dt>hessian</dt>
<dd><p>a symmetric matrix computed by <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code> as an estimate of the Hessian
        at the solution found or computed in the user-supplied optimization function.
        It is used in <code>fitdist</code> to estimate standard errors.</p></dd>

    <dt>optim.function</dt>
<dd><p>the name of the optimization function used for maximum likelihood.</p></dd>

    <dt>optim.method</dt>
<dd><p>when <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code> is used, the name of the
    algorithm used, the field <code>method</code> of the <code>custom.optim</code> function
    otherwise.</p></dd>

    <dt>fix.arg</dt>
<dd><p>the named list giving the values of parameters of the named distribution
        that must kept fixed rather than estimated by maximum likelihood or <code>NULL</code> 
        if there are no such parameters.</p></dd>

    <dt>fix.arg.fun</dt>
<dd><p>the function used to set the value of <code>fix.arg</code> or <code>NULL</code>.</p></dd>

    <dt>weights</dt>
<dd><p>the vector of weigths used in the estimation process or <code>NULL</code>.</p></dd>

    <dt>counts</dt>
<dd><p>A two-element integer vector giving the number of calls 
    to the log-likelihood function and its gradient respectively. 
    This excludes those calls needed to compute the Hessian, if requested, 
    and any calls to log-likelihood function to compute a finite-difference
    approximation to the gradient. <code>counts</code> is returned by <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code>
    or the user-supplied function or set to <code>NULL</code>.</p></dd>

    <dt>optim.message</dt>
<dd><p>A character string giving any additional information 
    returned by the optimizer, or <code>NULL</code>. To understand exactly the message,
    see the source code.</p></dd>

    <dt>loglik</dt>
<dd><p>the log-likelihood value.</p></dd>

    <dt>method</dt>
<dd><p><code>"closed formula"</code> if appropriate otherwise <code>NULL</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="mmedist.html">mmedist</a></code>, <code><a href="qmedist.html">qmedist</a></code>, <code><a href="mgedist.html">mgedist</a></code>, 
    <code><a href="fitdist.html">fitdist</a></code>,<code><a href="fitdistcens.html">fitdistcens</a></code> for other estimation methods,
    <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code>, <code><a href="https://rdrr.io/r/stats/constrOptim.html" class="external-link">constrOptim</a></code> for optimization routines,
    <code><a href="bootdistcens.html">bootdistcens</a></code> and <code><a href="bootdist.html">bootdist</a></code> for bootstrap,
    and <code><a href="logLik-plot.html">llplot</a></code> for plotting the (log)likelihood.</p></div>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
     

<p>Venables WN and Ripley BD (2002), <em>Modern applied statistics with S</em>.
Springer, New York, pp. 435-446.</p>
<p>Delignette-Muller ML and Dutang C (2015), <em>fitdistrplus: An R Package for Fitting Distributions</em>.
Journal of Statistical Software, 64(4), 1-34.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Marie-Laure Delignette-Muller and Christophe Dutang.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (1) basic fit of a normal distribution with maximum likelihood estimation</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">mledist</span><span class="op">(</span><span class="va">x1</span>,<span class="st">"norm"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       mean         sd </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.1567617  0.9993707 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $convergence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 141.8309</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hessian</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         mean       sd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mean 100.126   0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sd     0.000 200.2538</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optim.function</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "optim"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optim.method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Nelder-Mead"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fix.arg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fix.arg.fun</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $weights</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $counts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function gradient </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       43       NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optim.message</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $loglik</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -141.8309</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (2) defining your own distribution functions, here for the Gumbel distribution</span></span></span>
<span class="r-in"><span><span class="co"># for other distributions, see the CRAN task view dedicated to probability distributions</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dgumbel</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">a</span>,<span class="va">b</span><span class="op">)</span> <span class="fl">1</span><span class="op">/</span><span class="va">b</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">(</span><span class="va">a</span><span class="op">-</span><span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="va">b</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">(</span><span class="va">a</span><span class="op">-</span><span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="va">b</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">mledist</span><span class="op">(</span><span class="va">x1</span>,<span class="st">"gumbel"</span>,start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">10</span>,b<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in checkparamlist(arg_startfix$start.arg, arg_startfix$fix.arg,     argddistname, hasnodefaultval):</span> 'start' must specify names which are arguments to 'distr'.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (3) fit of a discrete distribution (Poisson)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">30</span>,lambda <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">mledist</span><span class="op">(</span><span class="va">x2</span>,<span class="st">"pois"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1.7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $convergence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 46.18434</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hessian</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          lambda</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda 17.64707</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optim.function</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "optim"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optim.method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "BFGS"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fix.arg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fix.arg.fun</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $weights</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $counts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function gradient </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        6        1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optim.message</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $loglik</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -46.18434</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (4) fit a finite-support distribution (beta)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span>,shape1<span class="op">=</span><span class="fl">5</span>, shape2<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">mledist</span><span class="op">(</span><span class="va">x3</span>,<span class="st">"beta"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    shape1    shape2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4.859798 10.918841 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $convergence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -78.33052</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hessian</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           shape1    shape2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape1 16.295311 -6.542752</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape2 -6.542752  3.047900</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optim.function</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "optim"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optim.method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Nelder-Mead"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fix.arg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fix.arg.fun</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $weights</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $counts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function gradient </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       47       NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optim.message</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $loglik</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 78.33052</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (5) fit frequency distributions on USArrests dataset.</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x4</span> <span class="op">&lt;-</span> <span class="va">USArrests</span><span class="op">$</span><span class="va">Assault</span></span></span>
<span class="r-in"><span><span class="fu">mledist</span><span class="op">(</span><span class="va">x4</span>, <span class="st">"pois"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 170.76 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $convergence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1211.705</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hessian</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           lambda</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda 0.2928087</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optim.function</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "optim"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optim.method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "BFGS"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fix.arg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fix.arg.fun</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $weights</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $counts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function gradient </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        3        1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optim.message</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $loglik</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1211.705</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">mledist</span><span class="op">(</span><span class="va">x4</span>, <span class="st">"nbinom"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       size         mu </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3.822579 170.747853 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $convergence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 290.3297</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hessian</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               size            mu</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> size  1.759308e+00 -1.993783e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mu   -1.993783e-05  6.413018e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optim.function</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "optim"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optim.method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Nelder-Mead"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fix.arg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fix.arg.fun</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $weights</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $counts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function gradient </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       47       NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optim.message</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $loglik</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -290.3297</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (6) fit a continuous distribution (Gumbel) to censored data.</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">fluazinam</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">log10EC50</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">fluazinam</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># definition of the Gumbel distribution</span></span></span>
<span class="r-in"><span><span class="va">dgumbel</span>  <span class="op">&lt;-</span>  <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">a</span>,<span class="va">b</span><span class="op">)</span> <span class="fl">1</span><span class="op">/</span><span class="va">b</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">(</span><span class="va">a</span><span class="op">-</span><span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="va">b</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">(</span><span class="va">a</span><span class="op">-</span><span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="va">b</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pgumbel</span>  <span class="op">&lt;-</span>  <span class="kw">function</span><span class="op">(</span><span class="va">q</span>,<span class="va">a</span>,<span class="va">b</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">(</span><span class="va">a</span><span class="op">-</span><span class="va">q</span><span class="op">)</span><span class="op">/</span><span class="va">b</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">qgumbel</span>  <span class="op">&lt;-</span>  <span class="kw">function</span><span class="op">(</span><span class="va">p</span>,<span class="va">a</span>,<span class="va">b</span><span class="op">)</span> <span class="va">a</span><span class="op">-</span><span class="va">b</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">mledist</span><span class="op">(</span><span class="va">log10EC50</span>,<span class="st">"gumbel"</span>,start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">0</span>,b<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,optim.method<span class="op">=</span><span class="st">"Nelder-Mead"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in checkparamlist(arg_startfix$start.arg, arg_startfix$fix.arg,     argddistname, hasnodefaultval):</span> 'start' must specify names which are arguments to 'distr'.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (7) scaling problem</span></span></span>
<span class="r-in"><span><span class="co"># the simulated dataset (below) has particularly small values, </span></span></span>
<span class="r-in"><span><span class="co"># hence without scaling (10^0),</span></span></span>
<span class="r-in"><span><span class="co"># the optimization raises an error. The for loop shows how scaling by 10^i</span></span></span>
<span class="r-in"><span><span class="co"># for i=1,...,6 makes the fitting procedure work correctly.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1e-4</span>, <span class="fl">2e-4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">6</span><span class="op">:</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">i</span>, <span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu">mledist</span><span class="op">(</span><span class="va">x</span><span class="op">*</span><span class="fl">10</span><span class="op">^</span><span class="va">i</span>, <span class="st">"cauchy"</span><span class="op">)</span><span class="op">$</span><span class="va">estimate</span>, silent<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 Error in mledist(x * 10^i, "cauchy") : object 'x' not found</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Error in mledist(x * 10^i, "cauchy") : object 'x' not found</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 Error in mledist(x * 10^i, "cauchy") : object 'x' not found</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 Error in mledist(x * 10^i, "cauchy") : object 'x' not found</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Error in mledist(x * 10^i, "cauchy") : object 'x' not found</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Error in mledist(x * 10^i, "cauchy") : object 'x' not found</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0 Error in mledist(x * 10^i, "cauchy") : object 'x' not found</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-in"><span>        </span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="co"># (17) small example for the zero-modified geometric distribution</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dzmgeom</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">p1</span>, <span class="va">p2</span><span class="op">)</span> <span class="va">p1</span> <span class="op">*</span> <span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p1</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Geometric.html" class="external-link">dgeom</a></span><span class="op">(</span><span class="va">x</span><span class="op">-</span><span class="fl">1</span>, <span class="va">p2</span><span class="op">)</span> <span class="co">#pdf</span></span></span>
<span class="r-in"><span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,  <span class="fl">4</span>,  <span class="fl">0</span>, <span class="fl">40</span>,  <span class="fl">4</span>, <span class="fl">21</span>,  <span class="fl">0</span>,  <span class="fl">0</span>,  <span class="fl">0</span>,  <span class="fl">2</span>,  <span class="fl">5</span>,  <span class="fl">0</span>,  <span class="fl">0</span>, <span class="fl">13</span>,  <span class="fl">2</span><span class="op">)</span> <span class="co">#simulated dataset</span></span></span>
<span class="r-in"><span><span class="va">initp1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>p1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="co">#init as MLE</span></span></span>
<span class="r-in"><span><span class="fu">mledist</span><span class="op">(</span><span class="va">x2</span>, <span class="st">"zmgeom"</span>, fix.arg<span class="op">=</span><span class="va">initp1</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>p2<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in checkparamlist(arg_startfix$start.arg, arg_startfix$fix.arg,     argddistname, hasnodefaultval):</span> 'start' must specify names which are arguments to 'distr'.</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Marie-Laure Delignette-Muller, Christophe Dutang, Aurelie Siberchicot.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

