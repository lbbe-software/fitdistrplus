<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Frequently Asked Questions • fitdistrplus</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Frequently Asked Questions">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">fitdistrplus</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2-4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/fitdistrplus_vignette.html">Overview of the fitdistrplus package</a></li>
    <li><a class="dropdown-item" href="../articles/FAQ.html">Frequently Asked Questions</a></li>
    <li><a class="dropdown-item" href="../articles/Optimalgo.html">Which optimization algorithm to choose?</a></li>
    <li><a class="dropdown-item" href="../articles/starting-values.html">Starting values used in fitdistrplus</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lbbe-software/fitdistrplus/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Frequently Asked Questions</h1>
                        <h4 data-toc-skip class="author">Marie Laure
Delignette Muller, Christophe Dutang</h4>
            
            <h4 data-toc-skip class="date">2025-11-26</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/lbbe-software/fitdistrplus/blob/master/vignettes/FAQ.Rmd" class="external-link"><code>vignettes/FAQ.Rmd</code></a></small>
      <div class="d-none name"><code>FAQ.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="questions-regarding-distributions">1. Questions regarding distributions<a class="anchor" aria-label="anchor" href="#questions-regarding-distributions"></a>
</h2>
<div class="section level3">
<h3 id="how-do-i-know-the-root-name-of-a-distribution">1.1. How do I know the root name of a distribution?<a class="anchor" aria-label="anchor" href="#how-do-i-know-the-root-name-of-a-distribution"></a>
</h3>
<p>The root name of a probability distribution is the <code>name</code>
which is used the <code>d</code>, <code>p</code>, <code>q</code>,
<code>r</code> functions. For base R distributions, the root names are
given in R-intro : <a href="https://cran.r-project.org/doc/manuals/R-intro.html#Probability-distributions" class="external-link uri">https://cran.r-project.org/doc/manuals/R-intro.html#Probability-distributions</a>.
For example, you must use <code>"pois"</code> for the Poisson
distribution and <strong>not</strong> <code>"poisson"</code>.</p>
</div>
<div class="section level3">
<h3 id="how-do-i-find-non-standard-distributions">1.2. How do I find “non standard” distributions?<a class="anchor" aria-label="anchor" href="#how-do-i-find-non-standard-distributions"></a>
</h3>
<p>For non-standard distributions, you can either find a package
implementing them or define by yourself. A comprehensive list of
non-standard distributions is given in the Distributions task view <a href="https://CRAN.R-project.org/view=Distributions" class="external-link uri">https://CRAN.R-project.org/view=Distributions</a>. Here are
some two examples of user-defined distributions. A third example
(shifted exponential) is given in FAQ 3.5.4.</p>
<ul>
<li>The Gumbel distribution</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dgumbel</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">a</span>, <span class="va">b</span><span class="op">)</span> <span class="fl">1</span><span class="op">/</span><span class="va">b</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">(</span><span class="va">a</span><span class="op">-</span><span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="va">b</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">(</span><span class="va">a</span><span class="op">-</span><span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="va">b</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pgumbel</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">q</span>, <span class="va">a</span>, <span class="va">b</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">(</span><span class="va">a</span><span class="op">-</span><span class="va">q</span><span class="op">)</span><span class="op">/</span><span class="va">b</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">qgumbel</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">p</span>, <span class="va">a</span>, <span class="va">b</span><span class="op">)</span> <span class="va">a</span><span class="op">-</span><span class="va">b</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">groundbeef</span><span class="op">)</span></span>
<span><span class="va">fitgumbel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">groundbeef</span><span class="op">$</span><span class="va">serving</span>, <span class="st">"gumbel"</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">10</span>, b<span class="op">=</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>The zero-modified geometric distribution</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dzmgeom</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">p1</span>, <span class="va">p2</span><span class="op">)</span> <span class="va">p1</span> <span class="op">*</span> <span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p1</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Geometric.html" class="external-link">dgeom</a></span><span class="op">(</span><span class="va">x</span><span class="op">-</span><span class="fl">1</span>, <span class="va">p2</span><span class="op">)</span></span>
<span><span class="va">pzmgeom</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">q</span>, <span class="va">p1</span>, <span class="va">p2</span><span class="op">)</span> <span class="va">p1</span> <span class="op">*</span> <span class="op">(</span><span class="va">q</span> <span class="op">&gt;=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p1</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Geometric.html" class="external-link">pgeom</a></span><span class="op">(</span><span class="va">q</span><span class="op">-</span><span class="fl">1</span>, <span class="va">p2</span><span class="op">)</span></span>
<span><span class="va">rzmgeom</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">p1</span>, <span class="va">p2</span><span class="op">)</span> </span>
<span><span class="op">{</span></span>
<span>  <span class="va">u</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">-</span><span class="va">p1</span><span class="op">)</span> <span class="co">#prob to get zero is p1</span></span>
<span>  <span class="va">u</span><span class="op">[</span><span class="va">u</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Geometric.html" class="external-link">rgeom</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">u</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span>, <span class="va">p2</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span></span>
<span>  <span class="va">u</span></span>
<span><span class="op">}</span></span>
<span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/actuar/man/ZeroModifiedGeometric.html" class="external-link">rzmgeom</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">x2</span>, <span class="st">"zmgeom"</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>p1<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span>, p2<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="how-do-i-set-or-find-initial-values-for-non-standard-distributions">1.3. How do I set (or find) initial values for non standard
distributions?<a class="anchor" aria-label="anchor" href="#how-do-i-set-or-find-initial-values-for-non-standard-distributions"></a>
</h3>
<p>As documented, we provide initial values for the following
distributions: <code>"norm"</code>, <code>"lnorm"</code>,
<code>"exp"</code>, <code>"pois"</code>, <code>"cauchy"</code>,
<code>"gamma</code>“, <code>"logis"</code>, <code>"nbinom"</code>,
<code>"geom"</code>, <code>"beta"</code>, <code>"weibull"</code> from
the <code>stats</code> package; all distributions (except phase-type
distributions) from the <code>actuar</code> package.</p>
<p>Look first at statistics and probability books such as</p>
<ul>
<li>different volumes of N. L. Johnson, S. Kotz and N. Balakrishnan
books, e.g. <strong>Continuous Univariate Distributions, Vol.
1</strong>,<br>
</li>
<li>
<strong>Thesaurus of univariate discrete probability
distributions</strong> by G. Wimmer and G. Altmann.<br>
</li>
<li>
<strong>Statistical Distributions</strong> by M. Evans, N. Hastings,
B. Peacock.<br>
</li>
<li>
<strong>Distributional Analysis with L-moment Statistics using the R
Environment for Statistical Computing</strong> by W. Asquith.</li>
</ul>
<p>If not available, find initial values by equalling theoretical and
empirical quartiles. The graphical function <code><a href="../reference/plotdist.html">plotdist()</a></code> and
<code><a href="../reference/plotdistcens.html">plotdistcens()</a></code> can also be used to assess the suitability
of starting values : by an iterative manual process you can move
parameter values so as to obtain a distribution that roughly fits the
data and take these parameter values as starting values for the real
fit. You may also consider the <code><a href="../reference/prefit.html">prefit()</a></code> function to find
initial values especially in case where parameters are constrained.</p>
</div>
<div class="section level3">
<h3 id="is-it-possible-to-fit-a-distribution-with-at-least-3-parameters">1.4. Is it possible to fit a distribution with at least 3
parameters?<a class="anchor" aria-label="anchor" href="#is-it-possible-to-fit-a-distribution-with-at-least-3-parameters"></a>
</h3>
<p>Yes, an example with the Burr distribution is detailed in the JSS
paper. We reproduce it very quickly here.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"endosulfan"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://gitlab.com/vigou3/actuar" class="external-link">"actuar"</a></span><span class="op">)</span></span>
<span><span class="va">fendo.B</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">endosulfan</span><span class="op">$</span><span class="va">ATV</span>, <span class="st">"burr"</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>shape1 <span class="op">=</span> <span class="fl">0.3</span>, </span>
<span>                                                        shape2 <span class="op">=</span> <span class="fl">1</span>, rate <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fendo.B</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Fitting of the distribution ' burr ' by maximum likelihood </span></span>
<span><span class="co">## Parameters : </span></span>
<span><span class="co">##        estimate Std. Error</span></span>
<span><span class="co">## shape1    0.206     0.0561</span></span>
<span><span class="co">## shape2    1.540     0.3188</span></span>
<span><span class="co">## rate      1.497     0.4683</span></span>
<span><span class="co">## Loglikelihood:  -520   AIC:  1046   BIC:  1054 </span></span>
<span><span class="co">## Correlation matrix:</span></span>
<span><span class="co">##        shape1 shape2   rate</span></span>
<span><span class="co">## shape1  1.000 -0.900 -0.727</span></span>
<span><span class="co">## shape2 -0.900  1.000  0.588</span></span>
<span><span class="co">## rate   -0.727  0.588  1.000</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="why-there-are-differences-between-mle-and-mme-for-the-lognormal-distribution">1.5. Why there are differences between MLE and MME for the lognormal
distribution?<a class="anchor" aria-label="anchor" href="#why-there-are-differences-between-mle-and-mme-for-the-lognormal-distribution"></a>
</h3>
<p>We recall that the lognormal distribution function is given by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>X</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>μ</mi></mrow><mi>σ</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
F_X(x) =  \Phi\left(\frac{\log(x)-\mu}{\sigma} \right),
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Φ</mi><annotation encoding="application/x-tex">\Phi</annotation></semantics></math>
denotes the distribution function of the standard normal distribution.
We know that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">E(X) = \exp\left( \mu+\frac{1}{2} \sigma^2 \right)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mi>a</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mi>μ</mi><mo>+</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>e</mi><msup><mi>σ</mi><mn>2</mn></msup></msup><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Var(X) = \exp\left( 2\mu+\sigma^2\right) (e^{\sigma^2} -1)</annotation></semantics></math>.
The MME is obtained by inverting the previous formulas, whereas the MLE
has the following explicit solution</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>μ</mi><mo accent="true">̂</mo></mover><mrow><mi>M</mi><mi>L</mi><mi>E</mi></mrow></msub><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><msubsup><mover><mi>σ</mi><mo accent="true">̂</mo></mover><mrow><mi>M</mi><mi>L</mi><mi>E</mi></mrow><mn>2</mn></msubsup><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msup><mrow><mo stretchy="true" form="prefix">(</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mover><mi>μ</mi><mo accent="true">̂</mo></mover><mrow><mi>M</mi><mi>L</mi><mi>E</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mi>.</mi></mrow><annotation encoding="application/x-tex">
\hat\mu_{MLE} = \frac{1}{n}\sum_{i=1}^n \log(x_i),~~
\hat\sigma^2_{MLE} = \frac{1}{n}\sum_{i=1}^n (\log(x_i) - \hat\mu_{MLE})^2.
</annotation></semantics></math></p>
<p>Let us fit a sample by MLE and MME. The fit looks particularly good
in both cases.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">f1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">x3</span>, <span class="st">"lnorm"</span>, method<span class="op">=</span><span class="st">"mle"</span><span class="op">)</span> </span>
<span><span class="va">f2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">x3</span>, <span class="st">"lnorm"</span>, method<span class="op">=</span><span class="st">"mme"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/graphcomp.html">cdfcomp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">f1</span>, <span class="va">f2</span><span class="op">)</span>, do.points<span class="op">=</span><span class="cn">FALSE</span>, xlogscale <span class="op">=</span> <span class="cn">TRUE</span>, main <span class="op">=</span> <span class="st">"CDF plot"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/graphcomp.html">denscomp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">f1</span>, <span class="va">f2</span><span class="op">)</span>, demp<span class="op">=</span><span class="cn">TRUE</span>, main <span class="op">=</span> <span class="st">"Density plot"</span><span class="op">)</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-4-1.png" class="r-plt" width="672"></p>
<p>Let us compare the theoretical moments (mean and variance) given the
fitted values</p>
<p>(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>μ</mi><mo accent="true">̂</mo></mover><mo>,</mo><mover><mi>σ</mi><mo accent="true">̂</mo></mover></mrow><annotation encoding="application/x-tex">\hat\mu,\hat\sigma</annotation></semantics></math>),
that is
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>μ</mi><mo accent="true">̂</mo></mover><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msup><mover><mi>σ</mi><mo accent="true">̂</mo></mover><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>V</mi><mi>a</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mover><mi>μ</mi><mo accent="true">̂</mo></mover><mo>+</mo><msup><mover><mi>σ</mi><mo accent="true">̂</mo></mover><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>e</mi><msup><mover><mi>σ</mi><mo accent="true">̂</mo></mover><mn>2</mn></msup></msup><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
E(X) = \exp\left( \hat\mu+\frac{1}{2} \hat\sigma^2 \right),
Var(X) = \exp\left( 2\hat\mu+\hat\sigma^2\right) (e^{\hat\sigma^2} -1).
</annotation></semantics></math></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"E(X) by MME"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">f2</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="st">"meanlog"</span><span class="op">]</span><span class="op">+</span><span class="va">f2</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="st">"sdlog"</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    <span class="st">"E(X) by MLE"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">f1</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="st">"meanlog"</span><span class="op">]</span><span class="op">+</span><span class="va">f1</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="st">"sdlog"</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    <span class="st">"empirical"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## E(X) by MME E(X) by MLE   empirical </span></span>
<span><span class="co">##        1.61        1.60        1.61</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Var(X) by MME"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">f2</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="st">"meanlog"</span><span class="op">]</span><span class="op">+</span><span class="va">f2</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="st">"sdlog"</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">*</span> </span>
<span>                               <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">f2</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="st">"sdlog"</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    <span class="st">"Var(X) by MLE"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">f1</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="st">"meanlog"</span><span class="op">]</span><span class="op">+</span><span class="va">f1</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="st">"sdlog"</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">*</span> </span>
<span>                                 <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">f1</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="st">"sdlog"</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    <span class="st">"empirical"</span><span class="op">=</span><span class="fu">var</span><span class="op">(</span><span class="va">x3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Var(X) by MME Var(X) by MLE     empirical </span></span>
<span><span class="co">##          4.30          4.36          4.30</span></span></code></pre>
<p>From a MLE point of view, a lognormal sample
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>x</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">x_1,\dots,x_n</annotation></semantics></math>
is equivalent to handle a normal sample
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>…</mi><mo>,</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\log(x_1),\dots,\log(x_n)</annotation></semantics></math>.
However, it is well know by the Jensen inequality that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>≥</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">E(X) = E(\exp(\log(X))) \geq \exp(E(\log(X)))</annotation></semantics></math>
implying the MME estimates provides better moment estimates than with
MLE.</p>
</div>
<div class="section level3">
<h3 id="can-i-fit-a-distribution-with-positive-support-when-data-contains-negative-values">1.6. Can I fit a distribution with positive support when data
contains negative values?<a class="anchor" aria-label="anchor" href="#can-i-fit-a-distribution-with-positive-support-when-data-contains-negative-values"></a>
</h3>
<p>The answer is no: you cannot fit a distribution with positive support
(say gamma distribution) when data contains negative values.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, mean <span class="op">=</span> <span class="fl">1</span>, sd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"exp"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in computing default starting values.</span></span>
<span><span class="co">## Error in manageparam(start.arg = start, fix.arg = fix.arg, obs = data,  : </span></span>
<span><span class="co">##   Error in startarg_transgamma_family(x, distr) : </span></span>
<span><span class="co">##   values must be positive to fit an exponential distribution</span></span></code></pre>
<pre><code><span><span class="co">## [1] "Error in manageparam(start.arg = start, fix.arg = fix.arg, obs = data,  : \n  Error in startarg_transgamma_family(x, distr) : \n  values must be positive to fit an exponential distribution\n\n"</span></span>
<span><span class="co">## attr(,"class")</span></span>
<span><span class="co">## [1] "try-error"</span></span>
<span><span class="co">## attr(,"condition")</span></span>
<span><span class="co">## &lt;simpleError in manageparam(start.arg = start, fix.arg = fix.arg, obs = data,     distname = distname): Error in startarg_transgamma_family(x, distr) : </span></span>
<span><span class="co">##   values must be positive to fit an exponential distribution</span></span>
<span><span class="co">## &gt;</span></span></code></pre>
<p>It is irrelevant to do such fit. If you really need to use that
distribution, you have two options: either to remove negative values
(not recommended) or to shift the data.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">x</span> <span class="op">&gt;=</span> <span class="fl">0</span><span class="op">]</span>, <span class="st">"exp"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Fitting of the distribution ' exp ' by maximum likelihood </span></span>
<span><span class="co">## Parameters:</span></span>
<span><span class="co">##      estimate Std. Error</span></span>
<span><span class="co">## rate     1.06      0.107</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="st">"exp"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Fitting of the distribution ' exp ' by maximum likelihood </span></span>
<span><span class="co">## Parameters:</span></span>
<span><span class="co">##      estimate Std. Error</span></span>
<span><span class="co">## rate    0.914     0.0914</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="can-i-fit-a-finite-support-distribution-when-data-is-outside-that-support">1.7. Can I fit a finite-support distribution when data is outside
that support?<a class="anchor" aria-label="anchor" href="#can-i-fit-a-finite-support-distribution-when-data-is-outside-that-support"></a>
</h3>
<p>The answer is no: you cannot fit a distribution with finite-support
(say beta distribution) when data is outside
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[0,1]</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, mean <span class="op">=</span> <span class="fl">0.5</span>, sd <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"beta"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in computing default starting values.</span></span>
<span><span class="co">## Error in manageparam(start.arg = start, fix.arg = fix.arg, obs = data,  : </span></span>
<span><span class="co">##   Error in startargdefault(obs, distname) : </span></span>
<span><span class="co">##   values must be in [0-1] to fit a beta distribution</span></span></code></pre>
<pre><code><span><span class="co">## [1] "Error in manageparam(start.arg = start, fix.arg = fix.arg, obs = data,  : \n  Error in startargdefault(obs, distname) : \n  values must be in [0-1] to fit a beta distribution\n\n"</span></span>
<span><span class="co">## attr(,"class")</span></span>
<span><span class="co">## [1] "try-error"</span></span>
<span><span class="co">## attr(,"condition")</span></span>
<span><span class="co">## &lt;simpleError in manageparam(start.arg = start, fix.arg = fix.arg, obs = data,     distname = distname): Error in startargdefault(obs, distname) : </span></span>
<span><span class="co">##   values must be in [0-1] to fit a beta distribution</span></span>
<span><span class="co">## &gt;</span></span></code></pre>
<p>It is irrelevant to do such a fit. If you really need to use that
distribution, you have two ways to tackle this issue: either to remove
impossible values (not recommended) or to shift/scale the data.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">x</span> <span class="op">&lt;</span> <span class="fl">1</span><span class="op">]</span>, <span class="st">"beta"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Fitting of the distribution ' beta ' by maximum likelihood </span></span>
<span><span class="co">## Parameters:</span></span>
<span><span class="co">##        estimate Std. Error</span></span>
<span><span class="co">## shape1     2.08      0.288</span></span>
<span><span class="co">## shape2     2.50      0.352</span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">*</span><span class="fl">1.01</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1.01</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1.01</span><span class="op">)</span>, <span class="st">"beta"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Fitting of the distribution ' beta ' by maximum likelihood </span></span>
<span><span class="co">## Parameters:</span></span>
<span><span class="co">##        estimate Std. Error</span></span>
<span><span class="co">## shape1     1.77      0.236</span></span>
<span><span class="co">## shape2     2.17      0.296</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="can-i-fit-truncated-distributions">1.8. Can I fit truncated distributions?<a class="anchor" aria-label="anchor" href="#can-i-fit-truncated-distributions"></a>
</h3>
<p>The answer is yes: but the fitting procedure must be carried out
carefully. Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>
be the original untruncated random variable. The truncated variable is
the conditionnal random variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><mi>X</mi><mspace width="0.222em"></mspace><mo stretchy="false" form="postfix">|</mo><mspace width="0.222em"></mspace><mi>l</mi><mo>&lt;</mo><mi>X</mi><mo>&lt;</mo><mi>u</mi></mrow><annotation encoding="application/x-tex">Y = X ~\vert~ l&lt; X &lt;u</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo>&lt;</mo><mi>u</mi></mrow><annotation encoding="application/x-tex">l&lt;u</annotation></semantics></math>
the lower and upper bounds. The cdf of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>
is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>Y</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><msub><mi>F</mi><mi>X</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mi>F</mi><mi>X</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>l</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msub><mi>F</mi><mi>X</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mi>F</mi><mi>X</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>l</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">F_Y(y)=\frac{F_X(x) - F_X(l)}{F_X(u)-F_X(l)}</annotation></semantics></math>.
There is a density (w.r.t. the Lebesgues measure) given by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>Y</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mfrac><mrow><msub><mi>f</mi><mi>X</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msub><mi>F</mi><mi>X</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mi>F</mi><mi>X</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>l</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>l</mi><mo>&lt;</mo><mi>x</mi><mo>&lt;</mo><mi>u</mi></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>0</mn></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">otherwise </mtext><mspace width="0.333em"></mspace></mrow></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
f_Y(y) = 
\left\{\begin{array}{ll}
\frac{f_X(x)}{F_X(u)-F_X(l)} &amp; \text{if }  l &lt; x &lt; u \\
0 &amp; \text{otherwise }\\
\end{array}\right.
</annotation></semantics></math></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dtexp</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">rate</span>, <span class="va">low</span>, <span class="va">upp</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">PU</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">pexp</a></span><span class="op">(</span><span class="va">upp</span>, rate<span class="op">=</span><span class="va">rate</span><span class="op">)</span></span>
<span>  <span class="va">PL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">pexp</a></span><span class="op">(</span><span class="va">low</span>, rate<span class="op">=</span><span class="va">rate</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">dexp</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">rate</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">PU</span><span class="op">-</span><span class="va">PL</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">x</span> <span class="op">&gt;=</span> <span class="va">low</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">x</span> <span class="op">&lt;=</span> <span class="va">upp</span><span class="op">)</span> </span>
<span><span class="op">}</span></span>
<span><span class="va">ptexp</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">q</span>, <span class="va">rate</span>, <span class="va">low</span>, <span class="va">upp</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">PU</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">pexp</a></span><span class="op">(</span><span class="va">upp</span>, rate<span class="op">=</span><span class="va">rate</span><span class="op">)</span></span>
<span>  <span class="va">PL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">pexp</a></span><span class="op">(</span><span class="va">low</span>, rate<span class="op">=</span><span class="va">rate</span><span class="op">)</span></span>
<span>  <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">pexp</a></span><span class="op">(</span><span class="va">q</span>, <span class="va">rate</span><span class="op">)</span><span class="op">-</span><span class="va">PL</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">PU</span><span class="op">-</span><span class="va">PL</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">q</span> <span class="op">&gt;=</span> <span class="va">low</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">q</span> <span class="op">&lt;=</span> <span class="va">upp</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">*</span> <span class="op">(</span><span class="va">q</span> <span class="op">&gt;</span> <span class="va">upp</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>; <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">.5</span> <span class="op">&amp;</span> <span class="va">x</span> <span class="op">&lt;</span> <span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">f1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"texp"</span>, method<span class="op">=</span><span class="st">"mle"</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rate<span class="op">=</span><span class="fl">3</span><span class="op">)</span>, </span>
<span>              fix.arg<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>low<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, upp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">f2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"texp"</span>, method<span class="op">=</span><span class="st">"mle"</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rate<span class="op">=</span><span class="fl">3</span><span class="op">)</span>, </span>
<span>              fix.arg<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>low<span class="op">=</span><span class="fl">.5</span>, upp<span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/gofstat.html">gofstat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">f1</span>, <span class="va">f2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Goodness-of-fit statistics</span></span>
<span><span class="co">##                              1-mle-texp 2-mle-texp</span></span>
<span><span class="co">## Kolmogorov-Smirnov statistic     0.0952      0.084</span></span>
<span><span class="co">## Cramer-von Mises statistic       0.1343      0.104</span></span>
<span><span class="co">## Anderson-Darling statistic          Inf      1.045</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Goodness-of-fit criteria</span></span>
<span><span class="co">##                                1-mle-texp 2-mle-texp</span></span>
<span><span class="co">## Akaike's Information Criterion        127        132</span></span>
<span><span class="co">## Bayesian Information Criterion        130        135</span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/graphcomp.html">cdfcomp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">f1</span>, <span class="va">f2</span><span class="op">)</span>, do.points <span class="op">=</span> <span class="cn">FALSE</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-10-1.png" class="r-plt" width="672"></p>
</div>
<div class="section level3">
<h3 id="can-i-fit-truncated-inflated-distributions">1.9. Can I fit truncated inflated distributions?<a class="anchor" aria-label="anchor" href="#can-i-fit-truncated-inflated-distributions"></a>
</h3>
<p>The answer is yes: but the fitting procedure must be carried out
carefully. Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>
be the original untruncated random variable. The truncated variable is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><mo>max</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>min</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo>,</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>l</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Y = \max(\min(X, u), l)</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo>&lt;</mo><mi>u</mi></mrow><annotation encoding="application/x-tex">l&lt;u</annotation></semantics></math>
the lower and upper bounds. The cdf of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>
is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>Y</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>F</mi><mi>X</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mn>1</mn><mrow><mi>u</mi><mo>&gt;</mo><mi>y</mi><mo>&gt;</mo><mi>l</mi></mrow></msub><mo>+</mo><msub><mn>1</mn><mrow><mi>y</mi><mo>&gt;</mo><mi>u</mi></mrow></msub></mrow><annotation encoding="application/x-tex">F_Y(y)=F_X(y)1_{u&gt;y&gt;l} + 1_{y&gt;u}</annotation></semantics></math>.
There is no density (w.r.t. the Lebesgues measure) since there are two
probability masses
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo>=</mo><mi>l</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo>≤</mo><mi>l</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">P(Y=l)= P(X\leq l)&gt;0</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo>=</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo>&gt;</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">P(Y=u)=P(X&gt;u)&gt;0</annotation></semantics></math>.
However, the density function with respect to the measure
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>δ</mi><mi>l</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>δ</mi><mi>u</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>λ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">m(x)= \delta_l(x)+\delta_u(x)+\lambda(x)</annotation></semantics></math>
is
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>Y</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><msub><mi>F</mi><mi>X</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>l</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>y</mi><mo>=</mo><mi>l</mi></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><msub><mi>f</mi><mi>X</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>l</mi><mo>&lt;</mo><mi>y</mi><mo>&lt;</mo><mi>u</mi></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>1</mn><mo>−</mo><msub><mi>F</mi><mi>X</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>y</mi><mo>=</mo><mi>u</mi></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
f_Y(y) = 
\left\{\begin{array}{ll}
F_X(l) &amp; \text{if } y=l \\
f_X(y) &amp; \text{if } l&lt;y&lt;u \\
1-F_X(u) &amp; \text{if } y=u \\
\end{array}\right.
</annotation></semantics></math> Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
be the parameter of the untruncated distribution. Since the likelihood
can be factorized, the maximization can be done separately
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>l</mi><mo>,</mo><mi>θ</mi><mo>,</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mn>1</mn><mrow><mo>∀</mo><mi>i</mi><mo>,</mo><mi>l</mi><mo>≤</mo><msub><mi>y</mi><mi>i</mi></msub><mo>≤</mo><mi>u</mi></mrow></msub><munderover><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mi>l</mi></mrow><mi>n</mi></munderover><msub><mi>F</mi><mi>X</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>l</mi><mo>,</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>×</mo><munderover><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>l</mi><mo>&lt;</mo><msub><mi>y</mi><mi>i</mi></msub><mo>&lt;</mo><mi>u</mi></mrow><mi>n</mi></munderover><msub><mi>f</mi><mi>X</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>,</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>×</mo><munderover><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mi>u</mi></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>F</mi><mi>X</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo>,</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
L(l, \theta, u) = 1_{\forall i, l\leq y_i\leq u} \prod_{i=1, y_i=l}^n F_X(l, \theta)
\times \prod_{i=1,l&lt;y_i&lt;u}^n f_X(y_i, \theta)
\times \prod_{i=1,y_i=u}^n (1-F_X(u, \theta)),
</annotation></semantics></math> Furthermore, using
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∀</mo><mi>i</mi><mo>,</mo><mi>l</mi><mo>≤</mo><msub><mi>y</mi><mi>i</mi></msub><mo>≤</mo><mi>u</mi><mo>⇔</mo><mi>l</mi><mo>≤</mo><msub><mo>min</mo><mi>i</mi></msub><msub><mi>y</mi><mi>i</mi></msub><mo>≤</mo><msub><mo>max</mo><mi>i</mi></msub><msub><mi>y</mi><mi>i</mi></msub><mo>≤</mo><mi>u</mi></mrow><annotation encoding="application/x-tex">\forall i, l\leq y_i\leq u\Leftrightarrow l\leq \min_i y_i\leq \max_i y_i\leq u</annotation></semantics></math>,
the likelihood is zero for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo>&gt;</mo><msub><mo>min</mo><mi>i</mi></msub><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">l&gt;\min_i y_i</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>&lt;</mo><msub><mo>max</mo><mi>i</mi></msub><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">u&lt;\max_i y_i</annotation></semantics></math>
and increasing with respect to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>l</mi><annotation encoding="application/x-tex">l</annotation></semantics></math>
in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="postfix">]</mo><mo>−</mo><mi>∞</mi><mo>,</mo><msub><mo>min</mo><mi>i</mi></msub><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">]-\infty, \min_i y_i]</annotation></semantics></math>
and decreasing with respect to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>u</mi><annotation encoding="application/x-tex">u</annotation></semantics></math>
in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">[</mo><msub><mo>max</mo><mi>i</mi></msub><msub><mi>y</mi><mi>i</mi></msub><mo>,</mo><mo>+</mo><mi>∞</mi><mo stretchy="false" form="prefix">[</mo></mrow><annotation encoding="application/x-tex">[\max_i y_i,+\infty[</annotation></semantics></math>.
So the maximum of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>L</mi><annotation encoding="application/x-tex">L</annotation></semantics></math>
is reached at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo>=</mo><msub><mo>min</mo><mi>i</mi></msub><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">l=\min_i y_i</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>=</mo><msub><mo>max</mo><mi>i</mi></msub><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">u=\max_i y_i</annotation></semantics></math>.
<!--i.e.~the MLE is $\hat l=\min_i Y_i$ and $\hat u=\max_i Y_i$,--> The
MLE of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
is then obtained by maximizing the log-likelihood
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>l</mi><mo>,</mo><mi>θ</mi><mo>,</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\log(L(l, \theta, u))</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>=</mo><msub><mo>max</mo><mi>i</mi></msub><msub><mi>Y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">u=\max_i Y_i</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo>=</mo><msub><mo>min</mo><mi>i</mi></msub><msub><mi>Y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">l=\min_i Y_i</annotation></semantics></math>.</p>
<p>Let us illustrate truncated distribution with the truncated
exponential distribution. The log-likelihood is particularly
bad-shaped.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dtiexp</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">rate</span>, <span class="va">low</span>, <span class="va">upp</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">PU</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">pexp</a></span><span class="op">(</span><span class="va">upp</span>, rate<span class="op">=</span><span class="va">rate</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">PL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">pexp</a></span><span class="op">(</span><span class="va">low</span>, rate<span class="op">=</span><span class="va">rate</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">dexp</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">rate</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">x</span> <span class="op">&gt;=</span> <span class="va">low</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">x</span> <span class="op">&lt;=</span> <span class="va">upp</span><span class="op">)</span> <span class="op">+</span> <span class="va">PL</span> <span class="op">*</span> <span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="va">low</span><span class="op">)</span> <span class="op">+</span> <span class="va">PU</span> <span class="op">*</span> <span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="va">upp</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">ptiexp</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">q</span>, <span class="va">rate</span>, <span class="va">low</span>, <span class="va">upp</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">pexp</a></span><span class="op">(</span><span class="va">q</span>, <span class="va">rate</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">q</span> <span class="op">&gt;=</span> <span class="va">low</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">q</span> <span class="op">&lt;=</span> <span class="va">upp</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">*</span> <span class="op">(</span><span class="va">q</span> <span class="op">&gt;</span> <span class="va">upp</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span>; <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mc2d/man/pmin.html" class="external-link">pmax</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/mc2d/man/pmin.html" class="external-link">pmin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fl">.5</span><span class="op">)</span></span>
<span><span class="co"># the loglikelihood has a discontinous point at the solution</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, mfrow<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/logLik-surface.html">llcurve</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"tiexp"</span>, plot.arg<span class="op">=</span><span class="st">"low"</span>, fix.arg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rate<span class="op">=</span><span class="fl">2</span>, upp<span class="op">=</span><span class="fl">5</span><span class="op">)</span>, </span>
<span>        min.arg<span class="op">=</span><span class="fl">0</span>, max.arg<span class="op">=</span><span class="fl">.5</span>, lseq<span class="op">=</span><span class="fl">200</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/logLik-surface.html">llcurve</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"tiexp"</span>, plot.arg<span class="op">=</span><span class="st">"upp"</span>, fix.arg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rate<span class="op">=</span><span class="fl">2</span>, low<span class="op">=</span><span class="fl">0</span><span class="op">)</span>, </span>
<span>        min.arg<span class="op">=</span><span class="fl">3</span>, max.arg<span class="op">=</span><span class="fl">4</span>, lseq<span class="op">=</span><span class="fl">200</span><span class="op">)</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-11-1.png" class="r-plt" width="672"></p>
<p>The first method directly maximizes the log-likelihood
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>l</mi><mo>,</mo><mi>θ</mi><mo>,</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">L(l, \theta, u)</annotation></semantics></math>;
the second method maximizes the log-likelihood
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">L(\theta)</annotation></semantics></math>
assuming that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>=</mo><mover><mi>u</mi><mo accent="true">̂</mo></mover></mrow><annotation encoding="application/x-tex">u=\hat u</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo>=</mo><mover><mi>l</mi><mo accent="true">̂</mo></mover></mrow><annotation encoding="application/x-tex">l=\hat l</annotation></semantics></math>
are known. Inside
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mn>0.5</mn><mo>,</mo><mn>3</mn><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[0.5,3]</annotation></semantics></math>,
the CDF are correctly estimated in both methods but the first method
does not succeed to estimate the true value of the bounds
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo>,</mo><mi>u</mi></mrow><annotation encoding="application/x-tex">l,u</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">f1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"tiexp"</span>, method<span class="op">=</span><span class="st">"mle"</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rate<span class="op">=</span><span class="fl">3</span>, low<span class="op">=</span><span class="fl">0</span>, upp<span class="op">=</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Fitting of the distribution ' tiexp ' by maximum likelihood </span></span>
<span><span class="co">## Parameters:</span></span>
<span><span class="co">##      estimate</span></span>
<span><span class="co">## rate    0.949</span></span>
<span><span class="co">## low    -0.502</span></span>
<span><span class="co">## upp    23.072</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">f2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"tiexp"</span>, method<span class="op">=</span><span class="st">"mle"</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rate<span class="op">=</span><span class="fl">3</span><span class="op">)</span>, </span>
<span>               fix.arg<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>low<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, upp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Fitting of the distribution ' tiexp ' by maximum likelihood </span></span>
<span><span class="co">## Parameters:</span></span>
<span><span class="co">##      estimate Std. Error</span></span>
<span><span class="co">## rate    0.947     0.0982</span></span>
<span><span class="co">## Fixed parameters:</span></span>
<span><span class="co">##     value</span></span>
<span><span class="co">## low   0.5</span></span>
<span><span class="co">## upp   3.0</span></span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gofstat.html">gofstat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">f1</span>, <span class="va">f2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Goodness-of-fit statistics</span></span>
<span><span class="co">##                              1-mle-tiexp 2-mle-tiexp</span></span>
<span><span class="co">## Kolmogorov-Smirnov statistic       0.378       0.377</span></span>
<span><span class="co">## Cramer-von Mises statistic         1.890       1.882</span></span>
<span><span class="co">## Anderson-Darling statistic        10.222      10.193</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Goodness-of-fit criteria</span></span>
<span><span class="co">##                                1-mle-tiexp 2-mle-tiexp</span></span>
<span><span class="co">## Akaike's Information Criterion         216         162</span></span>
<span><span class="co">## Bayesian Information Criterion         224         165</span></span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/graphcomp.html">cdfcomp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">f1</span>, <span class="va">f2</span><span class="op">)</span>, do.points <span class="op">=</span> <span class="cn">FALSE</span>, addlegend<span class="op">=</span><span class="cn">FALSE</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span><span class="fu">ptiexp</span><span class="op">(</span><span class="va">x</span>, <span class="fl">1</span>, <span class="fl">.5</span>, <span class="fl">3</span><span class="op">)</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="st">"blue"</span>, lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>, lty<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"green"</span>, <span class="st">"blue"</span>, <span class="st">"black"</span><span class="op">)</span>, </span>
<span>        legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"full MLE"</span>, <span class="st">"MLE fixed arg"</span>, <span class="st">"true CDF"</span>, <span class="st">"emp. CDF"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-12-1.png" class="r-plt" width="672"></p>
</div>
<div class="section level3">
<h3 id="can-i-fit-a-uniform-distribution">1.10. Can I fit a uniform distribution?<a class="anchor" aria-label="anchor" href="#can-i-fit-a-uniform-distribution"></a>
</h3>
<p>The uniform distribution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝒰</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal U(a,b)</annotation></semantics></math>
has only support parameters since the density does not have a scale or a
shape parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>U</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mi>b</mi><mo>−</mo><mi>a</mi></mrow></mfrac><msub><mn>1</mn><mrow><mo stretchy="true" form="prefix">[</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">]</mo></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">f_U(u) = \frac{1}{b-a}1_{[a,b]}(u)</annotation></semantics></math>.
For this distribution, we should not maximize the log-likelihood but
only the likelihood. Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>i</mi></msub><annotation encoding="application/x-tex">(x_i)_i</annotation></semantics></math>
be i.i.d. observations from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝒰</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal U(a,b)</annotation></semantics></math>
distribution. The likelihood is
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mfrac><mn>1</mn><mrow><mi>b</mi><mo>−</mo><mi>a</mi></mrow></mfrac><msub><mn>1</mn><mrow><mo stretchy="true" form="prefix">[</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">]</mo></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mn>1</mn><mrow><mi>a</mi><mo>≤</mo><msub><mi>x</mi><mi>i</mi></msub><mo>≤</mo><mi>b</mi><mo>,</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>n</mi></mrow></msub><msup><mfrac><mn>1</mn><mrow><mi>b</mi><mo>−</mo><mi>a</mi></mrow></mfrac><mi>n</mi></msup><mo>=</mo><msub><mn>1</mn><mrow><mi>a</mi><mo>≤</mo><munder><mo>min</mo><mi>i</mi></munder><msub><mi>x</mi><mi>i</mi></msub></mrow></msub><msub><mn>1</mn><mrow><munder><mo>max</mo><mi>i</mi></munder><msub><mi>x</mi><mi>i</mi></msub><mo>≤</mo><mi>b</mi></mrow></msub><msup><mfrac><mn>1</mn><mrow><mi>b</mi><mo>−</mo><mi>a</mi></mrow></mfrac><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">
L(a,b) = \prod_{i=1}^n \frac{1}{b-a} 1_{[a,b]}(x_i)
= 1_{a\leq x_i \leq b, i=1,\dots,n} \frac{1}{b-a}^n
= 1_{a\leq \min_i x_i} 1_{\max_i x_i \leq b} \frac{1}{b-a}^n
</annotation></semantics></math> Hence
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>↦</mo><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">a\mapsto L(a,b)</annotation></semantics></math>
for any fixed
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>∈</mo><mo stretchy="false" form="postfix">]</mo><msub><mo>max</mo><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><mo>+</mo><mi>∞</mi><mo stretchy="false" form="prefix">[</mo></mrow><annotation encoding="application/x-tex">b\in]\max_i x_i, +\infty[</annotation></semantics></math>
is increasing on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="postfix">]</mo><mo>−</mo><mi>∞</mi><mo>,</mo><msub><mo>min</mo><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">]-\infty, \min_i x_i]</annotation></semantics></math>,
similarly
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>↦</mo><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">b\mapsto L(a,b)</annotation></semantics></math>
is decreasing for any fixed
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>.
This leads to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>min</mo><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\min_i x_i</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>max</mo><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\max_i x_i</annotation></semantics></math>
to be the MLE of the uniform distribution.</p>
<p>We should notice that the likelihood function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>L</mi><annotation encoding="application/x-tex">L</annotation></semantics></math>
is defined on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>ℝ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\mathbb R^2</annotation></semantics></math>
yet it cancels outside
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mo stretchy="false" form="postfix">]</mo><mo>−</mo><mi>∞</mi><mo>,</mo><msub><mo>min</mo><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">]</mo><mo>×</mo><mo stretchy="false" form="postfix">]</mo><msub><mo>max</mo><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><mo>+</mo><mi>∞</mi><mo stretchy="false" form="prefix">[</mo></mrow><annotation encoding="application/x-tex">S=]-\infty, \min_i x_i]\times]\max_i x_i, +\infty[</annotation></semantics></math>.
Hence, the log-likelihood is undefined outside
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>S</mi><annotation encoding="application/x-tex">S</annotation></semantics></math>,
which is an issue when maximizing the log-likelihood.</p>
<p>For these reasons,
<code>fitdist(data, dist="unif", method="mle")</code> uses the explicit
form of the MLE for this distribution. Here is an example below</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trueval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"min"</span><span class="op">=</span><span class="fl">3</span>, <span class="st">"max"</span><span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">500</span>, <span class="va">trueval</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">trueval</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">f1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"unif"</span><span class="op">)</span></span>
<span><span class="va">delta</span> <span class="op">&lt;-</span> <span class="fl">.01</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/logLik-surface.html">llsurface</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"unif"</span>, plot.arg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"min"</span>, <span class="st">"max"</span><span class="op">)</span>, min.arg<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="va">delta</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">-</span><span class="va">delta</span><span class="op">)</span>,</span>
<span>          max.arg<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">+</span><span class="va">delta</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">+</span><span class="fl">2</span><span class="op">*</span><span class="va">delta</span><span class="op">)</span>, main<span class="op">=</span><span class="st">"likelihood surface for uniform"</span>,</span>
<span>        loglik<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, h<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"grey"</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">f1</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">f1</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, pch<span class="op">=</span><span class="st">"x"</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">trueval</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">trueval</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, pch<span class="op">=</span><span class="st">"+"</span>, col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>, pch<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"+"</span>,<span class="st">"x"</span><span class="op">)</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>,<span class="st">"red"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"true"</span>, <span class="st">"fitted"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-13-1.png" class="r-plt" width="672"></p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">delta</span> <span class="op">&lt;-</span> <span class="fl">.2</span></span>
<span><span class="fu"><a href="../reference/logLik-surface.html">llsurface</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"unif"</span>, plot.arg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"min"</span>, <span class="st">"max"</span><span class="op">)</span>, min.arg<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="va">delta</span>, <span class="fl">5</span><span class="op">-</span><span class="va">delta</span><span class="op">)</span>,</span>
<span>          max.arg<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">+</span><span class="va">delta</span>, <span class="fl">5</span><span class="op">+</span><span class="fl">2</span><span class="op">*</span><span class="va">delta</span><span class="op">)</span>, main<span class="op">=</span><span class="st">"log-likelihood surface for uniform"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, h<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"grey"</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">f1</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">f1</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, pch<span class="op">=</span><span class="st">"x"</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">trueval</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">trueval</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, pch<span class="op">=</span><span class="st">"+"</span>, col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>, pch<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"+"</span>,<span class="st">"x"</span><span class="op">)</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>,<span class="st">"red"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"true"</span>, <span class="st">"fitted"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-13-2.png" class="r-plt" width="672"></p>
<p>Maximizing the log-likelihood is harder and can be done by defining a
new density function. Appropriate starting values and parameters bound
must be supplied. Using the closed-form expression (as in
<code><a href="../reference/fitdist.html">fitdist()</a></code>) or maximizing the log-likelihood (with
<code>unif2</code>) lead to very similar results.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dunif2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">min</span>, <span class="va">max</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">dunif</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">min</span>, <span class="va">max</span><span class="op">)</span></span>
<span><span class="va">punif2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">q</span>, <span class="va">min</span>, <span class="va">max</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">punif</a></span><span class="op">(</span><span class="va">q</span>, <span class="va">min</span>, <span class="va">max</span><span class="op">)</span></span>
<span><span class="va">f2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"unif2"</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>min<span class="op">=</span><span class="fl">0</span>, max<span class="op">=</span><span class="fl">10</span><span class="op">)</span>, lower<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>,</span>
<span>              upper<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="cn">Inf</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">f1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">f2</span><span class="op">)</span><span class="op">)</span>, digits<span class="op">=</span><span class="fl">7</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -346.0539 -346.1519</span></span></code></pre>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">f1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">f2</span><span class="op">)</span><span class="op">)</span>, digits<span class="op">=</span><span class="fl">7</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##         [,1]     [,2]</span></span>
<span><span class="co">## min 3.000684 3.000292</span></span>
<span><span class="co">## max 4.998606 4.998606</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="can-i-fit-a-beta-distribution-with-the-same-shape-parameter">1.11. Can I fit a beta distribution with the same shape
parameter?<a class="anchor" aria-label="anchor" href="#can-i-fit-a-beta-distribution-with-the-same-shape-parameter"></a>
</h3>
<p>Yes, you can wrap the density function of the beta distribution so
that there is a only one shape parameter. Here is an example of a
concave density.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">dbeta2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">shape</span>, <span class="va">...</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">shape</span>, <span class="va">shape</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="va">pbeta2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">q</span>, <span class="va">shape</span>, <span class="va">...</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">pbeta</a></span><span class="op">(</span><span class="va">q</span>, <span class="va">shape</span>, <span class="va">shape</span>, <span class="va">...</span><span class="op">)</span> </span>
<span><span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"beta2"</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>shape<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Fitting of the distribution ' beta2 ' by maximum likelihood </span></span>
<span><span class="co">## Parameters:</span></span>
<span><span class="co">##       estimate Std. Error</span></span>
<span><span class="co">## shape     3.24      0.135</span></span></code></pre>
<p>Another example with a U-shaped density.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"beta2"</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>shape<span class="op">=</span><span class="fl">0.4</span><span class="op">)</span>, optim.method<span class="op">=</span><span class="st">"Nelder-Mead"</span>, lower<span class="op">=</span><span class="fl">1e-1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Fitting of the distribution ' beta2 ' by maximum likelihood </span></span>
<span><span class="co">## Parameters:</span></span>
<span><span class="co">##       estimate Std. Error</span></span>
<span><span class="co">## shape    0.479     0.0137</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="how-to-estimate-support-parameter-the-case-of-the-four-parameter-beta">1.12. How to estimate support parameter? the case of the
four-parameter beta<a class="anchor" aria-label="anchor" href="#how-to-estimate-support-parameter-the-case-of-the-four-parameter-beta"></a>
</h3>
<p>Let us consider the four-parameter beta distribution, also known as
the PERT distribution, defined by the following density for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>∈</mo><mrow><mo stretchy="true" form="prefix">[</mo><mi>a</mi><mo>,</mo><mi>c</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">x\in [a,c]</annotation></semantics></math><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>X</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>−</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>α</mi><mo>−</mo><mn>1</mn></mrow></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo>−</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>β</mi><mo>−</mo><mn>1</mn></mrow></msup><mi>/</mi><msub><mi>C</mi><mi>N</mi></msub></mrow><annotation encoding="application/x-tex">f_X(x) = (x-a)^{\alpha-1} (c-x)^{\beta-1}/C_N</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>N</mi></msub><annotation encoding="application/x-tex">C_N</annotation></semantics></math>
a normalizing constant and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>1</mn><mo>+</mo><mi>d</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo>−</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo>−</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\alpha=1+d(b-a)/(c-a)</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><mo>=</mo><mn>1</mn><mo>+</mo><mi>d</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo>−</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo>−</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\beta=1+d(c-b)/(c-a)</annotation></semantics></math>.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>,</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">a,c</annotation></semantics></math>
are support parameters,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>∈</mo><mo stretchy="false" form="postfix">]</mo><mi>a</mi><mo>,</mo><mi>c</mi><mo stretchy="false" form="prefix">[</mo></mrow><annotation encoding="application/x-tex">b\in]a,c[</annotation></semantics></math>
is the mode and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>d</mi><annotation encoding="application/x-tex">d</annotation></semantics></math>
the shape parameter.</p>
<p>As for uniform distribution, one can show that the MLE of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
are respectively the sample minimum and maximum. The code below
illustrates the strategy using partial closed formula with
<code>fix.arg</code> and the full numerical search of MLE. NB: on small
sample size, the latter has generally better goodness-of-fit statistics;
a small positive number is added or subtracted when fixing the support
parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
to sample minimum and maximum.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st">"mc2d"</span><span class="op">)</span></span>
<span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mc2d/man/pert.html" class="external-link">rpert</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">2e2</span>, min<span class="op">=</span><span class="fl">0</span>, mode<span class="op">=</span><span class="fl">1</span>, max<span class="op">=</span><span class="fl">2</span>, shape<span class="op">=</span><span class="fl">3</span><span class="op">/</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">eps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">)</span></span>
<span><span class="va">f1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">x2</span>, <span class="st">"pert"</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>min<span class="op">=</span><span class="op">-</span><span class="fl">1</span>, mode<span class="op">=</span><span class="fl">0</span>, max<span class="op">=</span><span class="fl">10</span>, shape<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>              lower<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="op">-</span><span class="cn">Inf</span>, <span class="op">-</span><span class="cn">Inf</span>, <span class="fl">0</span><span class="op">)</span>, upper<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">Inf</span>, <span class="cn">Inf</span>, <span class="cn">Inf</span>, <span class="cn">Inf</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in checkparamlist(arg_startfix$start.arg, arg_startfix$fix.arg, : Some</span></span>
<span><span class="co">## parameter names have no starting/fixed value but have a default value: mean.</span></span></code></pre>
<pre><code><span><span class="co">## Warning in cov2cor(varcovar): diag(V) had non-positive or NA entries; the</span></span>
<span><span class="co">## non-finite result may be dubious</span></span></code></pre>
<pre><code><span><span class="co">## Warning in sqrt(diag(varcovar)): NaNs produced</span></span></code></pre>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">x2</span>, <span class="st">"pert"</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mode<span class="op">=</span><span class="fl">1</span>, shape<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, </span>
<span>              fix.arg<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>min<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span><span class="op">-</span><span class="va">eps</span>, max<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span><span class="op">+</span><span class="va">eps</span><span class="op">)</span>,</span>
<span>              lower<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span>, upper<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span>, <span class="cn">Inf</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in checkparamlist(arg_startfix$start.arg, arg_startfix$fix.arg, : Some</span></span>
<span><span class="co">## parameter names have no starting/fixed value but have a default value: mean.</span></span></code></pre>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">f1</span><span class="op">)</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">f2</span><span class="op">$</span><span class="va">fix.arg</span><span class="op">[</span><span class="st">"min"</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">f2</span><span class="op">)</span><span class="op">[</span><span class="st">"mode"</span><span class="op">]</span>, <span class="va">f2</span><span class="op">$</span><span class="va">fix.arg</span><span class="op">[</span><span class="st">"max"</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">f2</span><span class="op">)</span><span class="op">[</span><span class="st">"shape"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, </span>
<span>      digits<span class="op">=</span><span class="fl">7</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       [,1]         [,2]       </span></span>
<span><span class="co">## min   -0.003074775 0.009485563</span></span>
<span><span class="co">## mode  1.241256     1.963062   </span></span>
<span><span class="co">## max   1.969343     1.963881   </span></span>
<span><span class="co">## shape 0.7444557    0.1276672</span></span></code></pre>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gofstat.html">gofstat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">f1</span>,<span class="va">f2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Goodness-of-fit statistics</span></span>
<span><span class="co">##                              1-mle-pert 2-mle-pert</span></span>
<span><span class="co">## Kolmogorov-Smirnov statistic     0.0618     0.0648</span></span>
<span><span class="co">## Cramer-von Mises statistic       0.1083     0.2174</span></span>
<span><span class="co">## Anderson-Darling statistic       0.5327     1.5895</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Goodness-of-fit criteria</span></span>
<span><span class="co">##                                1-mle-pert 2-mle-pert</span></span>
<span><span class="co">## Akaike's Information Criterion        265        269</span></span>
<span><span class="co">## Bayesian Information Criterion        278        276</span></span></code></pre>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/graphcomp.html">cdfcomp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">f1</span>,<span class="va">f2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-17-1.png" class="r-plt" width="576"></p>
</div>
</div>
<div class="section level2">
<h2 id="questions-regarding-goodness-of-fit-tests-and-statistics-cullen-frey-graph">2. Questions regarding goodness-of-fit tests and statistics,
Cullen-Frey graph<a class="anchor" aria-label="anchor" href="#questions-regarding-goodness-of-fit-tests-and-statistics-cullen-frey-graph"></a>
</h2>
<div class="section level3">
<h3 id="where-can-we-find-the-results-of-goodness-of-fit-tests">2.1. Where can we find the results of goodness-of-fit tests ?<a class="anchor" aria-label="anchor" href="#where-can-we-find-the-results-of-goodness-of-fit-tests"></a>
</h3>
<p>Results of goodness-of-fit tests are not printed but are given in the
object returned by <code><a href="../reference/gofstat.html">gofstat()</a></code> and you can have access to
them as described in the example below. Nevertheless, p-values are not
given for every test. For Anderson-Darling (ad), Cramer von Mises (cvm)
and Kolomogorov (ks), only the decision (rejection of H0 or not) is
given, when available (see FAQ 2.3 for more details).</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, shape <span class="op">=</span> <span class="fl">2</span>, scale <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co"># fit of the good distribution</span></span>
<span><span class="va">fgamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"gamma"</span><span class="op">)</span></span>
<span><span class="co"># fit of a bad distribution</span></span>
<span><span class="va">fexp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"exp"</span><span class="op">)</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gofstat.html">gofstat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">fgamma</span>, <span class="va">fexp</span><span class="op">)</span>, fitnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gamma"</span>, <span class="st">"exp"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/graphcomp.html">denscomp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">fgamma</span>, <span class="va">fexp</span><span class="op">)</span>, legendtext <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gamma"</span>, <span class="st">"exp"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-18-1.png" class="r-plt" width="576"></p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># results of the tests</span></span>
<span><span class="co">## chi square test (with corresponding table with theoretical and observed counts)</span></span>
<span><span class="va">g</span><span class="op">$</span><span class="va">chisqpvalue</span></span></code></pre></div>
<pre><code><span><span class="co">##    gamma      exp </span></span>
<span><span class="co">## 1.89e-01 7.73e-05</span></span></code></pre>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g</span><span class="op">$</span><span class="va">chisqtable</span></span></code></pre></div>
<pre><code><span><span class="co">##           obscounts theo gamma theo exp</span></span>
<span><span class="co">## &lt;= 0.5483         9      10.06    23.66</span></span>
<span><span class="co">## &lt;= 0.8122         9       8.82     9.30</span></span>
<span><span class="co">## &lt;= 0.9592         9       5.27     4.68</span></span>
<span><span class="co">## &lt;= 1.368          9      14.64    11.37</span></span>
<span><span class="co">## &lt;= 1.523          9       5.24     3.74</span></span>
<span><span class="co">## &lt;= 1.701          9       5.73     3.97</span></span>
<span><span class="co">## &lt;= 1.94           9       7.09     4.82</span></span>
<span><span class="co">## &lt;= 2.381          9      11.08     7.50</span></span>
<span><span class="co">## &lt;= 2.842          9       9.00     6.29</span></span>
<span><span class="co">## &lt;= 3.801          9      11.93     9.28</span></span>
<span><span class="co">## &gt; 3.801          10      11.15    15.40</span></span></code></pre>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Anderson-Darling test</span></span>
<span><span class="va">g</span><span class="op">$</span><span class="va">adtest</span></span></code></pre></div>
<pre><code><span><span class="co">##          gamma            exp </span></span>
<span><span class="co">## "not rejected"     "rejected"</span></span></code></pre>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Cramer von  Mises test</span></span>
<span><span class="va">g</span><span class="op">$</span><span class="va">cvmtest</span></span></code></pre></div>
<pre><code><span><span class="co">##          gamma            exp </span></span>
<span><span class="co">## "not rejected"     "rejected"</span></span></code></pre>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Kolmogorov-Smirnov test</span></span>
<span><span class="va">g</span><span class="op">$</span><span class="va">kstest</span></span></code></pre></div>
<pre><code><span><span class="co">##          gamma            exp </span></span>
<span><span class="co">## "not rejected"     "rejected"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="is-it-reasonable-to-use-goodness-of-fit-tests-to-validate-the-fit-of-a-distribution">2.2. Is it reasonable to use goodness-of-fit tests to validate the
fit of a distribution ?<a class="anchor" aria-label="anchor" href="#is-it-reasonable-to-use-goodness-of-fit-tests-to-validate-the-fit-of-a-distribution"></a>
</h3>
<p>In the first versions of fitdistrplus, when they were available, the
results of the GOF tests (AD, KS, CvM) were automatically printed. We
decided to suppress this automatic printing when we realized that some
users had some difficulties to interpret the results of those tests and
sometimes misused them.</p>
<p>Goodness-of-fit tests often appear as objective tools to decide
wether a fitted distribution well describes a data set. <strong>But they
are not !</strong> It would not be reasonable at all to reject a
distribution just because a goodness-of-fit test rejects it (see FAQ
2.2.1). And it would not be reasonable at all any more to validate a
distribution because goodness-of-fit tests do not reject it (see FAQ
2.2.2).</p>
<p>A fitted distribution should be evaluated using graphical methods
(goodness-of-fit graphs automatically provided in our package by
plotting the result of the fit (output of <code><a href="../reference/fitdist.html">fitdist()</a></code> or
<code><a href="../reference/fitdistcens.html">fitdistcens()</a></code> and the complementary graphs that help to
compare different fits - see <code><a href="../reference/graphcomp.html">?graphcomp</a></code>). We really think
it is the most appropriate way to evaluate the adequacy of a fit and we
are not the only ones to recommend it. You can find the same type of
recommendations in reference books :</p>
<ul>
<li>
<strong>Probabilistic techniques in exposure assessment - a handbook
dealing with variability and uncertainty in models and inputs</strong>
by A.C. Cullen and H.C. Frey.<br>
</li>
<li>
<strong>Application of uncertainty analysis to ecological risks of
pesticides</strong> by W.J. Warren-Hicks and A. Hart.<br>
</li>
<li>
<strong>Statistical inference</strong> by G. Casella and R.L.
Berger</li>
<li>
<strong>Loss models: from data to decision</strong> by S.A. Klugman
and H.H. Panjer and G.E. Willmot</li>
</ul>
<p>Moreover, the selection of a distribution should also be driven by
knowledge of underlying processes when available. For example when a
variable cannot be negative, one would be very cautious while fitting a
normal distribution, that potentially gives negative values, even if the
observed data of this variable seem well fitted by a normal
distribution.</p>
<div class="section level4">
<h4 id="should-i-reject-a-distribution-because-a-goodness-of-fit-test-rejects-it">2.2.1. Should I reject a distribution because a goodness-of-fit test
rejects it ?<a class="anchor" aria-label="anchor" href="#should-i-reject-a-distribution-because-a-goodness-of-fit-test-rejects-it"></a>
</h4>
<p>No it would not be reasonable at all to reject a distribution just
because a goodness-of-fit test rejects it, especially in the case of big
samples. In the real life, as soon as you have a sufficient amount of
data, you will reject the fitted distribution. We know that a model
cannot perfectly describe real data, and generally the true question is
to find the better distribution among a pool of simple parametric
distributions to describe the data, so to compare different models (see
FAQ 2.4 and 2.5 for corresponding questions).</p>
<p>To illustre this point let us comment the example presented below. We
drew two samples from the same Poisson distribution with a mean
parameter equal to 100. In many applications, for this value of its
parameter, the Poisson distribution would be considered to be well
approximated by a normal distribution. Testing the fit (here using a
Kolmogorov-Smirnov test ) of the normal distribution on a sample of 100
observations would not reject the normal fit, while testing it on a
sample of 10000 observations would reject it, while both samples come
from the same distribution.</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, lambda <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">f1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">x1</span>, <span class="st">"norm"</span><span class="op">)</span></span>
<span><span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gofstat.html">gofstat</a></span><span class="op">(</span><span class="va">f1</span><span class="op">)</span></span>
<span><span class="va">g1</span><span class="op">$</span><span class="va">kstest</span></span></code></pre></div>
<pre><code><span><span class="co">##     1-mle-norm </span></span>
<span><span class="co">## "not rejected"</span></span></code></pre>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10000</span>, lambda <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">f2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">x2</span>, <span class="st">"norm"</span><span class="op">)</span></span>
<span><span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gofstat.html">gofstat</a></span><span class="op">(</span><span class="va">f2</span><span class="op">)</span></span>
<span><span class="va">g2</span><span class="op">$</span><span class="va">kstest</span></span></code></pre></div>
<pre><code><span><span class="co">## 1-mle-norm </span></span>
<span><span class="co">## "rejected"</span></span></code></pre>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/graphcomp.html">denscomp</a></span><span class="op">(</span><span class="va">f1</span>, demp <span class="op">=</span> <span class="cn">TRUE</span>, addlegend <span class="op">=</span> <span class="cn">FALSE</span>, main <span class="op">=</span> <span class="st">"small sample"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/graphcomp.html">denscomp</a></span><span class="op">(</span><span class="va">f2</span>, demp <span class="op">=</span> <span class="cn">TRUE</span>, addlegend <span class="op">=</span> <span class="cn">FALSE</span>, main <span class="op">=</span> <span class="st">"big sample"</span><span class="op">)</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-19-1.png" class="r-plt" width="672"></p>
</div>
<div class="section level4">
<h4 id="should-i-accept-a-distribution-because-goodness-of-fit-tests-do-not-reject-it">2.2.2. Should I accept a distribution because goodness-of-fit tests
do not reject it ?<a class="anchor" aria-label="anchor" href="#should-i-accept-a-distribution-because-goodness-of-fit-tests-do-not-reject-it"></a>
</h4>
<p>No, it would not be reasonable at all to validate a distribution
because goodness-of-fit tests do not reject it. Like all the other
hypothesis tests, goodness-of-fit tests lack of statistical power when
the sample size is not so high. And the different goodness-of-fit tests
are not equally sensitive to different types of deviation between
empirical and fitted distributions. For example the Kolmogorov-Smirnov
test is sensitive when distributions differ in a global fashion near the
centre of the distribution. The Anderson-Darling test will be more
sensitive when distributions differ in their tails, and the Cramer von
Mises will be more sensitive when there are small but repetitive
differences between empirical and theoretical distribution
functions.</p>
<p>The sensitivity of a chi square test will depend on the definition of
classes, and even if we propose a default definition of classes when the
user does not provide classes, this choice is not obvious and could
impact the results of the test. This test is more appropriate when data
are discrete, even if they are modelled by a continuous distribution, as
in the following example. Two samples of respective sizes 500 and 50 are
drawn from a Poisson distribution of mean parameter equal to 1 (not a
sufficiently high value to consider that the Poisson distribution could
be approximated by a normal one). Using a Kolmogorov-Smirnov test, for
the small sample the normal fit is rejected only for the bigger sample.
It is not rejected with the smaller sample even if the fit could be
rejected after a simple visual confrontation of the distributions. In
that particular case, the chi square test with classes defined by
default would have rejected te normal fit for both samples.</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">x3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">500</span>, lambda <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">f3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">x3</span>, <span class="st">"norm"</span><span class="op">)</span></span>
<span><span class="va">g3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gofstat.html">gofstat</a></span><span class="op">(</span><span class="va">f3</span><span class="op">)</span></span>
<span><span class="va">g3</span><span class="op">$</span><span class="va">kstest</span></span></code></pre></div>
<pre><code><span><span class="co">## 1-mle-norm </span></span>
<span><span class="co">## "rejected"</span></span></code></pre>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">50</span>, lambda <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">f4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">x4</span>, <span class="st">"norm"</span><span class="op">)</span></span>
<span><span class="va">g4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gofstat.html">gofstat</a></span><span class="op">(</span><span class="va">f4</span><span class="op">)</span></span>
<span><span class="va">g4</span><span class="op">$</span><span class="va">kstest</span></span></code></pre></div>
<pre><code><span><span class="co">##     1-mle-norm </span></span>
<span><span class="co">## "not rejected"</span></span></code></pre>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/graphcomp.html">denscomp</a></span><span class="op">(</span><span class="va">f3</span>, addlegend <span class="op">=</span> <span class="cn">FALSE</span>, main <span class="op">=</span> <span class="st">"big sample"</span><span class="op">)</span> </span>
<span><span class="fu"><a href="../reference/graphcomp.html">denscomp</a></span><span class="op">(</span><span class="va">f4</span>, addlegend <span class="op">=</span> <span class="cn">FALSE</span>, main <span class="op">=</span> <span class="st">"small sample"</span><span class="op">)</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-20-1.png" class="r-plt" width="672"></p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g3</span><span class="op">$</span><span class="va">chisqtable</span></span></code></pre></div>
<pre><code><span><span class="co">##      obscounts theocounts</span></span>
<span><span class="co">## &lt;= 0     180.0       80.3</span></span>
<span><span class="co">## &lt;= 1     187.0      163.5</span></span>
<span><span class="co">## &lt;= 2      87.0      168.1</span></span>
<span><span class="co">## &lt;= 3      32.0       73.4</span></span>
<span><span class="co">## &gt; 3       14.0       14.7</span></span></code></pre>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g3</span><span class="op">$</span><span class="va">chisqpvalue</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 7.11e-42</span></span></code></pre>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g4</span><span class="op">$</span><span class="va">chisqtable</span></span></code></pre></div>
<pre><code><span><span class="co">##      obscounts theocounts</span></span>
<span><span class="co">## &lt;= 0     14.00       5.46</span></span>
<span><span class="co">## &lt;= 1     15.00      14.23</span></span>
<span><span class="co">## &lt;= 2     15.00      18.09</span></span>
<span><span class="co">## &gt; 2       6.00      12.22</span></span></code></pre>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g4</span><span class="op">$</span><span class="va">chisqpvalue</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 3.57e-05</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="why-all-goodness-of-fit-tests-are-not-available-for-every-distribution">2.3. Why all goodness-of-fit tests are not available for every
distribution ?<a class="anchor" aria-label="anchor" href="#why-all-goodness-of-fit-tests-are-not-available-for-every-distribution"></a>
</h3>
<p>The Chi-squared test is available for any distribution but one must
be conscious that its result depends on the definition of cells in which
observed data are grouped, and a correct definition is not possible with
a too small sample.</p>
<p>Concerning the Kolmogorov-Smirnov test, it is proposed for any
continuous distribution, but with a critical value corresponding to the
comparison of the empirical distribution to a fully specified
distribution. As the distribution is not fully known for a fitted
distribution, the result of this test is subject to caution, but there
is no general asymptotic theory for the Kolmogorov-Smirnov statistics in
case of a fitted distribution. Nevertheless, one can use Monte Carlo
methods to conduct Kolmgorov-Smirnov goodness-of-fit tests in cases when
the sample is used to estimate model parameters. Such a method is
implemented in the R package <code>KScorrect</code> for a variety of
continuous distributions.</p>
<p>Such an asymptotic theory was proposed for quadratic statistics for
some distributions (Anderson-Darling, Cramer von Mises). The reference
book we used on this subject (<strong>Tests based on edf
statistics</strong> by Stephens MA in <strong>Goodness-of-fit
techniques</strong> by D’Agostino RB and Stephens MA) proposes critical
values of those statistics for a some classical distributions
(exponential, gamma, Weibull, logistic, Cauchy, normal and lognormal).
But the asymptotic theory about these statistics also depends on the way
the parameters are estimated. And as they were not estimated by maximum
likelihood for Cauchy, normal and lognormal distributions in the results
reported by Stephens, we only propose the results of the
Anderson-Darling and Cramer von Mises using those results for
exponential, gamma, Weibull, logistic distributions.</p>
<p>The user can refer to the cited books and use the proposed formula to
estimate the parameters of Cauchy, normal and lognormal distributions
and apply the tests using critical values given in the book. R packages
<code>goftest</code> and <code>ADGofTest</code> could also be explored
by users who would like to apply Anderson-Darling and Cramer von Mises
tests on other distributions. But at this time we are not sure that the
case where parameters are unknown (estimated by maximum likelihood) is
tackled in those two packages.</p>
<p>Concerning the development of our package, rather than develoing
further more goodness-of-fit tests we made the choice to develop
graphical tools to help to appreciate the quality of a fit and to
compare the fits of different distributions on a same data set (see FAQ
2.2 for argumentation).</p>
</div>
<div class="section level3">
<h3 id="how-can-we-use-goodness-of-fit-statistics-to-compare-the-fit-of-different-distributions-on-a-same-data-set">2.4. How can we use goodness-of-fit statistics to compare the fit of
different distributions on a same data set ?<a class="anchor" aria-label="anchor" href="#how-can-we-use-goodness-of-fit-statistics-to-compare-the-fit-of-different-distributions-on-a-same-data-set"></a>
</h3>
<p>Goodness-of-fit statistics based on the empirical distribution
function (Kolmogorov-Smirnov, Anderson-Darling and Cramer von Mises) may
be used to measure a distance between the fitted distribution and the
empirical distribution. So if one wants to compare the fit of various
distributions on the same data set, the smaller are those statistics the
better. The Kolmogorov-Smirnov statistics will be sensitive when
distributions differ in a global fashion near the centre of the
distribution while the Anderson-Darling statistics will be more
sensitive when distributions differ in their tails, and the Cramer von
Mises statistics will be more sensitive when there are small but
repetitive differences between empirical and theoretical distribution
functions.</p>
<p>But as mentioned in the main vignette of our package, the use of the
Anderson-Darling to compare the fit of different distributions is
subject to caution due to the the weighting of the quadratic distance
between fitted and empirical distribution functions that depends on the
parametric distribution. Moreover, statistics based on the empirical
distribution function do not penalize distributions with a greater
number of parameters and as those are generally more flexible, this
could induce over-fitting.</p>
<p>Goodness-fo-fit statistics based on information criteria (AIC, BIC)
correspond to deviance penalized by the complexity of the model (the
number of parameters of the distribution), and so the smaller the
better. As more generic statistics, they are not adapted to focus on a
part of the fitted distribution, but they take into account the
complexity of the distribution and thus could help to prevent
overfitting.</p>
</div>
<div class="section level3">
<h3 id="can-we-use-a-test-to-compare-the-fit-of-two-distributions-on-a-same-data-set">2.5. Can we use a test to compare the fit of two distributions on a
same data set ?<a class="anchor" aria-label="anchor" href="#can-we-use-a-test-to-compare-the-fit-of-two-distributions-on-a-same-data-set"></a>
</h3>
<p>In our package we did not implement such a test but for <strong>two
nested distributions</strong> (when one is a special case of the other
one, e.g. exponential and gamma distributions) a likelihood ratio test
can be easily implemented using the loglikelihood provided by
<code>fitdist</code> or <code>fitdistcens</code>. Denoting
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>L</mi><annotation encoding="application/x-tex">L</annotation></semantics></math>
the maximum likelihood obtained with the complete distribution and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>L</mi><mn>0</mn></msub><annotation encoding="application/x-tex">L_0</annotation></semantics></math>
the one obtained with the simplified distribution, when the sample size
increases,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>2</mn><mi>l</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>L</mi><mn>0</mn></msub><mi>L</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>2</mn><mi>l</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>L</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mn>2</mn><mi>l</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>L</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">- 2 ln(\frac{L_0}{L}) = 2 ln(L) - 2 ln(L_0)</annotation></semantics></math>
tends to a Chi squared distribution degrees of freedom equal to the
difference on the numbers of parameters characterizing the <strong>two
nested distributions</strong>. You will find below an example of such a
test.</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="fl">100</span>, shape <span class="op">=</span> <span class="fl">2</span>, rate <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">g</span>, <span class="st">"gamma"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Fitting of the distribution ' gamma ' by maximum likelihood </span></span>
<span><span class="co">## Parameters:</span></span>
<span><span class="co">##       estimate Std. Error</span></span>
<span><span class="co">## shape    2.025      0.266</span></span>
<span><span class="co">## rate     0.997      0.149</span></span></code></pre>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">f0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">g</span>, <span class="st">"exp"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Fitting of the distribution ' exp ' by maximum likelihood </span></span>
<span><span class="co">## Parameters:</span></span>
<span><span class="co">##      estimate Std. Error</span></span>
<span><span class="co">## rate    0.492     0.0492</span></span></code></pre>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">L</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span>
<span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">f</span><span class="op">$</span><span class="va">estimate</span><span class="op">)</span> <span class="co"># number of parameters of the complete distribution</span></span>
<span><span class="va">L0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">f0</span><span class="op">)</span></span>
<span><span class="va">k0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">f0</span><span class="op">$</span><span class="va">estimate</span><span class="op">)</span> <span class="co"># number of parameters of the simplified distribution</span></span>
<span><span class="op">(</span><span class="va">stat</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="va">L</span> <span class="op">-</span> <span class="fl">2</span><span class="op">*</span><span class="va">L0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 23.9</span></span></code></pre>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">critical_value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">qchisq</a></span><span class="op">(</span><span class="fl">0.95</span>, df <span class="op">=</span> <span class="va">k</span> <span class="op">-</span> <span class="va">k0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 3.84</span></span></code></pre>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">rejected</span> <span class="op">&lt;-</span> <span class="va">stat</span> <span class="op">&gt;</span> <span class="va">critical_value</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>Such a test can also be used for fits on censored data.</p>
</div>
<div class="section level3">
<h3 id="can-we-get-goodness-of-fit-statistics-for-a-fit-on-censored-data">2.6. Can we get goodness-of-fit statistics for a fit on censored
data ?<a class="anchor" aria-label="anchor" href="#can-we-get-goodness-of-fit-statistics-for-a-fit-on-censored-data"></a>
</h3>
<p>Function <code>gofstat</code> is not yet proposed in our package for
fits on censored data but to develop one is among one of our objectives
in the future. Published works on goodness-of-fit statistics based on
the empirical distribution function for censored data generally focused
on data containing only one type of censoring (e.g. right censored data
in survival data). Build such statistics in the general case, with data
containing in the same time (right, left and interval censoring),
remains tricky.</p>
<p>Nevertheless, it is possible for any type of censored data, to use
information criteria (AIC and BIC given in the summary of an object of
class <code>fitdistcens</code>) to compare the fits of various
distributions to a same data set.</p>
</div>
<div class="section level3">
<h3 id="why-cullen-frey-graph-may-be-misleading">2.7. Why Cullen-Frey graph may be misleading?<a class="anchor" aria-label="anchor" href="#why-cullen-frey-graph-may-be-misleading"></a>
</h3>
<p>When considering distribution with large theoretical moments or
infinite moments, using the Cullen-Frey may not be appropriate. A
typical is the log-normal distribution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ℒ</mi><mi>𝒩</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo>,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal L\mathcal N(\mu,\sigma^2)</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1e3</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/descdist.html">descdist</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-24-1.png" class="r-plt" width="480"></p>
<pre><code><span><span class="co">## summary statistics</span></span>
<span><span class="co">## ------</span></span>
<span><span class="co">## min:  0.0436   max:  20.3 </span></span>
<span><span class="co">## median:  1.02 </span></span>
<span><span class="co">## mean:  1.61 </span></span>
<span><span class="co">## estimated sd:  1.89 </span></span>
<span><span class="co">## estimated skewness:  3.49 </span></span>
<span><span class="co">## estimated kurtosis:  21.9</span></span></code></pre>
<p>Indeed for that distribution, the skewness and the kurtosis are
functions of the exponential of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>σ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\sigma^2</annotation></semantics></math>.
With large values, even for small
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>.
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>k</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>e</mi><msup><mi>σ</mi><mn>2</mn></msup></msup><mo>+</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><msqrt><mrow><msup><mi>e</mi><msup><mi>σ</mi><mn>2</mn></msup></msup><mo>−</mo><mn>1</mn></mrow></msqrt><mo>,</mo><mi>k</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mi>e</mi><mrow><mn>4</mn><msup><mi>σ</mi><mn>2</mn></msup></mrow></msup><mo>+</mo><mn>2</mn><msup><mi>e</mi><mrow><mn>3</mn><msup><mi>σ</mi><mn>2</mn></msup></mrow></msup><mo>+</mo><mn>3</mn><msup><mi>e</mi><mrow><mn>2</mn><msup><mi>σ</mi><mn>2</mn></msup></mrow></msup><mo>−</mo><mn>3</mn><mi>.</mi></mrow><annotation encoding="application/x-tex">
sk(X) = (e^{\sigma^2}+2)\sqrt{e^{\sigma^2}-1},
kr(X) = e^{4\sigma^2} + 2e^{3\sigma^2} + 3e^{2\sigma^2}-3.
</annotation></semantics></math></p>
<p>The convergence to theoretical standardized moments (skewness and
kurtosis) is slow
<img src="FAQ_files/figure-html/unnamed-chunk-26-1.png" class="r-plt" width="672"></p>
<p>In the future, we plan to use trimmed linear moments to deal with
this issue. Those moments always exist even for distribution with
infinite mean, e.g. the Cauchy distribution.</p>
</div>
</div>
<div class="section level2">
<h2 id="questions-regarding-optimization-procedures">3. Questions regarding optimization procedures<a class="anchor" aria-label="anchor" href="#questions-regarding-optimization-procedures"></a>
</h2>
<div class="section level3">
<h3 id="how-to-choose-optimization-method">3.1. How to choose optimization method?<a class="anchor" aria-label="anchor" href="#how-to-choose-optimization-method"></a>
</h3>
<p>If you want to perform optimization without bounds,
<code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim()</a></code> is used. You can try the derivative-free method
Nelder-Mead and the Hessian-free method BFGS. If you want to perform
optimization with bounds, only two methods are available without
providing the gradient of the objective function: Nelder-Mead via
<code><a href="https://rdrr.io/r/stats/constrOptim.html" class="external-link">constrOptim()</a></code> and bounded BFGS via <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim()</a></code>. In
both cases, see the help of <code><a href="../reference/mledist.html">mledist()</a></code> and the vignette on
optimization algorithms.</p>
</div>
<div class="section level3">
<h3 id="the-optimization-algorithm-stops-with-error-code-e-g--100--what-shall-i-do">3.2. The optimization algorithm stops with error code, e.g., 100.
What shall I do?<a class="anchor" aria-label="anchor" href="#the-optimization-algorithm-stops-with-error-code-e-g--100--what-shall-i-do"></a>
</h3>
<p>First, add traces by adding
<code>control=list(trace=1, REPORT=1)</code>. Second, try to set bounds
for parameters, typically shape and rate parameters are generally
positive. Third, try better starting values (see FAQ 1.3) or change the
optimization method.</p>
<p>A short example is given below of a fit of a Burr distribution. By
default, the Nelder-Mead algorithm is used which reaches the iteration
limit and raises error code 1.</p>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"danishuni"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">danishuni</span><span class="op">$</span><span class="va">Loss</span>, <span class="st">"burr"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in fitdist(danishuni$Loss, "burr") : </span></span>
<span><span class="co">##   the function mle failed to estimate the parameters, </span></span>
<span><span class="co">##                 with the error code 1</span></span></code></pre>
<p>If we increase the maximum number of iteration, it does not help and
we get a non-finite finite-difference value, yet Nelder-Mead may handle
infinite values.</p>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">danishuni</span><span class="op">$</span><span class="va">Loss</span>, <span class="st">"burr"</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>maxit<span class="op">=</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## &lt;simpleError in optim(par = vstart, fn = fnobj, fix.arg = fix.arg, obs = data,     gr = gradient, ddistnam = ddistname, hessian = TRUE, method = meth,     lower = lower, upper = upper, ...): non-finite finite-difference value [1]&gt;</span></span>
<span><span class="co">## Error in fitdist(danishuni$Loss, "burr", control = list(maxit = 1000)) : </span></span>
<span><span class="co">##   the function mle failed to estimate the parameters, </span></span>
<span><span class="co">##                 with the error code 100</span></span></code></pre>
<p>If we set bounds, it only helps with an upper bound on parameters
values. But the upper bound should be relatively small.</p>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">danishuni</span><span class="op">$</span><span class="va">Loss</span>, <span class="st">"burr"</span>, lower<span class="op">=</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in fitdist(danishuni$Loss, "burr", lower = 0) : </span></span>
<span><span class="co">##   the function mle failed to estimate the parameters, </span></span>
<span><span class="co">##                 with the error code 7</span></span></code></pre>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="va">fitBurr_cvg1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">danishuni</span><span class="op">$</span><span class="va">Loss</span>, <span class="st">"burr"</span>, upper<span class="op">=</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">danishuni</span><span class="op">$</span><span class="va">Loss</span>, <span class="st">"burr"</span>, upper<span class="op">=</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in fitdist(danishuni$Loss, "burr", upper = 1000) : </span></span>
<span><span class="co">##   the function mle failed to estimate the parameters, </span></span>
<span><span class="co">##                 with the error code 7</span></span></code></pre>
<p>Using another algorithm, such as the BFGS algorithm, helps the
convergence as long as we set a lower bound.</p>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="va">fitBurr_cvg2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">danishuni</span><span class="op">$</span><span class="va">Loss</span>, <span class="st">"burr"</span>, lower<span class="op">=</span><span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span>,</span>
<span>                            optim.method<span class="op">=</span><span class="st">"L-BFGS-B"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The fitted values have the same magnitude and the fits are
appropriate.</p>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/graphcomp.html">cdfcomp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">fitBurr_cvg1</span>, <span class="va">fitBurr_cvg2</span><span class="op">)</span>, xlogscale <span class="op">=</span> <span class="cn">TRUE</span>, fitlwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-31-1.png" class="r-plt" width="672"></p>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">fitBurr_cvg1</span>, <span class="va">fitBurr_cvg2</span><span class="op">)</span>, <span class="va">coef</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          [,1]     [,2]</span></span>
<span><span class="co">## shape1  0.014 9.86e-03</span></span>
<span><span class="co">## shape2 91.561 1.29e+02</span></span>
<span><span class="co">## scale   1.008 1.00e+00</span></span></code></pre>
<p>The <code><a href="../reference/logLik-plot.html">llplot()</a></code> function helps in understanding how good is
the fit.
<img src="FAQ_files/figure-html/unnamed-chunk-32-1.png" class="r-plt" width="576"><img src="FAQ_files/figure-html/unnamed-chunk-32-2.png" class="r-plt" width="576"></p>
<p>The log-likelihood surface is rather flat around the fitted values in
shape1/shape2 spaces. We observe a certain dependency so that the
product of shape parameters is almost constant.</p>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/prod.html" class="external-link">prod</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fitBurr_cvg1</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, digits<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1.2834</span></span></code></pre>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/prod.html" class="external-link">prod</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fitBurr_cvg2</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, digits<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1.2727</span></span></code></pre>
<p>In terms of computation time, we retrieve that the Nelder-Mead
algorithm is slower.</p>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">danishuni</span><span class="op">$</span><span class="va">Loss</span>, <span class="st">"burr"</span>, upper<span class="op">=</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    user  system elapsed </span></span>
<span><span class="co">##   0.252   0.000   0.251</span></span></code></pre>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">danishuni</span><span class="op">$</span><span class="va">Loss</span>, <span class="st">"burr"</span>, lower<span class="op">=</span><span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span>, optim.method<span class="op">=</span><span class="st">"L-BFGS-B"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    user  system elapsed </span></span>
<span><span class="co">##   0.116   0.000   0.117</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="why-distribution-with-a-log-argument-may-converge-better">3.3 Why distribution with a <code>log</code> argument may converge
better?<a class="anchor" aria-label="anchor" href="#why-distribution-with-a-log-argument-may-converge-better"></a>
</h3>
<p>Say, we study the shifted lognormal distribution defined by the
following density
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mi>x</mi><mi>σ</mi><msqrt><mrow><mn>2</mn><mi>π</mi></mrow></msqrt></mrow></mfrac><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><mo>ln</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>+</mo><mi>δ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>μ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mrow><mn>2</mn><msup><mi>σ</mi><mn>2</mn></msup></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
f(x) = \frac{1}{x \sigma \sqrt{2 \pi}} \exp\left(- \frac{(\ln (x+\delta)- \mu)^2}{2\sigma^2}\right) 
</annotation></semantics></math> for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>&gt;</mo><mo>−</mo><mi>δ</mi></mrow><annotation encoding="application/x-tex">x&gt;-\delta</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>
is a location parameter,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>
a scale parameter and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>δ</mi><annotation encoding="application/x-tex">\delta</annotation></semantics></math>
a boundary parameter. Let us fit this distribution on the dataset
<code>y</code> by MLE. We define two functions for the densities with
and without a <code>log</code> argument.</p>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dshiftlnorm</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">mean</span>, <span class="va">sigma</span>, <span class="va">shift</span>, <span class="va">log</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">dlnorm</a></span><span class="op">(</span><span class="va">x</span><span class="op">+</span><span class="va">shift</span>, <span class="va">mean</span>, <span class="va">sigma</span>, log<span class="op">=</span><span class="va">log</span><span class="op">)</span></span>
<span><span class="va">pshiftlnorm</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">q</span>, <span class="va">mean</span>, <span class="va">sigma</span>, <span class="va">shift</span>, <span class="va">log.p</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">plnorm</a></span><span class="op">(</span><span class="va">q</span><span class="op">+</span><span class="va">shift</span>, <span class="va">mean</span>, <span class="va">sigma</span>, log.p<span class="op">=</span><span class="va">log.p</span><span class="op">)</span></span>
<span><span class="va">qshiftlnorm</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">p</span>, <span class="va">mean</span>, <span class="va">sigma</span>, <span class="va">shift</span>, <span class="va">log.p</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">qlnorm</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">mean</span>, <span class="va">sigma</span>, log.p<span class="op">=</span><span class="va">log.p</span><span class="op">)</span><span class="op">-</span><span class="va">shift</span></span>
<span><span class="va">dshiftlnorm_no</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">mean</span>, <span class="va">sigma</span>, <span class="va">shift</span><span class="op">)</span> </span>
<span>  <span class="fu">dshiftlnorm</span><span class="op">(</span><span class="va">x</span>, <span class="va">mean</span>, <span class="va">sigma</span>, <span class="va">shift</span><span class="op">)</span></span>
<span><span class="va">pshiftlnorm_no</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">q</span>, <span class="va">mean</span>, <span class="va">sigma</span>, <span class="va">shift</span><span class="op">)</span> </span>
<span>  <span class="fu">pshiftlnorm</span><span class="op">(</span><span class="va">q</span>, <span class="va">mean</span>, <span class="va">sigma</span>, <span class="va">shift</span><span class="op">)</span></span></code></pre></div>
<p>We now optimize the minus log-likelihood.</p>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dataFAQlog1</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">dataFAQlog1</span></span>
<span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="va">f0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">y</span><span class="op">+</span><span class="va">D</span>, <span class="st">"lnorm"</span><span class="op">)</span></span>
<span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">f0</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="st">"meanlog"</span><span class="op">]</span><span class="op">)</span>,  </span>
<span>              sigma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">f0</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="st">"sdlog"</span><span class="op">]</span><span class="op">)</span>, shift<span class="op">=</span><span class="va">D</span><span class="op">)</span></span>
<span><span class="co"># works with BFGS, but not Nelder-Mead</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">y</span>, <span class="st">"shiftlnorm"</span>, start<span class="op">=</span><span class="va">start</span>, optim.method<span class="op">=</span><span class="st">"BFGS"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Fitting of the distribution ' shiftlnorm ' by maximum likelihood </span></span>
<span><span class="co">## Parameters : </span></span>
<span><span class="co">##       estimate Std. Error</span></span>
<span><span class="co">## mean   -1.3848    0.02409</span></span>
<span><span class="co">## sigma   0.0709    0.00192</span></span>
<span><span class="co">## shift   0.2487    0.00601</span></span>
<span><span class="co">## Loglikelihood:  8299   AIC:  -16591   BIC:  -16573 </span></span>
<span><span class="co">## Correlation matrix:</span></span>
<span><span class="co">##         mean  sigma  shift</span></span>
<span><span class="co">## mean   1.000 -0.885  0.999</span></span>
<span><span class="co">## sigma -0.885  1.000 -0.887</span></span>
<span><span class="co">## shift  0.999 -0.887  1.000</span></span></code></pre>
<p>If we don’t use the <code>log</code> argument, the algorithms
stalls.</p>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f2</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">y</span>, <span class="st">"shiftlnorm_no"</span>, start<span class="op">=</span><span class="va">start</span>, optim.method<span class="op">=</span><span class="st">"BFGS"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">f2</span>, <span class="st">"condition"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## NULL</span></span></code></pre>
<p>Indeed the algorithm stops because at the following value, the
log-likelihood is infinite.</p>
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu">dshiftlnorm_no</span><span class="op">(</span><span class="va">y</span>, <span class="fl">0.16383978</span>, <span class="fl">0.01679231</span>, <span class="fl">1.17586600</span> <span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -Inf</span></span></code></pre>
<div class="sourceCode" id="cb124"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/prod.html" class="external-link">prod</a></span><span class="op">(</span><span class="fu">dshiftlnorm_no</span><span class="op">(</span><span class="va">y</span>, <span class="fl">0.16383978</span>, <span class="fl">0.01679231</span>, <span class="fl">1.17586600</span> <span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -Inf</span></span></code></pre>
<div class="sourceCode" id="cb126"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">dshiftlnorm</span><span class="op">(</span><span class="va">y</span>, <span class="fl">0.16383978</span>, <span class="fl">0.01679231</span>, <span class="fl">1.17586600</span>, <span class="cn">TRUE</span> <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 7761</span></span></code></pre>
<p>There is something wrong in the computation.</p>
<p>Only the R-base implementation using <code>log</code> argument seems
reliable. This happens the C-base implementation of <code>dlnorm</code>
takes care of the log value. In the file
<code>../src/nmath/dlnorm.c</code> in the R sources, we find the C code
for <code>dlnorm</code></p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" tabindex="-1"></a>double <span class="fu">dlnorm</span>(double x, double meanlog, double sdlog, int give_log)</span>
<span id="cb128-2"><a href="#cb128-2" tabindex="-1"></a>{</span>
<span id="cb128-3"><a href="#cb128-3" tabindex="-1"></a>    double y;</span>
<span id="cb128-4"><a href="#cb128-4" tabindex="-1"></a></span>
<span id="cb128-5"><a href="#cb128-5" tabindex="-1"></a><span class="co">#ifdef IEEE_754</span></span>
<span id="cb128-6"><a href="#cb128-6" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">ISNAN</span>(x) <span class="sc">||</span> <span class="fu">ISNAN</span>(meanlog) <span class="sc">||</span> <span class="fu">ISNAN</span>(sdlog))</span>
<span id="cb128-7"><a href="#cb128-7" tabindex="-1"></a>    return x <span class="sc">+</span> meanlog <span class="sc">+</span> sdlog;</span>
<span id="cb128-8"><a href="#cb128-8" tabindex="-1"></a><span class="co">#endif</span></span>
<span id="cb128-9"><a href="#cb128-9" tabindex="-1"></a>    <span class="cf">if</span>(sdlog <span class="sc">&lt;=</span> <span class="dv">0</span>) {</span>
<span id="cb128-10"><a href="#cb128-10" tabindex="-1"></a>    <span class="cf">if</span>(sdlog <span class="sc">&lt;</span> <span class="dv">0</span>) ML_ERR_return_NAN;</span>
<span id="cb128-11"><a href="#cb128-11" tabindex="-1"></a>    <span class="sc">/</span><span class="er">/</span> sdlog <span class="sc">==</span> <span class="dv">0</span> <span class="sc">:</span></span>
<span id="cb128-12"><a href="#cb128-12" tabindex="-1"></a>    <span class="fu">return</span> (<span class="fu">log</span>(x) <span class="sc">==</span> meanlog) ? ML_POSINF <span class="sc">:</span> R_D__0;</span>
<span id="cb128-13"><a href="#cb128-13" tabindex="-1"></a>    }</span>
<span id="cb128-14"><a href="#cb128-14" tabindex="-1"></a>    <span class="cf">if</span>(x <span class="sc">&lt;=</span> <span class="dv">0</span>) return R_D__0;</span>
<span id="cb128-15"><a href="#cb128-15" tabindex="-1"></a></span>
<span id="cb128-16"><a href="#cb128-16" tabindex="-1"></a>    y <span class="ot">=</span> (<span class="fu">log</span>(x) <span class="sc">-</span> meanlog) <span class="sc">/</span> sdlog;</span>
<span id="cb128-17"><a href="#cb128-17" tabindex="-1"></a>    <span class="fu">return</span> (give_log ?</span>
<span id="cb128-18"><a href="#cb128-18" tabindex="-1"></a>        <span class="sc">-</span>(M_LN_SQRT_2PI   <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> y <span class="sc">*</span> y <span class="sc">+</span> <span class="fu">log</span>(x <span class="sc">*</span> sdlog)) <span class="sc">:</span></span>
<span id="cb128-19"><a href="#cb128-19" tabindex="-1"></a>        M_1_SQRT_2PI <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span> y <span class="sc">*</span> y)  <span class="sc">/</span>  (x <span class="sc">*</span> sdlog));</span>
<span id="cb128-20"><a href="#cb128-20" tabindex="-1"></a>    <span class="sc">/</span><span class="er">*</span> M_1_SQRT_2PI <span class="ot">=</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi) <span class="sc">*</span><span class="er">/</span></span>
<span id="cb128-21"><a href="#cb128-21" tabindex="-1"></a></span>
<span id="cb128-22"><a href="#cb128-22" tabindex="-1"></a>}</span></code></pre></div>
<p>In the last four lines with the logical condtion
<code>give_log?</code>, we see how the <code>log</code> argument is
handled:</p>
<ul>
<li>when log=TRUE, we use
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msqrt><mrow><mn>2</mn><mi>π</mi></mrow></msqrt><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup><mi>/</mi><mn>2</mn><mo>+</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mi>σ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">-(\log(\sqrt{2\pi}) + y^2/2+\log(x\sigma))</annotation></semantics></math>
</li>
</ul>
<div class="sourceCode" id="cb129"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">-</span><span class="op">(</span><span class="va">M_LN_SQRT_2PI</span>   <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">y</span> <span class="op">*</span> <span class="va">y</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">x</span> <span class="op">*</span> <span class="va">sdlog</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>when log=FALSE, we use
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><mrow><mn>2</mn><mi>π</mi></mrow></msqrt><mo>*</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>y</mi><mn>2</mn></msup><mi>/</mi><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mi>σ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\sqrt{2\pi} *\exp( y^2/2)/(x\sigma))</annotation></semantics></math>
(and then the logarithm outside <code>dlnorm</code>)</li>
</ul>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" tabindex="-1"></a>M_1_SQRT_2PI <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span> y <span class="sc">*</span> y)  <span class="sc">/</span>  (x <span class="sc">*</span> sdlog)<span class="er">)</span></span></code></pre></div>
<p>Note that the constant
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msqrt><mrow><mn>2</mn><mi>π</mi></mrow></msqrt><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\log(\sqrt{2\pi})</annotation></semantics></math>
is pre-computed in the C macro <code>M_LN_SQRT_2PI</code>.</p>
<p>In order to sort out this problem, we use the
<code>constrOptim</code> wrapping <code>optim</code> to take into
account linear constraints. This allows also to use other optimization
methods than L-BFGS-B (low-memory BFGS bounded) used in optim.</p>
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">y</span>, <span class="st">"shiftlnorm"</span>, start<span class="op">=</span><span class="va">start</span>, lower<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, </span>
<span>              optim.method<span class="op">=</span><span class="st">"Nelder-Mead"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in cov2cor(varcovar): diag(V) had non-positive or NA entries; the</span></span>
<span><span class="co">## non-finite result may be dubious</span></span></code></pre>
<pre><code><span><span class="co">## Warning in sqrt(diag(varcovar)): NaNs produced</span></span></code></pre>
<div class="sourceCode" id="cb134"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">f2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Fitting of the distribution ' shiftlnorm ' by maximum likelihood </span></span>
<span><span class="co">## Parameters : </span></span>
<span><span class="co">##       estimate Std. Error</span></span>
<span><span class="co">## mean   -1.3872        NaN</span></span>
<span><span class="co">## sigma   0.0711        NaN</span></span>
<span><span class="co">## shift   0.2481        NaN</span></span>
<span><span class="co">## Loglikelihood:  8299   AIC:  -16591   BIC:  -16573 </span></span>
<span><span class="co">## Correlation matrix:</span></span>
<span><span class="co">##       mean sigma shift</span></span>
<span><span class="co">## mean     1   NaN   NaN</span></span>
<span><span class="co">## sigma  NaN     1   NaN</span></span>
<span><span class="co">## shift  NaN   NaN     1</span></span></code></pre>
<div class="sourceCode" id="cb136"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>BFGS<span class="op">=</span><span class="va">f</span><span class="op">$</span><span class="va">estimate</span>, NelderMead<span class="op">=</span><span class="va">f2</span><span class="op">$</span><span class="va">estimate</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          BFGS NelderMead</span></span>
<span><span class="co">## mean  -1.3848    -1.3872</span></span>
<span><span class="co">## sigma  0.0709     0.0711</span></span>
<span><span class="co">## shift  0.2487     0.2481</span></span></code></pre>
<p>Another possible would be to perform all computations with higher
precision arithmetics as implemented in the package <code>Rmpfr</code>
using the MPFR library.</p>
</div>
<div class="section level3">
<h3 id="what-to-do-when-there-is-a-scaling-issue">3.4. What to do when there is a scaling issue?<a class="anchor" aria-label="anchor" href="#what-to-do-when-there-is-a-scaling-issue"></a>
</h3>
<p>Let us consider a dataset which has particular small values.</p>
<div class="sourceCode" id="cb138"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dataFAQscale1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dataFAQscale1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -0.007077 -0.000947 -0.001898 -0.000475 -0.001902 -0.000476</span></span></code></pre>
<div class="sourceCode" id="cb140"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">dataFAQscale1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. </span></span>
<span><span class="co">## -0.007077 -0.001435 -0.000473 -0.000309  0.000959  0.004285</span></span></code></pre>
<p>The only way to sort out is to multiply the dataset by a large
value.</p>
<div class="sourceCode" id="cb142"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">6</span><span class="op">:</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="va">i</span>, <span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/mledist.html">mledist</a></span><span class="op">(</span><span class="va">dataFAQscale1</span><span class="op">*</span><span class="fl">10</span><span class="op">^</span><span class="va">i</span>, <span class="st">"cauchy"</span><span class="op">)</span><span class="op">$</span><span class="va">estimate</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 1e+06 -290 1194 </span></span>
<span><span class="co">## 1e+05 -29 119 </span></span>
<span><span class="co">## 10000 -2.9 11.9 </span></span>
<span><span class="co">## 1000 -0.29 1.19 </span></span>
<span><span class="co">## 100 -0.029 0.119 </span></span>
<span><span class="co">## 10 -0.0029 0.0119 </span></span>
<span><span class="co">## &lt;simpleError in optim(par = vstart, fn = fnobj, fix.arg = fix.arg, obs = data,     gr = gradient, ddistnam = ddistname, hessian = TRUE, method = meth,     lower = lower, upper = upper, ...): non-finite finite-difference value [2]&gt;</span></span>
<span><span class="co">## 1 NA NA</span></span></code></pre>
<p>Let us consider a dataset which has particular large values.</p>
<div class="sourceCode" id="cb144"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dataFAQscale2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dataFAQscale2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1.40e+09 1.41e+09 1.43e+09 1.44e+09 1.49e+09 1.57e+09</span></span></code></pre>
<div class="sourceCode" id="cb146"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">dataFAQscale2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. </span></span>
<span><span class="co">## 1.40e+09 1.58e+09 2.24e+09 2.55e+09 3.39e+09 4.49e+09</span></span></code></pre>
<p>The only way to sort out is to multiply the dataset by a small
value.</p>
<div class="sourceCode" id="cb148"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">0</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="va">i</span><span class="op">)</span>, <span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/mledist.html">mledist</a></span><span class="op">(</span><span class="va">dataFAQscale2</span><span class="op">*</span><span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="va">i</span><span class="op">)</span>, <span class="st">"cauchy"</span><span class="op">)</span><span class="op">$</span><span class="va">estimate</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 1 2.03e+09 6.59e+08 </span></span>
<span><span class="co">## 0.01 20283641 6594932 </span></span>
<span><span class="co">## 1e-04 202836 65949 </span></span>
<span><span class="co">## 1e-06 2028 659 </span></span>
<span><span class="co">## 1e-08 20.3 6.59 </span></span>
<span><span class="co">## 1e-10 0.203 0.0659</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="how-do-i-set-bounds-on-parameters-when-optimizing">3.5. How do I set bounds on parameters when optimizing?<a class="anchor" aria-label="anchor" href="#how-do-i-set-bounds-on-parameters-when-optimizing"></a>
</h3>
<div class="section level4">
<h4 id="setting-bounds-for-scale-parameters">3.5.1. Setting bounds for scale parameters<a class="anchor" aria-label="anchor" href="#setting-bounds-for-scale-parameters"></a>
</h4>
<p>Consider the normal distribution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝒩</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo>,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal{N}(\mu, \sigma^2)</annotation></semantics></math>
defined by the density
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><msqrt><mrow><mn>2</mn><mi>π</mi><msup><mi>σ</mi><mn>2</mn></msup></mrow></msqrt></mfrac><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>−</mo><mi>μ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mrow><mn>2</mn><msup><mi>σ</mi><mn>2</mn></msup></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>x</mi><mo>∈</mo><mi>ℝ</mi><mo>,</mo></mrow><annotation encoding="application/x-tex">
f(x) = \frac{1}{\sqrt{2\pi\sigma^2}}\exp\left(-\frac{(x-\mu)^2}{2\sigma^2}\right),
x\in\mathbb{R},
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>
is a location parameter such that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mo>∈</mo><mi>ℝ</mi></mrow><annotation encoding="application/x-tex">\mu\in\mathbb{R}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>σ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\sigma^2</annotation></semantics></math>
is a scale parameter such that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>σ</mi><mn>2</mn></msup><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\sigma^2&gt;0</annotation></semantics></math>.
Therefore when optimizing the log-likelihood or the squared differences
or the GoF statistics. Setting a lower bound for the scale parameter is
easy with <code>fitdist</code>: just use the <code>lower</code>
argument.</p>
<div class="sourceCode" id="cb150"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"norm"</span>, lower<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Fitting of the distribution ' norm ' by maximum likelihood </span></span>
<span><span class="co">## Parameters:</span></span>
<span><span class="co">##      estimate Std. Error</span></span>
<span><span class="co">## mean    0.947     0.0630</span></span>
<span><span class="co">## sd      1.994     0.0446</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="setting-bounds-for-shape-parameters">3.5.2. Setting bounds for shape parameters<a class="anchor" aria-label="anchor" href="#setting-bounds-for-shape-parameters"></a>
</h4>
<p>Consider the Burr distribution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ℬ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo>,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal B(\mu, \sigma^2)</annotation></semantics></math>
defined by the density
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mi>a</mi><mi>b</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mi>/</mi><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>b</mi></msup></mrow><mrow><mi>x</mi><msup><mrow><mo stretchy="true" form="prefix">[</mo><mn>1</mn><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mi>/</mi><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>b</mi></msup><mo stretchy="true" form="postfix">]</mo></mrow><mrow><mi>a</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow></mfrac><mo>,</mo><mi>x</mi><mo>∈</mo><mi>ℝ</mi><mo>,</mo></mrow><annotation encoding="application/x-tex">
f(x) = \frac{a b (x/s)^b}{x [1 + (x/s)^b]^{a + 1}},
x\in\mathbb{R},
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>,</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">a,b</annotation></semantics></math>
are shape parameters such that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>,</mo><mi>b</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">a,b&gt;0</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>
is a scale parameter such that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">s&gt;0</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb152"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/actuar/man/Burr.html" class="external-link">rburr</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"burr"</span>, lower<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>shape1 <span class="op">=</span> <span class="fl">1</span>, shape2 <span class="op">=</span> <span class="fl">1</span>, </span>
<span>  rate <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Fitting of the distribution ' burr ' by maximum likelihood </span></span>
<span><span class="co">## Parameters:</span></span>
<span><span class="co">##        estimate Std. Error</span></span>
<span><span class="co">## shape1    0.968     0.0334</span></span>
<span><span class="co">## shape2    2.051     0.0367</span></span>
<span><span class="co">## rate      3.181     0.0516</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="setting-bounds-for-probability-parameters">3.5.3. Setting bounds for probability parameters<a class="anchor" aria-label="anchor" href="#setting-bounds-for-probability-parameters"></a>
</h4>
<p>Consider the geometric distribution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝒢</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal G(p)</annotation></semantics></math>
defined by the mass probability function
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>p</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>x</mi></msup><mo>,</mo><mi>x</mi><mo>∈</mo><mi>ℕ</mi><mo>,</mo></mrow><annotation encoding="application/x-tex">
f(x) = p(1-p)^x,
x\in\mathbb{N},
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
is a probability parameter such that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>∈</mo><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">p\in[0,1]</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb154"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Geometric.html" class="external-link">rgeom</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"geom"</span>, lower<span class="op">=</span><span class="fl">0</span>, upper<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Fitting of the distribution ' geom ' by maximum likelihood </span></span>
<span><span class="co">## Parameters:</span></span>
<span><span class="co">##      estimate Std. Error</span></span>
<span><span class="co">## prob    0.242    0.00666</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="setting-bounds-for-boundary-parameters">3.5.4. Setting bounds for boundary parameters<a class="anchor" aria-label="anchor" href="#setting-bounds-for-boundary-parameters"></a>
</h4>
<p>Consider the shifted exponential distribution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ℰ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo>,</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal E(\mu,\lambda)</annotation></semantics></math>
defined by the mass probability function
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>λ</mi><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mi>λ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>−</mo><mi>μ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>x</mi><mo>&gt;</mo><mi>μ</mi><mo>,</mo></mrow><annotation encoding="application/x-tex">
f(x) = \lambda \exp(-\lambda(x-\mu)),
x&gt;\mu,
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
is a scale parameter such that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\lambda&gt;0</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>
is a boundary (or shift) parameter such that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mo>∈</mo><mi>ℝ</mi></mrow><annotation encoding="application/x-tex">\mu\in\mathbb{R}</annotation></semantics></math>.
When optimizing the log-likelihood, the boundary constraint is
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∀</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>n</mi><mo>,</mo><msub><mi>x</mi><mi>i</mi></msub><mo>&gt;</mo><mi>μ</mi><mo>⇒</mo><munder><mo>min</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>n</mi></mrow></munder><msub><mi>x</mi><mi>i</mi></msub><mo>&gt;</mo><mi>μ</mi><mo>⇔</mo><mi>μ</mi><mo>&gt;</mo><mo>−</mo><munder><mo>min</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>n</mi></mrow></munder><msub><mi>x</mi><mi>i</mi></msub><mi>.</mi></mrow><annotation encoding="application/x-tex">
\forall i=1,\dots,n, x_i&gt;\mu
\Rightarrow
\min_{i=1,\dots,n} x_i &gt; \mu
\Leftrightarrow 
\mu &gt; -\min_{i=1,\dots,n} x_i.
</annotation></semantics></math> Note that when optimizing the squared
differences or the GoF statistics, this constraint may not be necessary.
Let us do it in R.</p>
<div class="sourceCode" id="cb156"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dsexp</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">rate</span>, <span class="va">shift</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">dexp</a></span><span class="op">(</span><span class="va">x</span><span class="op">-</span><span class="va">shift</span>, rate<span class="op">=</span><span class="va">rate</span><span class="op">)</span></span>
<span><span class="va">psexp</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">rate</span>, <span class="va">shift</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">pexp</a></span><span class="op">(</span><span class="va">x</span><span class="op">-</span><span class="va">shift</span>, rate<span class="op">=</span><span class="va">rate</span><span class="op">)</span></span>
<span><span class="va">rsexp</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">rate</span>, <span class="va">shift</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="va">n</span>, rate<span class="op">=</span><span class="va">rate</span><span class="op">)</span><span class="op">+</span><span class="va">shift</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">rsexp</span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"sexp"</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rate<span class="op">=</span><span class="fl">1</span>, shift<span class="op">=</span><span class="fl">0</span><span class="op">)</span>, upper<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">Inf</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Fitting of the distribution ' sexp ' by maximum likelihood </span></span>
<span><span class="co">## Parameters:</span></span>
<span><span class="co">##       estimate Std. Error</span></span>
<span><span class="co">## rate     0.248          0</span></span>
<span><span class="co">## shift    1.005        NaN</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="setting-linear-inequality-bounds">3.5.5. Setting linear inequality bounds<a class="anchor" aria-label="anchor" href="#setting-linear-inequality-bounds"></a>
</h4>
<p>For some distributions, bounds between parameters are not
independent. For instance, the normal inverse Gaussian distribution
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mo>,</mo><mi>δ</mi><mo>,</mo><mi>α</mi><mo>,</mo><mi>β</mi></mrow><annotation encoding="application/x-tex">\mu, \delta, \alpha, \beta</annotation></semantics></math>
parametrization) has the following parameter constraints, which can be
reformulated as a linear inequality:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mi>α</mi><mo>&gt;</mo><mn>0</mn></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mi>δ</mi><mo>&gt;</mo><mn>0</mn></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mi>α</mi><mo>&gt;</mo><mrow><mo stretchy="true" form="prefix">|</mo><mi>β</mi><mo stretchy="true" form="postfix">|</mo></mrow></mtd></mtr></mtable></mrow><mo>⇔</mo><munder><munder><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mo>−</mo><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo accent="true">⏟</mo></munder><mrow><mi>u</mi><mi>i</mi></mrow></munder><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>μ</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>δ</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>α</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>β</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>≥</mo><munder><munder><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo accent="true">⏟</mo></munder><mrow><mi>c</mi><mi>i</mi></mrow></munder><mi>.</mi></mrow><annotation encoding="application/x-tex">
\left\{
\begin{array}{l}\alpha &gt; 0\\ \delta &gt;0\\ \alpha &gt; |\beta|\end{array}
\right.
\Leftrightarrow
\underbrace{
\left(
\begin{matrix}
0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1 &amp; -1 \\
0 &amp; 0 &amp; 1 &amp; 1 \\
\end{matrix}
\right)
}_{ui}
\left(
\begin{matrix}
\mu\\ \delta\\ \alpha \\ \beta \\
\end{matrix}
\right)
\geq 
\underbrace{
\left(
\begin{matrix}
0\\ 0\\ 0 \\ 0 \\
\end{matrix}
\right)}_{ci}.
</annotation></semantics></math> These constraints can be carried out
via <code><a href="https://rdrr.io/r/stats/constrOptim.html" class="external-link">constrOptim()</a></code> and the arguments <code>ci</code> and
<code>ui</code>. Here is an example</p>
<div class="sourceCode" id="cb158"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://r-forge.r-project.org/projects/rmetrics/" class="external-link">"GeneralizedHyperbolic"</a></span><span class="op">)</span></span>
<span><span class="va">myoptim</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">fn</span>, <span class="va">par</span>, <span class="va">ui</span>, <span class="va">ci</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/constrOptim.html" class="external-link">constrOptim</a></span><span class="op">(</span>f<span class="op">=</span><span class="va">fn</span>, theta<span class="op">=</span><span class="va">par</span>, method<span class="op">=</span><span class="st">"Nelder-Mead"</span>, ui<span class="op">=</span><span class="va">ui</span>, ci<span class="op">=</span><span class="va">ci</span>, <span class="va">...</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">res</span>, convergence<span class="op">=</span><span class="va">res</span><span class="op">$</span><span class="va">convergence</span>, value<span class="op">=</span><span class="va">res</span><span class="op">$</span><span class="va">objective</span>, </span>
<span>    par<span class="op">=</span><span class="va">res</span><span class="op">$</span><span class="va">minimum</span>, hessian<span class="op">=</span><span class="va">res</span><span class="op">$</span><span class="va">hessian</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GeneralizedHyperbolic/man/dnig.html" class="external-link">rnig</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ci</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"nig"</span>, custom.optim<span class="op">=</span><span class="va">myoptim</span>, ui<span class="op">=</span><span class="va">ui</span>, ci<span class="op">=</span><span class="va">ci</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fl">0</span>, delta <span class="op">=</span> <span class="fl">1</span>, alpha <span class="op">=</span> <span class="fl">1</span>, beta <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in fitdist(x, "nig", custom.optim = myoptim, ui = ui, ci = ci, start =</span></span>
<span><span class="co">## list(mu = 0, : The dnig function should return a vector of with NaN values when</span></span>
<span><span class="co">## input has inconsistent parameters and not raise an error</span></span></code></pre>
<pre><code><span><span class="co">## Warning in fitdist(x, "nig", custom.optim = myoptim, ui = ui, ci = ci, start =</span></span>
<span><span class="co">## list(mu = 0, : The pnig function should return a vector of with NaN values when</span></span>
<span><span class="co">## input has inconsistent values and not raise an error</span></span></code></pre>
<pre><code><span><span class="co">## Fitting of the distribution ' nig ' by maximum likelihood </span></span>
<span><span class="co">## Parameters:</span></span>
<span><span class="co">##       estimate</span></span>
<span><span class="co">## mu       2.985</span></span>
<span><span class="co">## delta    0.457</span></span>
<span><span class="co">## alpha    0.466</span></span>
<span><span class="co">## beta     0.237</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="how-does-quantile-matching-estimation-work-for-discrete-distributions">3.6. How does quantile matching estimation work for discrete
distributions?<a class="anchor" aria-label="anchor" href="#how-does-quantile-matching-estimation-work-for-discrete-distributions"></a>
</h3>
<p>Let us consider the geometric distribution with values in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mi>…</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{0,1,2,3,\dots\}</annotation></semantics></math>.
The probability mass function, the cumulative distribution function and
the quantile function are
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo>=</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>p</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="false" form="prefix">⌊</mo><mi>x</mi><mo stretchy="false" form="postfix">⌋</mo></mrow></msup><mo>,</mo><msub><mi>F</mi><mi>X</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="false" form="prefix">⌊</mo><mi>x</mi><mo stretchy="false" form="postfix">⌋</mo></mrow></msup><mo>,</mo><msubsup><mi>F</mi><mi>X</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>q</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">⌊</mo><mfrac><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>q</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo stretchy="true" form="postfix">⌋</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
P(X=x)= p (1-p)^{\lfloor x\rfloor},
F_X(x) = 1- (1-p)^{\lfloor x\rfloor},
F_X^{-1}(q) = \left\lfloor\frac{\log(1-q)}{\log(1-p)}\right\rfloor.
</annotation></semantics></math> Due to the integer part (floor
function), both the distribution function and the quantile function are
step functions.</p>
<div class="sourceCode" id="cb162"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Geometric.html" class="external-link">pgeom</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">3</span>, prob<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.500 0.750 0.875 0.938</span></span></code></pre>
<div class="sourceCode" id="cb164"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Geometric.html" class="external-link">qgeom</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.6</span>, <span class="fl">0.9</span><span class="op">)</span>, prob<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0 1 3</span></span></code></pre>
<div class="sourceCode" id="cb166"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, mfrow<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Geometric.html" class="external-link">pgeom</a></span><span class="op">(</span><span class="va">x</span>, prob<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">10</span>, n<span class="op">=</span><span class="fl">301</span>, main<span class="op">=</span><span class="st">"c.d.f."</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Geometric.html" class="external-link">qgeom</a></span><span class="op">(</span><span class="va">x</span>, prob<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">1</span>, n<span class="op">=</span><span class="fl">301</span>, main<span class="op">=</span><span class="st">"q.f."</span><span class="op">)</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-48-1.png" class="r-plt" width="672"></p>
<p>Now we study the QME for the geometric distribution. Since we have
only one parameter, we choose one probabiliy,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>1</mn><mi>/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">p=1/2</annotation></semantics></math>.
The theoretical median is the following integer
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>F</mi><mi>X</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mi>/</mi><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">⌊</mo><mfrac><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mi>/</mi><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo stretchy="true" form="postfix">⌋</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
F_X^{-1}(1/2) = \left\lfloor\frac{\log(1/2)}{\log(1-p)}\right\rfloor.
</annotation></semantics></math> Note that the theoretical median for a
discrete distribution is an integer. Empirically, the median may not be
an integer. Indeed for an even length dataset, the empirical median is
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>q</mi><mrow><mi>n</mi><mo>,</mo><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msub><mo>=</mo><mfrac><mrow><msubsup><mi>x</mi><mrow><mi>n</mi><mi>/</mi><mn>2</mn></mrow><mo>⋆</mo></msubsup><mo>+</mo><msubsup><mi>x</mi><mrow><mi>n</mi><mi>/</mi><mn>2</mn><mo>+</mo><mn>1</mn></mrow><mo>⋆</mo></msubsup></mrow><mn>2</mn></mfrac><mo>,</mo></mrow><annotation encoding="application/x-tex">
q_{n,1/2} = \frac{x_{n/2}^\star + x_{n/2+1}^\star}{2},
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>x</mi><mn>1</mn><mo>⋆</mo></msubsup><mo>&lt;</mo><mi>…</mi><mo>&lt;</mo><msubsup><mi>x</mi><mi>n</mi><mo>⋆</mo></msubsup></mrow><annotation encoding="application/x-tex">x_{1}^\star&lt;\dots&lt;x_{n}^\star</annotation></semantics></math>
is the sorted sample, which is not an integer value if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>x</mi><mrow><mi>n</mi><mi>/</mi><mn>2</mn></mrow><mo>⋆</mo></msubsup><mo>+</mo><msubsup><mi>x</mi><mrow><mi>n</mi><mi>/</mi><mn>2</mn><mo>+</mo><mn>1</mn></mrow><mo>⋆</mo></msubsup></mrow><annotation encoding="application/x-tex">x_{n/2}^\star + x_{n/2+1}^\star</annotation></semantics></math>
is not an even number. However for an odd length dataset, the empirical
median is an integer
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>q</mi><mrow><mi>n</mi><mo>,</mo><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msub><mo>=</mo><msubsup><mi>x</mi><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mn>2</mn></mrow><mo>⋆</mo></msubsup></mrow><annotation encoding="application/x-tex">q_{n,1/2}=x_{(n+1)/2}^\star</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb167"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="co">#sample size 10</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.5</span></span></code></pre>
<div class="sourceCode" id="cb169"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="co">#sample size 11</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0</span></span></code></pre>
<p>Therefore, a first issue arises: if the median is not an integer, it
is impossible to match exactly the empirical median with the theoretical
quantile.</p>
<p>Furthermore, the second issue is the non-uniqueness of the solution.
Admitting matching
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>q</mi><mrow><mi>n</mi><mo>,</mo><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msub><annotation encoding="application/x-tex">q_{n,1/2}</annotation></semantics></math>
is an integer, QME aims to find some
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
such that
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">⌊</mo><mfrac><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mi>/</mi><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo stretchy="true" form="postfix">⌋</mo></mrow><mo>=</mo><msub><mi>q</mi><mrow><mi>n</mi><mo>,</mo><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msub><mo>⇔</mo><msub><mi>q</mi><mrow><mi>n</mi><mo>,</mo><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msub><mo>≤</mo><mfrac><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mi>/</mi><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>&lt;</mo><msub><mi>q</mi><mrow><mi>n</mi><mo>,</mo><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msub><mo>+</mo><mn>1</mn><mi>.</mi></mrow><annotation encoding="application/x-tex">
\left\lfloor\frac{\log(1/2)}{\log(1-p)}\right\rfloor = q_{n,1/2}
\Leftrightarrow 
q_{n,1/2} \leq \frac{\log(1/2)}{\log(1-p)} &lt; q_{n,1/2} +1.
</annotation></semantics></math> Let us plot the squared differences
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>F</mi><mi>X</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mi>/</mi><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mi>q</mi><mrow><mi>n</mi><mo>,</mo><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><annotation encoding="application/x-tex">(F_X^{-1}(1/2) - q_{n,1/2})^2</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb171"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Geometric.html" class="external-link">rgeom</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">L2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span>  <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Geometric.html" class="external-link">qgeom</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span>, <span class="va">p</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="fu">L2</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span> <span class="co">#theoretical value</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0</span></span></code></pre>
<div class="sourceCode" id="cb173"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span><span class="fu">L2</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fl">0.10</span>, <span class="fl">0.95</span>, xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>, ylab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">L2</span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span>, </span>
<span>      main<span class="op">=</span><span class="st">"squared differences"</span>, type<span class="op">=</span><span class="st">"s"</span><span class="op">)</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-50-1.png" class="r-plt" width="672"></p>
<p>Any value between [1/3, 5/9] minimizes the squared differences.
Therefore, <code><a href="../reference/fitdist.html">fitdist()</a></code> may be sensitive to the chosen initial
value with deterministic optimization algorithm.</p>
<div class="sourceCode" id="cb174"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"geom"</span>, method<span class="op">=</span><span class="st">"qme"</span>, probs<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>prob<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, </span>
<span>        control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>trace<span class="op">=</span><span class="fl">1</span>, REPORT<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## initial  value 1.000000 </span></span>
<span><span class="co">## iter   2 value 0.000000</span></span>
<span><span class="co">## iter   2 value 0.000000</span></span>
<span><span class="co">## iter   2 value 0.000000</span></span>
<span><span class="co">## final  value 0.000000 </span></span>
<span><span class="co">## converged</span></span></code></pre>
<pre><code><span><span class="co">## Fitting of the distribution ' geom ' by matching quantiles </span></span>
<span><span class="co">## Parameters:</span></span>
<span><span class="co">##      estimate</span></span>
<span><span class="co">## prob     0.34</span></span></code></pre>
<div class="sourceCode" id="cb177"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"geom"</span>, method<span class="op">=</span><span class="st">"qme"</span>, probs<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>prob<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">20</span><span class="op">)</span>, </span>
<span>        control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>trace<span class="op">=</span><span class="fl">1</span>, REPORT<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## initial  value 144.000000 </span></span>
<span><span class="co">## iter   1 value 144.000000</span></span>
<span><span class="co">## final  value 144.000000 </span></span>
<span><span class="co">## converged</span></span></code></pre>
<pre><code><span><span class="co">## Fitting of the distribution ' geom ' by matching quantiles </span></span>
<span><span class="co">## Parameters:</span></span>
<span><span class="co">##      estimate</span></span>
<span><span class="co">## prob     0.05</span></span></code></pre>
<p>The solution is to use a stochastic algorithm such as simulated
annealing (SANN).</p>
<div class="sourceCode" id="cb180"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"geom"</span>, method<span class="op">=</span><span class="st">"qme"</span>, probs<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span>, optim.method<span class="op">=</span><span class="st">"SANN"</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>prob<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Fitting of the distribution ' geom ' by matching quantiles </span></span>
<span><span class="co">## Parameters:</span></span>
<span><span class="co">##      estimate</span></span>
<span><span class="co">## prob    0.497</span></span></code></pre>
<div class="sourceCode" id="cb182"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"geom"</span>, method<span class="op">=</span><span class="st">"qme"</span>, probs<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span>, optim.method<span class="op">=</span><span class="st">"SANN"</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>prob<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Fitting of the distribution ' geom ' by matching quantiles </span></span>
<span><span class="co">## Parameters:</span></span>
<span><span class="co">##      estimate</span></span>
<span><span class="co">## prob    0.401</span></span></code></pre>
<p>Let us consider the Poisson distribution defined by the following
mass probability and the cumulative distribution functions
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo>=</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><msup><mi>λ</mi><mi>k</mi></msup><mrow><mi>k</mi><mi>!</mi></mrow></mfrac><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="0.222em"></mspace><msub><mi>F</mi><mi>X</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mrow><mo stretchy="false" form="prefix">⌊</mo><mi>x</mi><mo stretchy="false" form="postfix">⌋</mo></mrow></munderover><mfrac><msup><mi>λ</mi><mi>k</mi></msup><mrow><mi>k</mi><mi>!</mi></mrow></mfrac><mo>,</mo><mspace width="0.222em"></mspace><mi>x</mi><mo>≥</mo><mn>0</mn><mi>.</mi></mrow><annotation encoding="application/x-tex">
P(X=k)=\frac{\lambda^k}{k!}\exp(-\lambda),~
F_X(x) = \exp(-\lambda)\sum_{k=0}^{\lfloor x \rfloor}\frac{\lambda^k}{k!},~
x\geq 0.
</annotation></semantics></math> The quantile function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>F</mi><mi>X</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>inf</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>,</mo><msub><mi>F</mi><mi>X</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>≥</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">F_X^{-1}(p)=\inf(x, F_X(x)\geq p)</annotation></semantics></math>
simplifies to
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>F</mi><mi>X</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>i</mi><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> such that </mtext><mspace width="0.333em"></mspace></mrow><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></munderover><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo>=</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>≤</mo><mi>p</mi><mo>&lt;</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mi>i</mi></munderover><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo>=</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
F_X^{-1}(p) = i \text{ such that } \sum_{k=0}^{i-1} P(X=k) \leq p &lt; \sum_{k=0}^{i} P(X=k).
</annotation></semantics></math> Again, the quantile function is a step
function
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>F</mi><mi>X</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mn>0</mn></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>p</mi><mo>&lt;</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo>=</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>1</mn></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo>=</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>≤</mo><mi>p</mi><mo>&lt;</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo>=</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>2</mn></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo>=</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>≤</mo><mi>p</mi><mo>&lt;</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo>=</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo>=</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mi>…</mi></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mi>i</mi></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></munderover><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo>=</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>≤</mo><mi>p</mi><mo>&lt;</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mi>i</mi></munderover><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo>=</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mi>…</mi></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
F_X^{-1}(p) =  
\left\{ \begin{array}{ll}
0 &amp; \text{if } p &lt; P(X=0) \\
1 &amp; \text{if } P(X=0) \leq p &lt; P(X=0)+P(X=1) \\
2 &amp; \text{if } P(X=0)+P(X=1) \leq p &lt; P(X=0)+P(X=1)+P(X=2) \\
\dots \\
i &amp; \text{if } \sum_{k=0}^{i-1} P(X=k) \leq p &lt; \sum_{k=0}^{i} P(X=k) \\
\dots \\
\end{array} \right.
</annotation></semantics></math></p>
<p>Again, the squared differences is a step function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>F</mi><mi>X</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mi>/</mi><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mi>q</mi><mrow><mi>n</mi><mo>,</mo><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><annotation encoding="application/x-tex">(F_X^{-1}(1/2) - q_{n,1/2})^2</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb184"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">100</span>, lambda<span class="op">=</span><span class="fl">7.5</span><span class="op">)</span></span>
<span><span class="va">L2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">lam</span><span class="op">)</span></span>
<span>  <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">qpois</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span>, lambda <span class="op">=</span> <span class="va">lam</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span><span class="fu">L2</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fl">6</span>, <span class="fl">9</span>, xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">)</span>, ylab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">L2</span><span class="op">(</span><span class="va">lambda</span><span class="op">)</span><span class="op">)</span>, </span>
<span>      main<span class="op">=</span><span class="st">"squared differences"</span>, type<span class="op">=</span><span class="st">"s"</span><span class="op">)</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-53-1.png" class="r-plt" width="672"></p>
<p>Therefore, using <code><a href="../reference/fitdist.html">fitdist()</a></code> may be sensitive to the
chosen initial value.</p>
<div class="sourceCode" id="cb185"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"pois"</span>, method<span class="op">=</span><span class="st">"qme"</span>, probs<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lambda<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Fitting of the distribution ' pois ' by matching quantiles </span></span>
<span><span class="co">## Parameters:</span></span>
<span><span class="co">##        estimate</span></span>
<span><span class="co">## lambda        2</span></span></code></pre>
<div class="sourceCode" id="cb187"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"pois"</span>, method<span class="op">=</span><span class="st">"qme"</span>, probs<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span>, optim.method<span class="op">=</span><span class="st">"SANN"</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lambda<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Fitting of the distribution ' pois ' by matching quantiles </span></span>
<span><span class="co">## Parameters:</span></span>
<span><span class="co">##        estimate</span></span>
<span><span class="co">## lambda     6.73</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="why-setting-a-parameter-to-the-true-value-does-not-lead-to-the-expected-result-for-other-parameters">3.7. Why setting a parameter to the true value does not lead to the
expected result for other parameters?<a class="anchor" aria-label="anchor" href="#why-setting-a-parameter-to-the-true-value-does-not-lead-to-the-expected-result-for-other-parameters"></a>
</h3>
<p>Consider the gamma truncated distribution defined by the following
density and cumulative distribution functions</p>
<div class="sourceCode" id="cb189"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#NB: using the logical vector condition is the optimal way to compute pdf and cdf</span></span>
<span><span class="va">dtgamma</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">shape</span>, <span class="va">rate</span>, <span class="va">low</span>, <span class="va">upp</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">PU</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">pgamma</a></span><span class="op">(</span><span class="va">upp</span>, shape <span class="op">=</span> <span class="va">shape</span>, rate <span class="op">=</span> <span class="va">rate</span><span class="op">)</span></span>
<span>  <span class="va">PL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">pgamma</a></span><span class="op">(</span><span class="va">low</span>, shape <span class="op">=</span> <span class="va">shape</span>, rate <span class="op">=</span> <span class="va">rate</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">shape</span>, <span class="va">rate</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">PU</span> <span class="op">-</span> <span class="va">PL</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">x</span> <span class="op">&gt;=</span> <span class="va">low</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">x</span> <span class="op">&lt;=</span> <span class="va">upp</span><span class="op">)</span> </span>
<span><span class="op">}</span></span>
<span><span class="va">ptgamma</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">q</span>, <span class="va">shape</span>, <span class="va">rate</span>, <span class="va">low</span>, <span class="va">upp</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">PU</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">pgamma</a></span><span class="op">(</span><span class="va">upp</span>, shape <span class="op">=</span> <span class="va">shape</span>, rate <span class="op">=</span> <span class="va">rate</span><span class="op">)</span></span>
<span>  <span class="va">PL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">pgamma</a></span><span class="op">(</span><span class="va">low</span>, shape <span class="op">=</span> <span class="va">shape</span>, rate <span class="op">=</span> <span class="va">rate</span><span class="op">)</span></span>
<span>  <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">pgamma</a></span><span class="op">(</span><span class="va">q</span>, <span class="va">shape</span>, <span class="va">rate</span><span class="op">)</span> <span class="op">-</span> <span class="va">PL</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">PU</span> <span class="op">-</span> <span class="va">PL</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">q</span> <span class="op">&gt;=</span> <span class="va">low</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">q</span> <span class="op">&lt;=</span> <span class="va">upp</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">*</span> <span class="op">(</span><span class="va">q</span> <span class="op">&gt;</span> <span class="va">upp</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Simulating from a truncated distribution is done by rejection outside
<code>[low, upp]</code> interval.</p>
<div class="sourceCode" id="cb190"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rtgamma</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">shape</span>, <span class="va">rate</span>, <span class="va">low</span><span class="op">=</span><span class="fl">0</span>, <span class="va">upp</span><span class="op">=</span><span class="cn">Inf</span>, <span class="va">maxit</span><span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="va">n</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">low</span> <span class="op">&gt;</span> <span class="va">upp</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NaN</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">PU</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">pgamma</a></span><span class="op">(</span><span class="va">upp</span>, shape <span class="op">=</span> <span class="va">shape</span>, rate <span class="op">=</span> <span class="va">rate</span><span class="op">)</span></span>
<span>  <span class="va">PL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">pgamma</a></span><span class="op">(</span><span class="va">low</span>, shape <span class="op">=</span> <span class="va">shape</span>, rate <span class="op">=</span> <span class="va">rate</span><span class="op">)</span></span>
<span>  <span class="co">#simulate directly expected number of random variate</span></span>
<span>  <span class="va">n2</span> <span class="op">&lt;-</span> <span class="va">n</span><span class="op">/</span><span class="op">(</span><span class="va">PU</span><span class="op">-</span><span class="va">PL</span><span class="op">)</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="va">n</span>, shape<span class="op">=</span><span class="va">shape</span>, rate<span class="op">=</span><span class="va">rate</span><span class="op">)</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="va">x</span> <span class="op">&gt;=</span> <span class="va">low</span> <span class="op">&amp;</span> <span class="va">x</span> <span class="op">&lt;=</span> <span class="va">upp</span><span class="op">]</span></span>
<span>  <span class="va">i</span> <span class="op">&lt;-</span> <span class="fl">0</span> </span>
<span>  <span class="kw">while</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;</span> <span class="va">n</span> <span class="op">&amp;&amp;</span> <span class="va">i</span> <span class="op">&lt;</span> <span class="va">maxit</span><span class="op">)</span></span>
<span>  <span class="op">{</span></span>
<span>    <span class="va">n2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">PU</span><span class="op">-</span><span class="va">PL</span><span class="op">)</span></span>
<span>    <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="va">n2</span>, shape<span class="op">=</span><span class="va">shape</span>, rate<span class="op">=</span><span class="va">rate</span><span class="op">)</span></span>
<span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">[</span><span class="va">y</span> <span class="op">&gt;=</span> <span class="va">low</span> <span class="op">&amp;</span> <span class="va">y</span> <span class="op">&lt;=</span> <span class="va">upp</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">i</span> <span class="op">&lt;-</span> <span class="va">i</span><span class="op">+</span><span class="fl">1</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">]</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Consider a sample of lower-truncated gamma distribution.</p>
<div class="sourceCode" id="cb191"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span> ; <span class="va">shape</span> <span class="op">&lt;-</span> <span class="fl">11</span> ; <span class="va">rate</span> <span class="op">&lt;-</span> <span class="fl">3</span> ; <span class="va">x0</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">rtgamma</span><span class="op">(</span><span class="va">n</span>, shape <span class="op">=</span> <span class="va">shape</span>, rate <span class="op">=</span> <span class="va">rate</span>, low<span class="op">=</span><span class="va">x0</span><span class="op">)</span></span></code></pre></div>
<p>Fitting two parameters (and setting <code>low</code> parameter) or
fitting all three parameters lead a poorer result both in terms of mean
squared error or relative error. Notably the shape parameter is badly
estimated.</p>
<div class="sourceCode" id="cb192"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.NM.2P</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">x</span>,</span>
<span>  distr <span class="op">=</span> <span class="st">"tgamma"</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"mle"</span>,</span>
<span>  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">10</span>, rate <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>  fix.arg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>upp <span class="op">=</span> <span class="cn">Inf</span>, low<span class="op">=</span><span class="va">x0</span><span class="op">)</span>,</span>
<span>  lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, upper<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">Inf</span>, <span class="cn">Inf</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in cov2cor(varcovar): diag(V) had non-positive or NA entries; the</span></span>
<span><span class="co">## non-finite result may be dubious</span></span></code></pre>
<pre><code><span><span class="co">## Warning in sqrt(diag(varcovar)): NaNs produced</span></span></code></pre>
<div class="sourceCode" id="cb195"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.NM.3P</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">x</span>,</span>
<span>  distr <span class="op">=</span> <span class="st">"tgamma"</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"mle"</span>,</span>
<span>  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">10</span>, rate <span class="op">=</span> <span class="fl">10</span>, low<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>  fix.arg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>upp <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span>,</span>
<span>  lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="op">-</span><span class="cn">Inf</span><span class="op">)</span>, upper<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">Inf</span>, <span class="cn">Inf</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in cov2cor(varcovar): diag(V) had non-positive or NA entries; the</span></span>
<span><span class="co">## non-finite result may be dubious</span></span>
<span><span class="co">## Warning in cov2cor(varcovar): NaNs produced</span></span></code></pre>
<pre><code><span><span class="co">##                 fit3P  fit2P true value</span></span>
<span><span class="co">## shape           50.16  57.14         11</span></span>
<span><span class="co">## rate             9.76  10.92          3</span></span>
<span><span class="co">## low              5.01   5.00          5</span></span>
<span><span class="co">## mean sq. error 526.46 730.64          0</span></span>
<span><span class="co">## rel. error       1.94   2.28          0</span></span></code></pre>
<p>However the fitted cumulative distributions are indistinguable. See
figure below.
<img src="FAQ_files/figure-html/unnamed-chunk-60-1.png" class="r-plt" width="672"></p>
<p>The reason is that the log-likelihood is not the same between the two
cases. Changing the optimization method is useless. The graph below
display the likelihood contours as well as optimization iterates (grey
crosses), the final estimate (black cross) and the true value (red dot).
Iterates get stuck far from the true value.
<img src="FAQ_files/figure-html/unnamed-chunk-61-1.png" class="r-plt" width="672"></p>
<p>In fact the log-likelihood as a function of the shape parameter may
be monotone.
<img src="FAQ_files/figure-html/unnamed-chunk-62-1.png" class="r-plt" width="384"></p>
<p>Fitting a two-parameter distribution (i.e. gamma) on the shifted
dataset is worse.</p>
<div class="sourceCode" id="cb198"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">x</span><span class="op">-</span><span class="va">x0</span>,</span>
<span>  distr <span class="op">=</span> <span class="st">"gamma"</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"mle"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                 fit3P fit2P orig. data fit2P shift data true value</span></span>
<span><span class="co">## shape           50.16            57.14            1.498         11</span></span>
<span><span class="co">## rate             9.76            10.92            2.289          3</span></span>
<span><span class="co">## low              5.01             5.00            5.000          5</span></span>
<span><span class="co">## mean sq. error 526.46           730.64           30.266          0</span></span>
<span><span class="co">## rel. error       1.94             2.28            0.367          0</span></span></code></pre>
<p>Changing the sample size improves the two-parameter fit very slowly
even as the MLE of the <code>low</code> parameter is in fact the minimum
of the dataset: the fitted <code>low</code> converges quickly to the
true value. Below an example with 1000 variates.</p>
<pre><code><span><span class="co">## Warning in cov2cor(varcovar): diag(V) had non-positive or NA entries; the</span></span>
<span><span class="co">## non-finite result may be dubious</span></span></code></pre>
<pre><code><span><span class="co">## Warning in sqrt(diag(varcovar)): NaNs produced</span></span></code></pre>
<pre><code><span><span class="co">## Warning in cov2cor(varcovar): diag(V) had non-positive or NA entries; the</span></span>
<span><span class="co">## non-finite result may be dubious</span></span></code></pre>
<pre><code><span><span class="co">## Warning in sqrt(diag(varcovar)): NaNs produced</span></span></code></pre>
<pre><code><span><span class="co">##                 fit3P fit2P orig. data true value</span></span>
<span><span class="co">## shape          15.144           15.490         11</span></span>
<span><span class="co">## rate            3.623            3.679          3</span></span>
<span><span class="co">## low             5.000            5.000          5</span></span>
<span><span class="co">## mean sq. error  5.854            6.874          0</span></span>
<span><span class="co">## rel. error      0.195            0.212          0</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="questions-regarding-uncertainty">4. Questions regarding uncertainty<a class="anchor" aria-label="anchor" href="#questions-regarding-uncertainty"></a>
</h2>
<div class="section level3">
<h3 id="can-we-compute-marginal-confidence-intervals-on-parameter-estimates-from-their-reported-standard-error">4.1. Can we compute marginal confidence intervals on parameter
estimates from their reported standard error ?<a class="anchor" aria-label="anchor" href="#can-we-compute-marginal-confidence-intervals-on-parameter-estimates-from-their-reported-standard-error"></a>
</h3>
<p>In statistics, deriving marginal confidence intervals on MLE
parameter estimates using the approximation of their standard errors
(calculated from the hessian) is a quite common procedure. It is based
on the wald approximation which stands that when the sample size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
is sufficiently high, the marginal
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>95</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">95\%</annotation></semantics></math>
confidence on the ith component
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\theta_i</annotation></semantics></math>
of a model parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
estimated by maximum likelihood (estimate denoted
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>θ</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat \theta</annotation></semantics></math>)
can be approximated by :
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub><mo>±</mo><mn>1.96</mn><mo>×</mo><mi>S</mi><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat \theta_i \pm 1.96 \times SE(\hat \theta_i )</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">SE(\hat \theta_i )</annotation></semantics></math>
the ith term of the diagonal of the covariance matrix of the estimates
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mrow><mi>i</mi><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">V_{ii}</annotation></semantics></math>).
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>V</mi><annotation encoding="application/x-tex">V</annotation></semantics></math>
is generally approximated by the inverse of the Fisher information
matrix
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">I(\hat \theta)</annotation></semantics></math>).
The Fisher information matrix corresponds to the opposite of the hessian
matrix evaluated on the MLE estimate. Let us recall that the hessian
matrix is defined by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><msup><mi>∂</mi><mn>2</mn></msup><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>∂</mi><msub><mi>θ</mi><mi>i</mi></msub><mi>∂</mi><msub><mi>θ</mi><mi>j</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">H_{ij}(y, \theta) = \frac{\partial^2 L(y, \theta)}{\partial \theta_i \partial \theta_j}</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">L(y, \theta)</annotation></semantics></math>
the loglikelihod function for data
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
and parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>.</p>
<p>Before using this approximation, one must keep in mind that its
validity does not only depend on the sample size. It also strongly
depends on the data, of the distribution, and also on the
parameterization of the distribution. For this reason we recommend
potential users of the Wald approximation to compare the results to the
ones obtained using the bootstrap procedure (see below) before using
this approximation. A look at the loglikelihood contours is also
interesting as the Wald approximation assumes elliptical contours.
<strong>In a more general context, we recommend the use of bootstrap to
compute confidence intervals on parameters or on any function of those
parameters.</strong></p>
<p>Below you will find two examples, one for which Wald confidence
intervals seem correct and one for which they give wrong results, with
parameter values even outside their possible range (negative rate bound
for the gamma distribution).</p>
<div class="sourceCode" id="cb205"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">30</span>, mean <span class="op">=</span> <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">fn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">n</span>, <span class="st">"norm"</span><span class="op">)</span></span>
<span><span class="va">bn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bootdist.html">bootdist</a></span><span class="op">(</span><span class="va">fn</span><span class="op">)</span></span>
<span><span class="va">bn</span><span class="op">$</span><span class="va">CI</span></span></code></pre></div>
<pre><code><span><span class="co">##      Median 2.5% 97.5%</span></span>
<span><span class="co">## mean   9.41 8.78 10.02</span></span>
<span><span class="co">## sd     1.73 1.33  2.15</span></span></code></pre>
<div class="sourceCode" id="cb207"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fn</span><span class="op">$</span><span class="va">estimate</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="st">"estimate"</span><span class="op">=</span> <span class="fl">0</span>, <span class="st">"2.5%"</span><span class="op">=</span> <span class="op">-</span><span class="fl">1.96</span><span class="op">*</span><span class="va">fn</span><span class="op">$</span><span class="va">sd</span>, <span class="st">"97.5%"</span><span class="op">=</span> <span class="fl">1.96</span><span class="op">*</span><span class="va">fn</span><span class="op">$</span><span class="va">sd</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      estimate 2.5% 97.5%</span></span>
<span><span class="co">## mean     9.41 8.77 10.04</span></span>
<span><span class="co">## sd       1.78 1.33  2.22</span></span></code></pre>
<div class="sourceCode" id="cb209"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/logLik-plot.html">llplot</a></span><span class="op">(</span><span class="va">fn</span>, back.col <span class="op">=</span> <span class="cn">FALSE</span>, fit.show<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-66-1.png" class="r-plt" width="384"></p>
<div class="sourceCode" id="cb210"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="fl">30</span>, shape <span class="op">=</span> <span class="fl">0.1</span>, rate <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">fg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">g</span>, <span class="st">"gamma"</span><span class="op">)</span></span>
<span><span class="va">bg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bootdist.html">bootdist</a></span><span class="op">(</span><span class="va">fg</span><span class="op">)</span></span>
<span><span class="va">bg</span><span class="op">$</span><span class="va">CI</span></span></code></pre></div>
<pre><code><span><span class="co">##        Median   2.5%   97.5%</span></span>
<span><span class="co">## shape  0.0923 0.0636   0.145</span></span>
<span><span class="co">## rate  30.1018 9.6288 147.323</span></span></code></pre>
<div class="sourceCode" id="cb212"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fg</span><span class="op">$</span><span class="va">estimate</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="st">"estimate"</span><span class="op">=</span> <span class="fl">0</span>, <span class="st">"2.5%"</span><span class="op">=</span> <span class="op">-</span><span class="fl">1.96</span><span class="op">*</span><span class="va">fg</span><span class="op">$</span><span class="va">sd</span>, <span class="st">"97.5%"</span><span class="op">=</span> <span class="fl">1.96</span><span class="op">*</span><span class="va">fg</span><span class="op">$</span><span class="va">sd</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       estimate    2.5%  97.5%</span></span>
<span><span class="co">## shape   0.0882  0.0553  0.121</span></span>
<span><span class="co">## rate   24.2613 -6.3430 54.866</span></span></code></pre>
<div class="sourceCode" id="cb214"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/logLik-plot.html">llplot</a></span><span class="op">(</span><span class="va">fg</span>, back.col <span class="op">=</span> <span class="cn">FALSE</span>, fit.show<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-67-1.png" class="r-plt" width="384"></p>
</div>
<div class="section level3">
<h3 id="how-can-we-compute-confidence-intervals-on-quantiles-from-the-fit-of-a-distribution">4.2. How can we compute confidence intervals on quantiles from the
fit of a distribution ?<a class="anchor" aria-label="anchor" href="#how-can-we-compute-confidence-intervals-on-quantiles-from-the-fit-of-a-distribution"></a>
</h3>
<p>The <code><a href="../reference/quantile.html">quantile()</a></code> function can be used to calculate any
quantile from a fitted distribution when it is called with an object of
class <code>fitdist</code> or <code>fitdistcens</code> as the first
argument. When called with an object of class <code>bootdist</code> or
<code>bootdistcens</code> as the first argument, quantiles are returned
accompanied with a confidence interval calculated using the bootstraped
sample of parameters. Moreover, you can use the <code><a href="../reference/CIcdfplot.html">CIcdfplot()</a></code>
function to plot the fitted distribution as a CDF curve surrounded by a
band corresponding to pointwise intervals on the quantiles. See an
example below on censored data corresponding to 72-hour acute salinity
tolerance (LC50values) of rivermarine invertebrates.</p>
<div class="sourceCode" id="cb215"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">salinity</span><span class="op">)</span></span>
<span><span class="va">log10LC50</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">salinity</span><span class="op">)</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdistcens.html">fitdistcens</a></span><span class="op">(</span><span class="va">log10LC50</span>, <span class="st">"norm"</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>trace<span class="op">=</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Bootstrap </span></span>
<span><span class="va">bootsample</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bootdistcens.html">bootdistcens</a></span><span class="op">(</span><span class="va">fit</span>, niter <span class="op">=</span> <span class="fl">101</span><span class="op">)</span></span>
<span><span class="co">#### We used only 101 iterations in that example to limit the calculation time but</span></span>
<span><span class="co">#### in practice you should take at least 1001 bootstrap iterations</span></span>
<span><span class="co"># Calculation of the quantile of interest (here the 5 percent hazard concentration)</span></span>
<span><span class="op">(</span><span class="va">HC5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/quantile.html">quantile</a></span><span class="op">(</span><span class="va">bootsample</span>, probs <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## (original) estimated quantiles for each specified probability (censored data)</span></span>
<span><span class="co">##          p=0.05</span></span>
<span><span class="co">## estimate   1.12</span></span>
<span><span class="co">## Median of bootstrap estimates</span></span>
<span><span class="co">##          p=0.05</span></span>
<span><span class="co">## estimate   1.12</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## two-sided 95 % CI of each quantile</span></span>
<span><span class="co">##        p=0.05</span></span>
<span><span class="co">## 2.5 %    1.05</span></span>
<span><span class="co">## 97.5 %   1.20</span></span></code></pre>
<div class="sourceCode" id="cb217"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># visualizing pointwise confidence intervals on other quantiles</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/CIcdfplot.html">CIcdfplot</a></span><span class="op">(</span><span class="va">bootsample</span>, CI.output <span class="op">=</span> <span class="st">"quantile"</span>, CI.fill <span class="op">=</span> <span class="st">"pink"</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">2</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-68-1.png" class="r-plt" width="672"></p>
</div>
<div class="section level3">
<h3 id="how-can-we-compute-confidence-intervals-on-any-function-of-the-parameters-of-the-fitted-distribution">4.3. How can we compute confidence intervals on any function of the
parameters of the fitted distribution ?<a class="anchor" aria-label="anchor" href="#how-can-we-compute-confidence-intervals-on-any-function-of-the-parameters-of-the-fitted-distribution"></a>
</h3>
<p>The bootstrap sample of parameter estimates can be used to calculate
a bootstrap sample of any variable defined as a function of the
parameters of the fitted distribution. From such a bootstrap sample you
can easily compute a conidence interval using percentiles. Below is an
example that uses the bootstrap sample of parameters from the previous
example (FAQ 4.2) to calculate a 95 percent confidence interval on the
Potentially Affected Portion (PAF) of species at a given exposure to
salinity (fixed to 1.2 in log10 in this example).</p>
<div class="sourceCode" id="cb218"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exposure</span> <span class="op">&lt;-</span> <span class="fl">1.2</span></span>
<span><span class="co"># Bootstrap sample of the PAF at this exposure</span></span>
<span><span class="va">PAF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="va">exposure</span>, mean <span class="op">=</span> <span class="va">bootsample</span><span class="op">$</span><span class="va">estim</span><span class="op">$</span><span class="va">mean</span>, sd <span class="op">=</span> <span class="va">bootsample</span><span class="op">$</span><span class="va">estim</span><span class="op">$</span><span class="va">sd</span><span class="op">)</span></span>
<span><span class="co"># confidence interval from 2.5 and 97.5 percentiles</span></span>
<span><span class="fu"><a href="../reference/quantile.html">quantile</a></span><span class="op">(</span><span class="va">PAF</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   2.5%  97.5% </span></span>
<span><span class="co">## 0.0487 0.1470</span></span></code></pre>
<p>For more complex calculations especially to tranfer uncertainty
within a quantitative risk assessment, we recommend the use of the
package <code>mc2d</code> which aims at making such calculations easy
and which gives extensive examples of use of such bootstrap samples of
parameters estimated using functions of the package
<code>fitdistrplus</code>.</p>
</div>
<div class="section level3">
<h3 id="how-do-we-choose-the-bootstrap-number">4.4. How do we choose the bootstrap number?<a class="anchor" aria-label="anchor" href="#how-do-we-choose-the-bootstrap-number"></a>
</h3>
<p>Generally, we do not need to choose a number of bootstrap values as
high as the original sample size. We search a number for which the mean
and the standard values become stable. In the log-normal example below,
it is enough to have 100 bootstrap values.</p>
<div class="sourceCode" id="cb220"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f.ln.MME</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span>, <span class="st">"lnorm"</span>, method <span class="op">=</span> <span class="st">"mme"</span>, order <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co"># Bootstrap </span></span>
<span><span class="va">b.ln.50</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bootdist.html">bootdist</a></span><span class="op">(</span><span class="va">f.ln.MME</span>, niter <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">b.ln.100</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bootdist.html">bootdist</a></span><span class="op">(</span><span class="va">f.ln.MME</span>, niter <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">b.ln.200</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bootdist.html">bootdist</a></span><span class="op">(</span><span class="va">f.ln.MME</span>, niter <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">b.ln.500</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bootdist.html">bootdist</a></span><span class="op">(</span><span class="va">f.ln.MME</span>, niter <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">b.ln.50</span>, <span class="va">b.ln.100</span>, <span class="va">b.ln.200</span>, <span class="va">b.ln.500</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">d1</span><span class="op">)</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-70-1.png" class="r-plt" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="how-to-personalize-plots">5. How to personalize plots<a class="anchor" aria-label="anchor" href="#how-to-personalize-plots"></a>
</h2>
<div class="section level3">
<h3 id="can-i-personalize-the-default-plot-given-for-an-object-of-class-fitdist-or-fitdistcens">5.1. Can I personalize the default plot given for an object of class
<code>fitdist</code> or <code>fitdistcens</code>?<a class="anchor" aria-label="anchor" href="#can-i-personalize-the-default-plot-given-for-an-object-of-class-fitdist-or-fitdistcens"></a>
</h3>
<p>The default plot given by using the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function on
an object of class <code>fitdist</code> or <code>fitdistcens</code> is
hard to personalize. Indeed this plot was designed only to give a quick
overview of the fit, not to be used as a graph in a manuscript or a
formal presentation. To personalize some of (or all) the goodness-of-fit
plots, you should rather use specific graphical functions,
<code>denscomp</code>, <code>cdfcomp</code>, <code>ppcomp</code>,
<code>qqcomp</code> or <code>cdfcompcens</code> (see how in the
following paragraphs).</p>
</div>
<div class="section level3">
<h3 id="how-to-personalize-goodness-of-fit-plots">5.2. How to personalize goodness-of-fit plots ?<a class="anchor" aria-label="anchor" href="#how-to-personalize-goodness-of-fit-plots"></a>
</h3>
<p>The default plot of an object of class <code>fitdist</code> can be
easily reproduced and personalized using <code>denscomp</code>,
<code>cdfcomp</code>, <code>ppcomp</code> and <code>qqcomp</code>.</p>
<div class="sourceCode" id="cb221"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">groundbeef</span><span class="op">)</span></span>
<span><span class="va">serving</span> <span class="op">&lt;-</span> <span class="va">groundbeef</span><span class="op">$</span><span class="va">serving</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">serving</span>, <span class="st">"gamma"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/graphcomp.html">denscomp</a></span><span class="op">(</span><span class="va">fit</span>, addlegend <span class="op">=</span> <span class="cn">FALSE</span>, main <span class="op">=</span> <span class="st">""</span>, xlab <span class="op">=</span> <span class="st">"serving sizes (g)"</span>, </span>
<span>         fitcol <span class="op">=</span> <span class="st">"orange"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/graphcomp.html">qqcomp</a></span><span class="op">(</span><span class="va">fit</span>, addlegend <span class="op">=</span> <span class="cn">FALSE</span>, main <span class="op">=</span> <span class="st">""</span>, fitpch <span class="op">=</span> <span class="fl">16</span>, fitcol <span class="op">=</span> <span class="st">"grey"</span>, </span>
<span>       line01lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/graphcomp.html">cdfcomp</a></span><span class="op">(</span><span class="va">fit</span>, addlegend <span class="op">=</span> <span class="cn">FALSE</span>, main <span class="op">=</span> <span class="st">""</span>, xlab <span class="op">=</span> <span class="st">"serving sizes (g)"</span>, </span>
<span>        fitcol <span class="op">=</span> <span class="st">"orange"</span>, lines01 <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/graphcomp.html">ppcomp</a></span><span class="op">(</span><span class="va">fit</span>, addlegend <span class="op">=</span> <span class="cn">FALSE</span>, main <span class="op">=</span> <span class="st">""</span>, fitpch <span class="op">=</span> <span class="fl">16</span>, fitcol <span class="op">=</span> <span class="st">"grey"</span>, </span>
<span>       line01lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-71-1.png" class="r-plt" width="672"></p>
<p>In a similar way, the default plot of an object of class
<code>fitdistcens</code> can be easily personalized using
<code>cdfcompcens</code>.</p>
</div>
<div class="section level3">
<h3 id="is-it-possible-to-obtain-ggplot2-plots">5.3. Is it possible to obtain <code>ggplot2</code> plots ?<a class="anchor" aria-label="anchor" href="#is-it-possible-to-obtain-ggplot2-plots"></a>
</h3>
<p>An argument <code>plotstyle</code> was added to functions
<code>denscomp</code>, <code>cdfcomp</code>, <code>ppcomp</code>,
<code>qqcomp</code>and <code>cdfcompcens</code>,
<code>ppcompcens</code>, <code>qqcompcens</code> to enable the
generation of plots using the <code>ggplot2</code> package. This
argument by default fixed at <code>graphics</code> must simply be fixed
at <code>ggplot</code> for this purpose, as in the following example. In
that latter case the graphical functions return a graphic object that
can be further personalized using <code>ggplot2</code> functions.</p>
<div class="sourceCode" id="cb222"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org" class="external-link">"ggplot2"</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: ggplot2</span></span></code></pre>
<div class="sourceCode" id="cb224"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitW</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">serving</span>, <span class="st">"weibull"</span><span class="op">)</span></span>
<span><span class="va">fitln</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">serving</span>, <span class="st">"lnorm"</span><span class="op">)</span></span>
<span><span class="va">fitg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">serving</span>, <span class="st">"gamma"</span><span class="op">)</span></span>
<span><span class="va">dcomp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/graphcomp.html">denscomp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">fitW</span>, <span class="va">fitln</span>, <span class="va">fitg</span><span class="op">)</span>, legendtext <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Weibull"</span>, <span class="st">"lognormal"</span>, <span class="st">"gamma"</span><span class="op">)</span>,</span>
<span>    xlab <span class="op">=</span> <span class="st">"serving sizes (g)"</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">250</span><span class="op">)</span>, </span>
<span>    fitcol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"green"</span>, <span class="st">"orange"</span><span class="op">)</span>, fitlty <span class="op">=</span> <span class="fl">1</span>, fitlwd <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, </span>
<span>    xlegend <span class="op">=</span> <span class="st">"topright"</span>, plotstyle <span class="op">=</span> <span class="st">"ggplot"</span>, addlegend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">dcomp</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Ground beef fits"</span><span class="op">)</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-72-1.png" class="r-plt" width="672"></p>
<!-- We plan to include the argument `plotstyle` to other functions of the `fitdistrplus` package in a next future. -->
</div>
<div class="section level3">
<h3 id="is-it-possible-to-add-the-names-of-the-observations-in-a-goodness-of-fit-plot-e-g--the-names-of-the-species-in-the-plot-of-the-species-sensitivity-distribution-ssd-classically-used-in-ecotoxicology">5.4. Is it possible to add the names of the observations in a
goodness-of-fit plot, e.g. the names of the species in the plot of the
Species Sensitivity Distribution (SSD) classically used in ecotoxicology
?<a class="anchor" aria-label="anchor" href="#is-it-possible-to-add-the-names-of-the-observations-in-a-goodness-of-fit-plot-e-g--the-names-of-the-species-in-the-plot-of-the-species-sensitivity-distribution-ssd-classically-used-in-ecotoxicology"></a>
</h3>
<p>An argument named <code>name.points</code> can be used in functions
<code>cdfcomp</code> or <code>CIcdfcomp</code> to pass a label vector
for observed points so as to add the names of the points on the left of
each point. This option is available only for ECDF goodness-of-fit plots
and only for non censored data. This option can be used as below, for
example, to name the species in the classical plot of the Species
Sensitivity Distributions (SSD) in ecotoxicology.</p>
<div class="sourceCode" id="cb225"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">endosulfan</span><span class="op">)</span></span>
<span><span class="va">ATV</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">endosulfan</span>, <span class="va">group</span> <span class="op">==</span> <span class="st">"NonArthroInvert"</span><span class="op">)</span><span class="op">$</span><span class="va">ATV</span></span>
<span><span class="va">taxaATV</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">endosulfan</span>, <span class="va">group</span> <span class="op">==</span> <span class="st">"NonArthroInvert"</span><span class="op">)</span><span class="op">$</span><span class="va">taxa</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">ATV</span>, <span class="st">"lnorm"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/graphcomp.html">cdfcomp</a></span><span class="op">(</span><span class="va">f</span>, xlogscale <span class="op">=</span> <span class="cn">TRUE</span>, main <span class="op">=</span> <span class="st">"Species Sensitivty Distribution"</span>, </span>
<span>    xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">100000</span><span class="op">)</span>, name.points <span class="op">=</span> <span class="va">taxaATV</span>, </span>
<span>    addlegend <span class="op">=</span> <span class="cn">FALSE</span>, plotstyle <span class="op">=</span> <span class="st">"ggplot"</span><span class="op">)</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-73-1.png" class="r-plt" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="questions-regarding-left-right-andor-interval-censored-data">6. Questions regarding (left, right and/or interval) censored
data<a class="anchor" aria-label="anchor" href="#questions-regarding-left-right-andor-interval-censored-data"></a>
</h2>
<div class="section level3">
<h3 id="how-to-code-censored-data-in-fitdistrplus">6.1. How to code censored data in <code>fitdistrplus</code> ?<a class="anchor" aria-label="anchor" href="#how-to-code-censored-data-in-fitdistrplus"></a>
</h3>
<p>Censored data must be rpresented in the package by a dataframe of two
columns respectively named left and right, describing each observed
value as an interval. The left column contains either <code>NA</code>
for left censored observations, the left bound of the interval for
interval censored observations, or the observed value for non-censored
observations. The right column contains either <code>NA</code> for right
censored observations, the right bound of the interval for interval
censored observations, or the observed value for non-censored
observations. This type of representation corresponds to the coding
names <code>"interval2"</code> in function <code>Surv</code> of the
package <code>survival</code>. There is no other way to represent
censored data in <code>fitdistrplus</code> but the function
<code><a href="../reference/Surv2fitdistcens.html">Surv2fitdistcens()</a></code> can be used to help you to format data
for use in <code><a href="../reference/fitdistcens.html">fitdistcens()</a></code> from one of the format used in the
survival package (see the help page of <code><a href="../reference/Surv2fitdistcens.html">Surv2fitdistcens()</a></code>).
You have a toy example below.</p>
<div class="sourceCode" id="cb226"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dtoy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>left <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">9.7</span>, <span class="fl">10</span><span class="op">)</span>, right <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9.7</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dtoy</span></span></code></pre></div>
<pre><code><span><span class="co">##   left right</span></span>
<span><span class="co">## 1   NA   1.0</span></span>
<span><span class="co">## 2  2.0   3.0</span></span>
<span><span class="co">## 3  4.0   7.0</span></span>
<span><span class="co">## 4  6.0   8.0</span></span>
<span><span class="co">## 5  9.7   9.7</span></span>
<span><span class="co">## 6 10.0    NA</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="how-do-i-prepare-the-input-of-fitdistcens-with-surv2fitdistcens">6.2. How do I prepare the input of <code>fitdistcens()</code> with
<code>Surv2fitdistcens()</code>?<a class="anchor" aria-label="anchor" href="#how-do-i-prepare-the-input-of-fitdistcens-with-surv2fitdistcens"></a>
</h3>
<p>Let us consider a classical right-censored dataset for human life:
twenty values randomly chosen from the <code>canlifins</code> dataset of
<code>CASdatasets</code> package. We refer to the help of
<code><a href="../reference/Surv2fitdistcens.html">Surv2fitdistcens()</a></code> for other censoring types.</p>
<div class="sourceCode" id="cb228"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exitage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">81.1</span>,<span class="fl">78.9</span>,<span class="fl">72.6</span>,<span class="fl">67.9</span>,<span class="fl">60.1</span>,<span class="fl">78.3</span>,<span class="fl">83.4</span>,<span class="fl">66.9</span>,<span class="fl">74.8</span>,<span class="fl">80.5</span>,<span class="fl">75.6</span>,<span class="fl">67.1</span>,</span>
<span>             <span class="fl">75.3</span>,<span class="fl">82.8</span>,<span class="fl">70.1</span>,<span class="fl">85.4</span>,<span class="fl">74</span>,<span class="fl">70</span>,<span class="fl">71.6</span>,<span class="fl">76.5</span><span class="op">)</span></span>
<span><span class="va">death</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p>When performing survival analysis, it is very common to use
<code><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv()</a></code> function from package <code>survival</code> to
handle different types of censoring. In order to ease the use of
<code><a href="../reference/fitdistcens.html">fitdistcens()</a></code>, a dedicated function
<code><a href="../reference/Surv2fitdistcens.html">Surv2fitdistcens()</a></code> has been implemented with arguments
similar to the ones of <code><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv()</a></code>.</p>
<div class="sourceCode" id="cb229"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">svdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Surv2fitdistcens.html">Surv2fitdistcens</a></span><span class="op">(</span><span class="va">exitage</span>, event<span class="op">=</span><span class="va">death</span><span class="op">)</span></span></code></pre></div>
<p>Let us now fit two simple distributions.</p>
<div class="sourceCode" id="cb230"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flnormc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdistcens.html">fitdistcens</a></span><span class="op">(</span><span class="va">svdata</span>, <span class="st">"lnorm"</span><span class="op">)</span></span>
<span><span class="va">fweic</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdistcens.html">fitdistcens</a></span><span class="op">(</span><span class="va">svdata</span>, <span class="st">"weibull"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/graphcompcens.html">cdfcompcens</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">fweic</span>, <span class="va">flnormc</span><span class="op">)</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">exitage</span><span class="op">)</span>, xlegend <span class="op">=</span> <span class="st">"topleft"</span><span class="op">)</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-77-1.png" class="r-plt" width="672"></p>
</div>
<div class="section level3">
<h3 id="how-to-represent-an-empirical-distribution-from-censored-data">6.3. How to represent an empirical distribution from censored data
?<a class="anchor" aria-label="anchor" href="#how-to-represent-an-empirical-distribution-from-censored-data"></a>
</h3>
<p>The representation of an empirical distribution from censored data is
not a trivial problem. One can simply represent each observation as an
interval at an y-value defined by the rank of the observation as done
below using function <code>plotdistcens</code>. This representation can
be interesting to visualize the raw data, but it remains difficult to
correctly order the observations in any case (see the example below on
the right using data <code>smokedfish</code>).</p>
<div class="sourceCode" id="cb231"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotdistcens.html">plotdistcens</a></span><span class="op">(</span><span class="va">dtoy</span>, NPMLE <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">smokedfish</span><span class="op">)</span></span>
<span><span class="va">dsmo</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">smokedfish</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotdistcens.html">plotdistcens</a></span><span class="op">(</span><span class="va">dsmo</span>, NPMLE <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-78-1.png" class="r-plt" width="672"></p>
<p>Many authors worked on the development of algorithms for <strong>non
parametric maximum likelihood estimation (NPMLE)</strong> of the
<strong>empirical cumulative distribution function (ECDF)</strong> from
interval censored data (including left and right censored data that can
be considered as interval censored data with one bound at infinity). In
old versions of <code>fitdistrplus</code> we used the Turnbull algorithm
using calls to functions of the package <code>survival</code>. Even if
this Turnbull algorithm is still available in the package, the default
plot now uses the function <code>npsurv</code> of the package
<code>npsurv</code>. This package provides more performant algorithms
developped by Yong Wang (see references cited in the help page of
<code>plotdistcens</code>). Due to lack of maintenance of this package
we were forced to rewrite their main functions in our package, using
another optimization function. The same ECDF plot was also implemented
in our using the Turnbull algorithm of survival (see below).</p>
<div class="sourceCode" id="cb232"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,  mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Turnbull algorithm with representation of middle points of equivalence classes</span></span>
<span><span class="fu"><a href="../reference/plotdistcens.html">plotdistcens</a></span><span class="op">(</span><span class="va">dsmo</span>, NPMLE.method <span class="op">=</span> <span class="st">"Turnbull.middlepoints"</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.8</span>, <span class="fl">2.4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Turnbull algorithm with representation of equivalence classes as intervals</span></span>
<span><span class="fu"><a href="../reference/plotdistcens.html">plotdistcens</a></span><span class="op">(</span><span class="va">dsmo</span>, NPMLE.method <span class="op">=</span> <span class="st">"Turnbull.intervals"</span><span class="op">)</span></span>
<span><span class="co"># Wang algorithm with representation of equivalence classes as intervals</span></span>
<span><span class="fu"><a href="../reference/plotdistcens.html">plotdistcens</a></span><span class="op">(</span><span class="va">dsmo</span>, NPMLE.method <span class="op">=</span> <span class="st">"Wang"</span><span class="op">)</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-79-1.png" class="r-plt" width="672"></p>
<p>As you can see in the above example, the new implementation of NPMLE
provides a different type of plot for the ECDF, representing by filled
rectangles the zones of non-uniqueness of the NPMLE ECDF. Indeed an
NPMLE algorithm generally proceeds in two steps.</p>
<ol style="list-style-type: decimal">
<li><p>The first step aims at identifying <strong>equivalence
classes</strong> (also named in the litterture <strong>Turnbull
intervals</strong> or <strong>maximal intersection intervals</strong> or
<strong>innermost intervals</strong> or <strong>maximal cliques</strong>
of the data). Equivalences classess are points/intervals under which the
NPMLE ECDF may change. Equivalence classes have been shown to correspond
to regions between a left bound of an interval (named L in the following
plot on a the previous toy example) immediately followed by a right
bound of an interval (named R in the following plot). An equivalence
class may be of null length (for example at each non censored
value).</p></li>
<li><p>The second step aims at assigning a <strong>probability
mass</strong> to each equivalence class, which may be zero on some
classes. The NPMLE is unique only up to these equivalence classes and
this <strong>non uniqueness</strong> of the NPMLE ECDF is represented by
<strong>filled rectangles</strong>.</p></li>
</ol>
<p>Various NPMLE algorithms are implemented in the packages
<strong>Icens</strong>, <strong>interval</strong> and
<strong>npsurv</strong>. They are more or less performant and all of
them do not enable the handling of other data than survival data,
especially with left censored observations.</p>
<p><img src="FAQ_files/figure-html/unnamed-chunk-80-1.png" class="r-plt" width="672"></p>
</div>
<div class="section level3">
<h3 id="how-to-assess-the-goodness-of-fit-of-a-distribution-fitted-on-censored-data">6.4. How to assess the goodness-of-fit of a distribution fitted on
censored data ?<a class="anchor" aria-label="anchor" href="#how-to-assess-the-goodness-of-fit-of-a-distribution-fitted-on-censored-data"></a>
</h3>
<p>The only available method in <code>fitdistrplus</code> to fit
distributions on censored data is the maximum likelihood estimation
(MLE). Once a distribution is fitted using <code>fitdistcens</code>, AIC
and BIC values can be found in the <code>summary</code> of the object of
class <code>fitdistcens</code> returned by the function. Those values
can be used to compare the fit of various distributions on a same
dataset. Function <code>gofstat</code> is not yet proposed in our
package for fits on censored data but we plan to develop it in the
future with the calculation of other goodness-of-fit statistics for
censored data.</p>
<div class="sourceCode" id="cb233"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fnorm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdistcens.html">fitdistcens</a></span><span class="op">(</span><span class="va">dsmo</span>,<span class="st">"norm"</span><span class="op">)</span></span>
<span><span class="va">flogis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitdistcens.html">fitdistcens</a></span><span class="op">(</span><span class="va">dsmo</span>,<span class="st">"logis"</span><span class="op">)</span></span>
<span><span class="co"># comparison of AIC values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fnorm</span><span class="op">)</span><span class="op">$</span><span class="va">aic</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 178</span></span></code></pre>
<div class="sourceCode" id="cb235"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">flogis</span><span class="op">)</span><span class="op">$</span><span class="va">aic</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 177</span></span></code></pre>
<p>Considering goodness-of-fit plots, the generic <code>plot</code>
function of an object of class <code>fitdistcens</code>provides three
plots, one in CDF using the NPMLE ECDF plot (by default using the Wang
prepresentation, see previous part for details), a Q-Q plot and a P-P
plot simply derived from the Wang plot of the ECDF, with filled
rectangles indicating non uniqueness of the NPMLE ECDF.</p>
<div class="sourceCode" id="cb237"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fnorm</span><span class="op">)</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-82-1.png" class="r-plt" width="672"></p>
<p>Functions <code><a href="../reference/graphcompcens.html">cdfcompcens()</a></code>, <code>qqcompens()</code> and
<code><a href="../reference/graphcompcens.html">ppcompcens()</a></code> can be used to individualize and personnalize
CDF, Q-Q and P-P goodness-of-fit plots and/or to compare the fit of
various distributions on a same dataset.</p>
<div class="sourceCode" id="cb238"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/graphcompcens.html">cdfcompcens</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">fnorm</span>, <span class="va">flogis</span><span class="op">)</span>, fitlty <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-83-1.png" class="r-plt" width="384"></p>
<div class="sourceCode" id="cb239"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/graphcompcens.html">qqcompcens</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">fnorm</span>, <span class="va">flogis</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-83-2.png" class="r-plt" width="384"></p>
<div class="sourceCode" id="cb240"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/graphcompcens.html">ppcompcens</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">fnorm</span>, <span class="va">flogis</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-83-3.png" class="r-plt" width="384"></p>
<p>Considering Q-Q plots and P-P plots, it may be easier to compare
various fits by splitting the plots as below which is done automatically
using the <code>plotstyle</code> <code>ggplot</code> in
<code>qqcompens()</code> and <code><a href="../reference/graphcompcens.html">ppcompcens()</a></code> but can also be
done manually with the <code>plotstyle</code> <code>graphics</code>.</p>
<div class="sourceCode" id="cb241"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/graphcompcens.html">qqcompcens</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">fnorm</span>, <span class="va">flogis</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>, plotstyle <span class="op">=</span> <span class="st">"ggplot"</span>,</span>
<span>  fitcol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"green"</span><span class="op">)</span>, fillrect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pink"</span>, <span class="st">"lightgreen"</span><span class="op">)</span>,</span>
<span>  legendtext <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"normal distribution"</span>, <span class="st">"logistic distribution"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-84-1.png" class="r-plt" width="672"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://lbbe.univ-lyon1.fr/fr/annuaires-des-membres/delignette-muller-marie-laure" class="external-link">Marie-Laure Delignette-Muller</a>, <a href="http://dutangc.free.fr" class="external-link">Christophe Dutang</a>, <a href="https://lbbe.univ-lyon1.fr/fr/annuaires-des-membres/siberchicot-aurelie" class="external-link">Aurélie Siberchicot</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
